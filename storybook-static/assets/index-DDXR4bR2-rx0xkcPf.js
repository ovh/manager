import{y as v,N as p,B as L,a as M,I as g}from"./use-locale-context-cwTY9VYn-REDUMe7F.js";function h(e){return!(e.metaKey||!g()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}var H=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function K(e,o,t){const n=t?L(t):null,i=v(n);return e=e||n instanceof i.HTMLInputElement&&!H.has(n==null?void 0:n.type)||n instanceof i.HTMLTextAreaElement||n instanceof i.HTMLElement&&n.isContentEditable,!(e&&o==="keyboard"&&t instanceof i.KeyboardEvent&&!Reflect.has(x,t.key))}var u=null,c=new Set,a=new Map,s=!1,f=!1,x={Tab:!0,Escape:!0};function l(e,o){for(let t of c)t(e,o)}function d(e){s=!0,h(e)&&(u="keyboard",l("keyboard",e))}function r(e){u="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(s=!0,l("pointer",e))}function b(e){M(e)&&(s=!0,u="virtual")}function k(e){const o=L(e);o===v(o)||o===p(o)||(!s&&!f&&(u="virtual",l("virtual",e)),s=!1,f=!1)}function w(){s=!1,f=!0}function S(e){if(typeof window>"u"||a.get(v(e)))return;const o=v(e),t=p(e);let n=o.HTMLElement.prototype.focus;function i(){u="virtual",l("virtual",null),s=!0,n.apply(this,arguments)}Object.defineProperty(o.HTMLElement.prototype,"focus",{configurable:!0,value:i}),t.addEventListener("keydown",d,!0),t.addEventListener("keyup",d,!0),t.addEventListener("click",b,!0),o.addEventListener("focus",k,!0),o.addEventListener("blur",w,!1),typeof o.PointerEvent<"u"?(t.addEventListener("pointerdown",r,!0),t.addEventListener("pointermove",r,!0),t.addEventListener("pointerup",r,!0)):(t.addEventListener("mousedown",r,!0),t.addEventListener("mousemove",r,!0),t.addEventListener("mouseup",r,!0)),o.addEventListener("beforeunload",()=>{V(e)},{once:!0}),a.set(o,{focus:n})}var V=(e,o)=>{const t=v(e),n=p(e);a.has(t)&&(t.HTMLElement.prototype.focus=a.get(t).focus,n.removeEventListener("keydown",d,!0),n.removeEventListener("keyup",d,!0),n.removeEventListener("click",b,!0),t.removeEventListener("focus",k,!0),t.removeEventListener("blur",w,!1),typeof t.PointerEvent<"u"?(n.removeEventListener("pointerdown",r,!0),n.removeEventListener("pointermove",r,!0),n.removeEventListener("pointerup",r,!0)):(n.removeEventListener("mousedown",r,!0),n.removeEventListener("mousemove",r,!0),n.removeEventListener("mouseup",r,!0)),a.delete(t))};function y(){return u==="keyboard"}function C(e={}){const{isTextInput:o,autoFocus:t,onChange:n,root:i}=e;S(i),n==null||n({isFocusVisible:t||y(),modality:u});const m=(E,T)=>{K(!!o,E,T)&&(n==null||n({isFocusVisible:y(),modality:E}))};return c.add(m),()=>{c.delete(m)}}export{C as B,y};
