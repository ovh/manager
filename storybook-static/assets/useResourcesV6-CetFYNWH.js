import{r as m}from"./index-CBqU2yxZ.js";import{a as T,Q as L,b as M,c as U}from"./useOvhIam-nH8cMKQ3.js";import{i as N,h as K,a as Q}from"./lib-ROnj4EVN.js";import{c as v,g as A}from"./_commonjsHelpers-BosuxZz1.js";import{F as h}from"./filter-list.component-D3PKPMHI.js";function H(e,t){const r=encodeURIComponent(`${t}`);switch(e){case h.Includes:return`like=%25${r}%25`;case h.StartsWith:return`like=${r}%25`;case h.EndsWith:return`like=%25${r}`;case h.IsEqual:return`eq=${r}`;case h.IsDifferent:return`ne=${r}`;case h.IsLower:return`lt=${r}`;case h.IsHigher:return`gt=${r}`;case h.IsBefore:return`lt=${r}`;case h.IsAfter:return`gt=${r}`;case h.IsIn:{const s=t;return s.length===1?`eq=${s[0]}`:`in=${s.map(encodeURIComponent).join(",")}`}default:throw new Error(`Missing comparator implementation: '${e}'`)}}async function k({route:e,pageSize:t,cursor:r}){const s={"X-Pagination-Size":`${encodeURIComponent(t||5e3)}`,...r?{"X-Pagination-Cursor":`${r}`}:{}},{data:a,headers:d,status:l}=await T.v2.get(e,{headers:s});return{data:a,cursorNext:d["x-pagination-cursor-next"],status:l}}async function I({route:e,page:t,pageSize:r,filters:s,sortBy:a,sortReverse:d,disableCache:l}){const o={"x-pagination-mode":"CachedObjectList-Pages","x-pagination-number":`${encodeURIComponent(t||1)}`,"x-pagination-size":`${encodeURIComponent(r||5e3)}`};a&&(o["x-pagination-sort"]=encodeURIComponent(a),o["x-pagination-sort-order"]=d?"DESC":"ASC"),s!=null&&s.length&&(o["x-pagination-filter"]=s.map(({comparator:g,key:V,value:y})=>`${encodeURIComponent(V)}:${H(g,y)}`).join("&")),l&&(o.Pragma="no-cache");const{data:n,headers:i,status:c}=await T.v6.get(e,{headers:o}),p=parseInt(i["x-pagination-elements"],10)||0;return{data:n,totalCount:p,status:c}}var G=class extends L{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e,t){super.setOptions({...e,behavior:N()},t)}getOptimisticResult(e){return e.behavior=N(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,t){var y,u;const{state:r}=e,s=super.createResult(e,t),{isFetching:a,isRefetching:d,isError:l,isRefetchError:o}=s,n=(u=(y=r.fetchMeta)==null?void 0:y.fetchMore)==null?void 0:u.direction,i=l&&n==="forward",c=a&&n==="forward",p=l&&n==="backward",g=a&&n==="backward";return{...s,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:K(t,r.data),hasPreviousPage:Q(t,r.data),isFetchNextPageError:i,isFetchingNextPage:c,isFetchPreviousPageError:p,isFetchingPreviousPage:g,isRefetchError:o&&!i&&!p,isRefetching:d&&!c&&!g}}};function B(e,t){return M(e,G)}const W=10,S=k;function F({route:e,pageSize:t=W,queryKey:r,defaultSorting:s=void 0}){const[a,d]=m.useState([]),[l,o]=m.useState(s),{data:n,fetchNextPage:i,hasNextPage:c,isError:p,isLoading:g,error:V,status:y}=B({initialPageParam:null,queryKey:r,queryFn:({pageParam:u})=>k({route:e,pageSize:t,cursor:u}),staleTime:1/0,retry:!1,getNextPageParam:u=>u.cursorNext});return m.useEffect(()=>{const u=n==null?void 0:n.pages.map(f=>f.data).flat();d(u)},[n]),{data:n,fetchNextPage:i,hasNextPage:c,flattenData:a,isError:p,isLoading:g,setSorting:o,sorting:l,error:V,status:y}}try{F.displayName="useResourcesIcebergV2",F.__docgenInfo={description:"",displayName:"useResourcesIcebergV2",props:{cursor:{defaultValue:null,description:"",name:"cursor",required:!1,type:{name:"string"}},route:{defaultValue:null,description:"",name:"route",required:!0,type:{name:"string"}},pageSize:{defaultValue:{value:"10"},description:"",name:"pageSize",required:!1,type:{name:"number"}},search:{defaultValue:null,description:"",name:"search",required:!1,type:{name:"{ key: string; value: string; }"}},queryKey:{defaultValue:null,description:"",name:"queryKey",required:!0,type:{name:"string[]"}},defaultSorting:{defaultValue:{value:"undefined"},description:"",name:"defaultSorting",required:!1,type:{name:"ColumnSort"}},sort:{defaultValue:null,description:"",name:"sort",required:!1,type:{name:"(sorting: ColumnSort, data: T[]) => T[]"}}}}}catch{}try{S.displayName="getResourcesIcebergV2",S.__docgenInfo={description:"",displayName:"getResourcesIcebergV2",props:{cursor:{defaultValue:null,description:"",name:"cursor",required:!1,type:{name:"string"}},route:{defaultValue:null,description:"",name:"route",required:!0,type:{name:"string"}},pageSize:{defaultValue:null,description:"",name:"pageSize",required:!1,type:{name:"number"}},search:{defaultValue:null,description:"",name:"search",required:!1,type:{name:"{ key: string; value: string; }"}}}}}catch{}const w=I;function E({route:e,pageSize:t=10,queryKey:r,defaultSorting:s=void 0}){const[a,d]=m.useState(s),{data:l,...o}=B({initialPageParam:1,queryKey:[...r,t,a],staleTime:1/0,retry:!1,queryFn:({pageParam:n})=>I({route:e,pageSize:t,page:n,sortBy:(a==null?void 0:a.id)||null,sortReverse:a==null?void 0:a.desc}),getNextPageParam:(n,i,c)=>n.totalCount/t>c?c+1:null,select:n=>{const i=n.pageParams[n.pageParams.length-1],{totalCount:c}=n.pages[0];return{data:n,pageIndex:i,totalCount:c,flattenData:n.pages.flatMap(p=>p.data)}}});return{...l??{...l,totalCount:0},...o,sorting:a,setSorting:d}}try{E.displayName="useResourcesIcebergV6",E.__docgenInfo={description:"",displayName:"useResourcesIcebergV6",props:{page:{defaultValue:null,description:"",name:"page",required:!1,type:{name:"number"}},filters:{defaultValue:null,description:"",name:"filters",required:!1,type:{name:"Filter[]"}},sortBy:{defaultValue:null,description:"",name:"sortBy",required:!1,type:{name:"string"}},sortReverse:{defaultValue:null,description:"",name:"sortReverse",required:!1,type:{name:"boolean"}},disableCache:{defaultValue:null,description:"",name:"disableCache",required:!1,type:{name:"boolean"}},route:{defaultValue:null,description:"",name:"route",required:!0,type:{name:"string"}},pageSize:{defaultValue:{value:"10"},description:"",name:"pageSize",required:!1,type:{name:"number"}},search:{defaultValue:null,description:"",name:"search",required:!1,type:{name:"{ key: string; value: string; }"}},queryKey:{defaultValue:null,description:"",name:"queryKey",required:!0,type:{name:"string[]"}},defaultSorting:{defaultValue:{value:"undefined"},description:"",name:"defaultSorting",required:!1,type:{name:"ColumnSort"}}}}}catch{}try{w.displayName="getResourcesIcebergV6",w.__docgenInfo={description:"",displayName:"getResourcesIcebergV6",props:{page:{defaultValue:null,description:"",name:"page",required:!1,type:{name:"number"}},filters:{defaultValue:null,description:"",name:"filters",required:!1,type:{name:"Filter[]"}},sortBy:{defaultValue:null,description:"",name:"sortBy",required:!1,type:{name:"string"}},sortReverse:{defaultValue:null,description:"",name:"sortReverse",required:!1,type:{name:"boolean"}},disableCache:{defaultValue:null,description:"",name:"disableCache",required:!1,type:{name:"boolean"}},route:{defaultValue:null,description:"",name:"route",required:!0,type:{name:"string"}},pageSize:{defaultValue:null,description:"",name:"pageSize",required:!1,type:{name:"number"}},search:{defaultValue:null,description:"",name:"search",required:!1,type:{name:"{ key: string; value: string; }"}}}}}catch{}var P={exports:{}};P.exports;(function(e,t){var r="[object Date]",s=typeof v=="object"&&v&&v.Object===Object&&v,a=t&&!t.nodeType&&t,d=a&&!0&&e&&!e.nodeType&&e,l=d&&d.exports===a,o=l&&s.process,n=function(){try{return o&&o.binding("util")}catch{}}(),i=n&&n.isDate;function c(f){return function(_){return f(_)}}var p=Object.prototype,g=p.toString;function V(f){return u(f)&&g.call(f)==r}var y=i?c(i):V;function u(f){return!!f&&typeof f=="object"}e.exports=y})(P,P.exports);var X=P.exports;const J=A(X);function D(e){return Number.isInteger(e)?"number":J(e)?"date":typeof e}function Y(e,t,r,s){var a,d,l,o,n,i,c;switch(e){case"number":return s?parseFloat(t)-parseFloat(r):parseFloat(r)-parseFloat(t);case"date":return s?new Date(t).getTime()-new Date(r).getTime():new Date(r).getTime()-new Date(t).getTime();case"boolean":return s?Number(t)-Number(r):Number(r)-Number(t);case"string":return s?(d=(a=t==null?void 0:t.trim().toLowerCase())==null?void 0:a.localeCompare)==null?void 0:d.call(a,r==null?void 0:r.trim().toLowerCase()):(c=(n=(o=(l=r.trim())==null?void 0:l.toString())==null?void 0:o.toLowerCase())==null?void 0:n.localeCompare)==null?void 0:c.call(n,(i=t==null?void 0:t.trim())==null?void 0:i.toLowerCase());default:return-1}}const $=I;function j({route:e,queryKey:t,pageSize:r=10,columns:s=[]}){const{data:a,isError:d,isLoading:l,error:o,status:n}=U({queryKey:[t],queryFn:()=>I({route:e}),retry:!1}),[i,c]=m.useState(),[p,g]=m.useState(0),[V,y]=m.useState(0),[u,f]=m.useState([]),[_,x]=m.useState([]);m.useEffect(()=>{var b;a!=null&&a.data&&((b=a==null?void 0:a.data)==null?void 0:b.length)>0&&(y(a.data.length),f(a.data))},[a]),m.useEffect(()=>{if(u){const b=p*r,R=u==null?void 0:u.slice(b,b+r);x([..._,...R])}},[p,u]),m.useEffect(()=>{var b;if(g(0),u&&i){const R=(b=s==null?void 0:s.find(q=>q.id===i.id))==null?void 0:b.type,z=u==null?void 0:u.sort((q,C)=>Y(R,q==null?void 0:q[i.id],C==null?void 0:C[i.id],i==null?void 0:i.desc));x([]),f([...z])}},[i]);const O=()=>{g(p+1)};return{data:a,sorting:i,setSorting:c,pageIndex:p,totalCount:V,flattenData:_,isError:d,isLoading:l,hasNextPage:p*r+r<=V,fetchNextPage:O,error:o,status:n}}try{D.displayName="dataType",D.__docgenInfo={description:"",displayName:"dataType",props:{}}}catch{}try{j.displayName="useResourcesV6",j.__docgenInfo={description:"",displayName:"useResourcesV6",props:{page:{defaultValue:null,description:"",name:"page",required:!1,type:{name:"number"}},filters:{defaultValue:null,description:"",name:"filters",required:!1,type:{name:"Filter[]"}},sortBy:{defaultValue:null,description:"",name:"sortBy",required:!1,type:{name:"string"}},sortReverse:{defaultValue:null,description:"",name:"sortReverse",required:!1,type:{name:"boolean"}},disableCache:{defaultValue:null,description:"",name:"disableCache",required:!1,type:{name:"boolean"}},route:{defaultValue:null,description:"",name:"route",required:!0,type:{name:"string"}},pageSize:{defaultValue:{value:"10"},description:"",name:"pageSize",required:!1,type:{name:"number"}},search:{defaultValue:null,description:"",name:"search",required:!1,type:{name:"{ key: string; value: string; }"}},queryKey:{defaultValue:null,description:"",name:"queryKey",required:!0,type:{name:"string[]"}},columns:{defaultValue:{value:"[]"},description:"",name:"columns",required:!1,type:{name:"ColumnDatagrid[]"}}}}}catch{}try{$.displayName="getResourcesV6",$.__docgenInfo={description:"",displayName:"getResourcesV6",props:{page:{defaultValue:null,description:"",name:"page",required:!1,type:{name:"number"}},filters:{defaultValue:null,description:"",name:"filters",required:!1,type:{name:"Filter[]"}},sortBy:{defaultValue:null,description:"",name:"sortBy",required:!1,type:{name:"string"}},sortReverse:{defaultValue:null,description:"",name:"sortReverse",required:!1,type:{name:"boolean"}},disableCache:{defaultValue:null,description:"",name:"disableCache",required:!1,type:{name:"boolean"}},route:{defaultValue:null,description:"",name:"route",required:!0,type:{name:"string"}},pageSize:{defaultValue:null,description:"",name:"pageSize",required:!1,type:{name:"number"}},search:{defaultValue:null,description:"",name:"search",required:!1,type:{name:"{ key: string; value: string; }"}}}}}catch{}
