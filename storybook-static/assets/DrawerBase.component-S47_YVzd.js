import{j as P}from"./jsx-runtime-BRNY0I4F.js";import{t as at}from"./Icon-DrfG5m-t-DQEf1CkA.js";import{l as ot}from"./ods-react60-0db41gCx.js";import{a as st}from"./ods-react236-aAAP9SXj.js";import{x as O,t as it}from"./Button-BC-ipw2F-CXZv4wj7.js";import{f as nt,s as ut}from"./Spinner-CV0M2r8z-14hgiywo.js";import{f as lt,D as ct,g as mt,e as _t,b as dt}from"./DrawerTrigger-omPTo2Bn-DB5oJcOC.js";import{o as ft}from"./ods-react235-BTQ8kVBe.js";import{h as pt,I as gt,M as ht}from"./TooltipTrigger-Iu3rt7LP-CcHcHvx1.js";import{k as Et}from"./QueryClientProvider-BPX08D6Z.js";import{r as p}from"./index-Bnop-kX6.js";import{_ as m}from"./iframe-RBN6eZbm.js";import{b as B,r as _}from"./TranslationHelper-CuIWJbDW.js";import"./index-4pTrEEYx.js";import{F,e as w,l as Pt,f as z,j as yt,k as Dt,m as vt,v as It,i as St,u as J}from"./index-DnqQo6oJ.js";function Q(t){var a,r,e="";if(typeof t=="string"||typeof t=="number")e+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(a=0;a<o;a++)t[a]&&(r=Q(t[a]))&&(e&&(e+=" "),e+=r)}else for(r in t)t[r]&&(e&&(e+=" "),e+=r);return e}function Tt(){for(var t,a,r=0,e="",o=arguments.length;r<o;r++)(t=arguments[r])&&(a=Q(t))&&(e&&(e+=" "),e+=a);return e}const xt=t=>{const a=new Map;return t.forEach(r=>{r.tags&&Object.entries(r.tags).forEach(([e,o])=>{var s;e.startsWith("ovh:")||(a.has(e)?(s=a.get(e))==null||s.add(o):a.set(e,new Set([o])))})}),Array.from(a.entries()).map(([r,e])=>({key:r,values:Array.from(e)}))},At=10,k={isLoading:!1,isError:!1,error:null,isSuccess:!1,isFetching:!1,status:"pending",fetchNextPage:()=>{},hasNextPage:!1,isFetchingNextPage:!1,pageIndex:0,totalCount:0,flattenData:[]},M=(t,a)=>t.key===a.key&&t.value===a.value&&t.comparator===a.comparator,Lt={de_DE:()=>_(m(()=>import("./Messages_de_DE-CR22mOzJ.js"),[],import.meta.url)),en_GB:()=>_(m(()=>import("./Messages_en_GB-Db8Mg1i8.js"),[],import.meta.url)),es_ES:()=>_(m(()=>import("./Messages_es_ES-CvYMLDyG.js"),[],import.meta.url)),fr_CA:()=>_(m(()=>import("./Messages_fr_CA-D5SbvSlA.js"),[],import.meta.url)),fr_FR:()=>_(m(()=>import("./Messages_fr_FR-D5SbvSlA.js"),[],import.meta.url)),it_IT:()=>_(m(()=>import("./Messages_it_IT-CUeK1hf8.js"),[],import.meta.url)),pl_PL:()=>_(m(()=>import("./Messages_pl_PL-CZhj8TKK.js"),[],import.meta.url)),pt_PT:()=>_(m(()=>import("./Messages_pt_PT-DuA0Cdyk.js"),[],import.meta.url))};B(Lt,"filters");function Ft(){const[t,a]=p.useState([]);return{filters:t,addFilter:r=>{(r.value||r.type===F.Tags&&[w.TagExists,w.TagNotExists].includes(r.comparator))&&a(e=>e.some(o=>M(o,r))?e:[...e,r])},removeFilter:r=>{a(e=>e.filter(o=>!M(o,r)))}}}const U=({defaultSorting:t,columns:a=[]})=>{const[r,e]=p.useState(""),[o,s]=p.useState([]),[n,i]=p.useState(t),{filters:l,addFilter:u,removeFilter:g}=Ft(),f=p.useMemo(()=>a.filter(c=>c.isSearchable),[a]),d=p.useCallback(c=>{if(!c){s([]);return}const I=f.filter(h=>!!h.id).map(({id:h})=>({key:h,value:c,comparator:w.Includes}));s(I)},[f]);return{searchInput:r,setSearchInput:e,searchFilters:o,setSearchFilters:s,sorting:n,setSorting:i,filters:l,addFilter:u,removeFilter:g,onSearch:d}},K=({initialPageParam:t,cacheKey:a,enabled:r,fetchDataFn:e,getNextPageParam:o,transformFn:s})=>{const{data:n={},error:i,isError:l,isFetching:u,isLoading:g,isSuccess:f,status:d,fetchNextPage:c,isFetchingNextPage:I,hasNextPage:h}=Pt({initialPageParam:t,queryKey:a,staleTime:1/0,retry:!1,enabled:r,queryFn:y=>e({pageParam:y.pageParam}),getNextPageParam:(y,T,S)=>o(y,S),select:y=>s(y.pages,y.pageParams)});return{data:n,error:i,isError:l,isFetching:u,isLoading:g,isSuccess:f,status:d,fetchNextPage:c,isFetchingNextPage:I,hasNextPage:h}},Ct=({cacheKey:t,fetchDataFn:a,refetchInterval:r,enabled:e})=>{const{data:o={},error:s,isError:n,isFetching:i,isLoading:l,isSuccess:u,status:g}=z({queryKey:t,queryFn:()=>a(),refetchInterval:r,enabled:e,retry:!1});return{data:o,error:s,isError:n,isFetching:i,isLoading:l,isSuccess:u,status:g}},bt=4999,Vt=({version:t="v6",route:a="",pageSize:r=At,cacheKey:e,defaultSorting:o=void 0,fetchAll:s=!1,columns:n=[],disableCache:i,enabled:l=!0})=>{const u=U({defaultSorting:o,columns:n}),{searchInput:g,setSearchInput:f,searchFilters:d,sorting:c,setSorting:I,filters:h,addFilter:y,removeFilter:T,onSearch:S}=u,{data:x,hasNextPage:C,fetchNextPage:b,...R}=K({initialPageParam:1,cacheKey:[...typeof e=="string"?[e]:e??[],s?"all":String(r),JSON.stringify(c??[]),JSON.stringify(h??[]),JSON.stringify(d??[])],enabled:l,fetchDataFn:({pageParam:E})=>{var v,A;return yt({version:t,route:a,pageSize:s?bt:r,...typeof E=="number"&&{page:E},sortBy:(v=c==null?void 0:c[0])==null?void 0:v.id,sortOrder:(A=c==null?void 0:c[0])!=null&&A.desc?"DESC":"ASC",filters:d?[...d,...h]:h,disableCache:i})},getNextPageParam:(E,v)=>E.totalCount/r>v?v+1:null,transformFn:(E,v)=>{var L;const A=v[v.length-1]??1,V=((L=E[0])==null?void 0:L.totalCount)??0;return{pageIndex:A,totalCount:V,flattenData:E.flatMap(N=>N.data)}}});return p.useEffect(()=>{s&&C&&l&&b()},[x,s,C,b,l]),l?{...x&&{...x},hasNextPage:C,fetchNextPage:b,sorting:{sorting:c??[],setSorting:E=>I(typeof E=="function"?v=>E(v??[]):E??[]),manualSorting:!0},filters:{filters:h,add:y,remove:T},search:{onSearch:S,searchInput:g,setSearchInput:f},...R}:{...k,sorting:{sorting:[],setSorting:()=>{},manualSorting:!1}}},Rt=({route:t="",pageSize:a=10,fetchAll:r=!1,cacheKey:e,enabled:o})=>{const{data:s,hasNextPage:n,fetchNextPage:i,...l}=K({initialPageParam:"",cacheKey:[...e,r?"all":String(a)],enabled:o??!0,fetchDataFn:({pageParam:u})=>Dt({route:t,pageSize:a,...!!u&&typeof u=="string"&&{cursor:u}}),getNextPageParam:u=>u.nextCursor?u.nextCursor:null,transformFn:u=>{const{totalCount:g}=u[0];return{flattenData:u.flatMap(f=>f.data),totalCount:g}}});return p.useEffect(()=>{r&&n&&o&&i()},[s,r,n,i,o]),o?{...s&&{...s},hasNextPage:n,fetchNextPage:i,...l}:k},q=t=>t==="true",Nt=(t,a,r,e)=>{var n,i;if(!a||!r)return-1;const o=e?r:a,s=e?a:r;switch(t){case F.Numeric:return parseFloat(o)-parseFloat(s);case F.Date:return new Date(o).getTime()-new Date(s).getTime();case F.Boolean:return Number(q(o))-Number(q(s));case F.String:return(i=(n=o==null?void 0:o.trim().toLowerCase())==null?void 0:n.localeCompare)==null?void 0:i.call(n,s==null?void 0:s.trim().toLowerCase());default:return-1}};function $(t){if(t==null)return"";switch(typeof t){case"string":return t;case"number":case"boolean":case"bigint":case"symbol":case"object":try{return JSON.stringify(t)}catch{return""}default:return""}}const Ot=({items:t=[],filters:a,searchFilters:r,sorting:e,columns:o})=>{const s=p.useMemo(()=>!a.length&&!r.length?t??[]:vt(t??[],[...a,...r]),[t,a,r]);return{filteredAndSortedData:p.useMemo(()=>{var f;if(!(e!=null&&e.length))return s;const i=e[0]??{},l=i.id,u=i.desc??!1;if(!l)return s;const g=((f=o.find(d=>d.id===l))==null?void 0:f.type)??F.String;return[...s].sort((d,c)=>Nt(g,$(d[l]),$(c[l]),u))},[s,e,o])}},wt=({route:t="",cacheKey:a,fetchDataFn:r,refetchInterval:e,pageSize:o=10,columns:s=[],defaultSorting:n,enabled:i=!0})=>{const{searchInput:l,setSearchInput:u,searchFilters:g,sorting:f,setSorting:d,filters:c,addFilter:I,removeFilter:h,onSearch:y}=U({defaultSorting:n,columns:s}),[T,S]=p.useState(0),{data:x,error:C,isError:b,isFetching:R,isLoading:E,isSuccess:v,status:A}=Ct({cacheKey:[a],fetchDataFn:()=>r?r(t):It.get(t),refetchInterval:e||!1,enabled:i}),{filteredAndSortedData:V}=Ot({items:x==null?void 0:x.data,columns:s,filters:c,searchFilters:g,sorting:f}),L=p.useMemo(()=>i&&!E?V:[],[i,E,V]),N=L.length,W=p.useCallback(()=>{S(D=>D+1)},[]),Z=p.useCallback(D=>{S(0),d(typeof D=="function"?rt=>D(rt??[]):D??[])},[d]),X=p.useCallback((...D)=>{S(0),I(...D)},[I]),H=p.useCallback((...D)=>{S(0),h(...D)},[h]),Y=p.useCallback((...D)=>{S(0),y(...D)},[y]),tt=p.useCallback((...D)=>{S(0),u(...D)},[u]);if(!i)return{...k,sorting:{sorting:[],setSorting:()=>{},manualSorting:!1}};const et=L.slice(0,(T+1)*o);return{error:C,isError:b,isFetching:R,isSuccess:v,status:A,isLoading:E,pageIndex:T,totalCount:N,flattenData:et,hasNextPage:T*o+o<L.length,fetchNextPage:W,sorting:{sorting:f??[],setSorting:Z,manualSorting:!0},filters:{filters:c,add:X,remove:H},search:{onSearch:Y,searchInput:l,setSearchInput:tt}}},jt=({route:t="",version:a="v6",iceberg:r,pageSize:e,cacheKey:o,fetchDataFn:s,refetchInterval:n,defaultSorting:i,fetchAll:l,columns:u=[],disableCache:g,enabled:f})=>{const d=!!r,c=!d&&a==="v2",I=!d&&!c,h=Vt({version:a,route:t,pageSize:e,cacheKey:o,enabled:!!(f&&d),defaultSorting:i??[],fetchAll:l,columns:u,disableCache:g}),y=Rt({route:t,pageSize:e,enabled:!!(f&&c),cacheKey:o,fetchAll:l}),T=wt({route:t,cacheKey:o,fetchDataFn:s,refetchInterval:n,enabled:!!(f&&I),pageSize:e,columns:u,defaultSorting:i});return d?h:c?y:T};function Bt(t){return`/iam/resource/${encodeURIComponent(t)}/authorization/check`}const kt=async(t,a)=>(await St.v2.post(Bt(a),{actions:t})).data;function Mt(t,a,r=!0){const{data:e,isLoading:o,isError:s,isFetching:n,refetch:i,status:l,error:u}=z({queryKey:["iam-authorization",a,t],queryFn:()=>kt(t,a),enabled:!!(a&&a.length>0&&t&&t.length>0&&r),placeholderData:Et});return{isAuthorized:!!(e!=null&&e.authorizedActions)&&t.every(f=>{var d;return(d=e==null?void 0:e.authorizedActions)==null?void 0:d.includes(f)}),data:e,isLoading:o,isError:s,isFetching:n,refetch:i,status:l,error:u}}function oe({resourceType:t,enabled:a=!0}){let r="/iam/resource";t&&(r=`${r}?resourceType=${t}`);const{flattenData:e,isError:o,isLoading:s}=jt({version:"v2",iceberg:!0,route:r,cacheKey:["iam/resource",t||""],enabled:a,fetchAll:!0});return{tags:p.useMemo(()=>e?xt(e):[],[e]),isError:o,isLoading:s}}const qt={de_DE:()=>_(m(()=>import("./Messages_de_DE-D6eaGZhM.js"),[],import.meta.url)),en_GB:()=>_(m(()=>import("./Messages_en_GB-v5ik8MVv.js"),[],import.meta.url)),es_ES:()=>_(m(()=>import("./Messages_es_ES-Cw1e7UdN.js"),[],import.meta.url)),fr_CA:()=>_(m(()=>import("./Messages_fr_CA-BygpM1se.js"),[],import.meta.url)),fr_FR:()=>_(m(()=>import("./Messages_fr_FR-BygpM1se.js"),[],import.meta.url)),it_IT:()=>_(m(()=>import("./Messages_it_IT-CC7b0OgL.js"),[],import.meta.url)),pl_PL:()=>_(m(()=>import("./Messages_pl_PL-B2f0pp2L.js"),[],import.meta.url)),pt_PT:()=>_(m(()=>import("./Messages_pt_PT-D6SX8-Eo.js"),[],import.meta.url))};B(qt,"iam");const j=({children:t,iamActions:a,urn:r,displayTooltip:e=!0,tooltipPosition:o=ft.bottom,...s})=>{const{t:n}=J("iam"),{isAuthorized:i}=Mt(a||[],r||"");return i||!(a&&r)?P.jsx(O,{"data-testid":"manager-button",...s,children:t}):e?P.jsxs(pt,{position:o,children:[P.jsx(gt,{"data-testid":"manager-button-tooltip",asChild:!0,children:P.jsx(O,{"data-testid":"manager-button-tooltip",...s,disabled:!0,children:t})}),P.jsx(ht,{children:n("common_iam_actions_message")})]}):P.jsx(O,{"data-testid":"manager-button-without-tooltip",...s,disabled:!0,children:t})};try{j.displayName="Button",j.__docgenInfo={description:"",displayName:"Button",props:{}}}catch{}const $t={de_DE:()=>_(m(()=>import("./Messages_de_DE-wV6iqazs.js"),[],import.meta.url)),en_GB:()=>_(m(()=>import("./Messages_en_GB-BZXjAwVZ.js"),[],import.meta.url)),es_ES:()=>_(m(()=>import("./Messages_es_ES-CG-rqwH1.js"),[],import.meta.url)),fr_CA:()=>_(m(()=>import("./Messages_fr_CA-BC5dFmG2.js"),[],import.meta.url)),fr_FR:()=>_(m(()=>import("./Messages_fr_FR-BC5dFmG2.js"),[],import.meta.url)),it_IT:()=>_(m(()=>import("./Messages_it_IT-BvpB8PHM.js"),[],import.meta.url)),pl_PL:()=>_(m(()=>import("./Messages_pl_PL-5NJ1ki9l.js"),[],import.meta.url)),pt_PT:()=>_(m(()=>import("./Messages_pt_PT-Hfz_XHs8.js"),[],import.meta.url))};B($t,"drawer");const G=({children:t,createPortal:a,isOpen:r,isLoading:e,onDismiss:o,className:s,trigger:n})=>{const{t:i}=J("drawer");return P.jsxs(lt,{open:r,onOpenChange:o,children:[n&&P.jsx(ct,{children:n}),P.jsx(mt,{"data-testid":"drawer",createPortal:a,position:_t.right,className:Tt("w-full sm:w-[var(--mrc-drawer-width)] max-w-full p-0 overflow-hidden",s),children:P.jsx(dt,{children:P.jsxs("div",{className:"h-screen overflow-hidden flex flex-col justify-between",children:[P.jsx(j,{"data-testid":"drawer-dismiss-button","aria-label":i("close"),onClick:o,color:st.primary,variant:it.ghost,className:"absolute top-7 right-4",children:P.jsx(at,{name:ot.xmark})}),e&&P.jsx("div",{"data-testid":"drawer-spinner",className:"h-full flex justify-center items-center",children:P.jsx(nt,{size:ut.md})}),!e&&t]})})})]})};try{G.displayName="DrawerBase",G.__docgenInfo={description:"",displayName:"DrawerBase",props:{isOpen:{defaultValue:null,description:"Open/close the drawer (default to true)",name:"isOpen",required:!1,type:{name:"boolean"}},onDismiss:{defaultValue:null,description:"Callback function to be called on close of the Drawer",name:"onDismiss",required:!0,type:{name:"() => void"}},isLoading:{defaultValue:null,description:"Show a loader instead of the drawer content",name:"isLoading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"Class name for the drawer",name:"className",required:!1,type:{name:"string"}},createPortal:{defaultValue:null,description:"Create a portal for the drawer",name:"createPortal",required:!1,type:{name:"boolean"}},trigger:{defaultValue:null,description:"Trigger for the drawer",name:"trigger",required:!1,type:{name:"ReactNode"}}}}}catch{}export{j as B,G as D,oe as a,Tt as c,Mt as u};
