import{j as g}from"./jsx-runtime-BRNY0I4F.js";import{c as oe}from"./clsx-B-dksMZM.js";import{S as se,g as ne,aq as ie,i as P,a2 as b,a3 as F,ao as ue,ap as le,a0 as k,ar as ce,as as de,aa as W,a1 as Z,u as X,x as w,k as me,I as _e,M as pe,o as fe,aj as ge,ak as he,al as ye,am as Ee,an as Ie,b as Pe,d as ve,l as Le,m as Te,f as De,s as Ae}from"./index-GPs4uoxI.js";import{r as _}from"./index-Bnop-kX6.js";import"./index-4pTrEEYx.js";import{_ as d}from"./iframe-IyM3Vz8H.js";const B=({rootLabel:t,appName:r,hideRootLabel:a=!1})=>{const{shell:e}=_.useContext(se),[o,s]=_.useState([]),[i,u]=_.useState([]),m=ne();return _.useEffect(()=>{(async()=>{try{const c=await(e==null?void 0:e.navigation.getURL(r,"#/",{})),l={label:t,href:String(c),hideLabel:a};s([l])}catch{}})()},[t,r,e==null?void 0:e.navigation]),_.useEffect(()=>{const n=m==null?void 0:m.pathname.split("/").filter(l=>l),c=n==null?void 0:n.map((l,p)=>{const f=n.slice(0,p+1);return{label:l,href:`#/${f.join("/")}`,hideLabel:!1}});u(c)},[m.pathname]),[...o,...i]};try{B.displayName="useBreadcrumb",B.__docgenInfo={description:"",displayName:"useBreadcrumb",props:{rootLabel:{defaultValue:null,description:"",name:"rootLabel",required:!1,type:{name:"string"}},appName:{defaultValue:null,description:"",name:"appName",required:!1,type:{name:"string"}},projectId:{defaultValue:null,description:"",name:"projectId",required:!1,type:{name:"string"}},hideRootLabel:{defaultValue:{value:"false"},description:"",name:"hideRootLabel",required:!1,type:{name:"boolean"}}}}}catch{}const H=({initialPageParam:t,cacheKey:r,enabled:a,fetchDataFn:e,getNextPageParam:o,transformFn:s})=>{const{data:i={},error:u,isError:m,isFetching:n,isLoading:c,isSuccess:l,status:p,fetchNextPage:f,isFetchingNextPage:y,hasNextPage:R}=ie({initialPageParam:t,queryKey:r,staleTime:1/0,retry:!1,enabled:a,queryFn:E=>e({pageParam:E.pageParam}),getNextPageParam:(E,T,v)=>o(E,v),select:E=>s(E.pages,E.pageParams)});return{data:i,error:u,isError:m,isFetching:n,isLoading:c,isSuccess:l,status:p,fetchNextPage:f,isFetchingNextPage:y,hasNextPage:R}},be=10,D="fr_FR",J=t=>{let r=t.replace("-","_");return r.includes("_")||(r==="en"?r="en_GB":r=`${r}_${r.toUpperCase()}`),r},Re=(t,r)=>async a=>{const e=J(a);if(!P.hasResourceBundle(D,r))try{console.info(`Loading fallback language: ${D} for namespace: ${r}`);const o=t[D];if(o){const s=await o();P.addResources(D,r,s.default||s)}}catch(o){console.error(`Failed to load fallback translations (${D}):`,o)}if(e!==D&&!P.hasResourceBundle(e,r))try{const o=t[e];if(o){const s=await o();P.addResources(e,r,s.default||s)}}catch(o){console.warn(`Could not load ${e}. Will fallback to ${D}.`,o)}return!0},$=(t,r)=>{const a=Re(t,r),e=async o=>{const s=J(o);await a(s),console.log("Language changed to:",s)};P.isInitialized?e(P.language):P.on("initialized",()=>{e(P.language)}),P.on("languageChanged",e)},xe={de_DE:()=>d(()=>import("./Messages_de_DE-D5f6W0Yw.js"),[],import.meta.url),en_GB:()=>d(()=>import("./Messages_en_GB-BltaFNOq.js"),[],import.meta.url),es_ES:()=>d(()=>import("./Messages_es_ES-DyWxB-jy.js"),[],import.meta.url),fr_CA:()=>d(()=>import("./Messages_fr_CA-DZWsQWuS.js"),[],import.meta.url),fr_FR:()=>d(()=>import("./Messages_fr_FR-DZWsQWuS.js"),[],import.meta.url),it_IT:()=>d(()=>import("./Messages_it_IT-C7wNa0HS.js"),[],import.meta.url),pl_PL:()=>d(()=>import("./Messages_pl_PL-CPCy3MZ1.js"),[],import.meta.url),pt_PT:()=>d(()=>import("./Messages_pt_PT-DmK6yNEQ.js"),[],import.meta.url)};$(xe,"filters");const M=(t,r)=>t.key===r.key&&t.value===r.value&&t.comparator===r.comparator;function Ve(){const[t,r]=_.useState([]);return{filters:t,addFilter:a=>{(a.value||a.type===b.Tags&&[F.TagExists,F.TagNotExists].includes(a.comparator))&&r(e=>e.some(o=>M(o,a))?e:[...e,a])},removeFilter:a=>{r(e=>e.filter(o=>!M(o,a)))}}}const Y=({defaultSorting:t,columns:r=[]})=>{const[a,e]=_.useState(""),[o,s]=_.useState([]),[i,u]=_.useState(t),{filters:m,addFilter:n,removeFilter:c}=Ve(),l=_.useMemo(()=>r.filter(f=>f.isSearchable),[r]),p=_.useCallback(f=>{s(f?l.map(({id:y})=>({key:y,value:f,comparator:F.Includes})):[])},[l]);return{searchInput:a,setSearchInput:e,searchFilters:o,setSearchFilters:s,sorting:i,setSorting:u,filters:m,addFilter:n,removeFilter:c,onSearch:p}},Ce=4999,Ne=({version:t="v6",route:r="",pageSize:a=be,cacheKey:e,defaultSorting:o=void 0,fetchAll:s=!1,columns:i=[],disableCache:u,enabled:m=!0})=>{const{searchInput:n,setSearchInput:c,searchFilters:l,sorting:p,setSorting:f,filters:y,addFilter:R,removeFilter:E,onSearch:T}=Y({defaultSorting:o,columns:i}),{data:v,hasNextPage:x,fetchNextPage:V,...L}=H({initialPageParam:1,cacheKey:[...typeof e=="string"?[e]:e,s?"all":a,p,y,l],enabled:m,fetchDataFn:({pageParam:I})=>{var h,A;return ue({version:t,route:r,pageSize:s?Ce:a,...typeof I=="number"&&{page:I},sortBy:(h=p==null?void 0:p[0])==null?void 0:h.id,sortOrder:(A=p==null?void 0:p[0])!=null&&A.desc?"DESC":"ASC",filters:l?[...l,...y]:y,disableCache:u})},getNextPageParam:(I,h)=>I.totalCount/a>h?h+1:null,transformFn:(I,h)=>{const A=h[h.length-1],{totalCount:C}=I[0];return{pageIndex:A,totalCount:C,flattenData:I.flatMap(N=>N.data)}}});return _.useEffect(()=>{s&&x&&V()},[v]),{...v&&{...v},hasNextPage:x,fetchNextPage:V,sorting:{sorting:p,setSorting:f,manualSorting:!0},filters:{filters:y,add:R,remove:E},search:{onSearch:T,searchInput:n,setSearchInput:c},...L}},Se=({route:t="",pageSize:r=10,fetchAll:a=!1,cacheKey:e,enabled:o})=>{const{data:s,hasNextPage:i,fetchNextPage:u,...m}=H({initialPageParam:"",cacheKey:[...e,a?"all":String(r)],enabled:o??!0,fetchDataFn:({pageParam:n})=>le({route:t,pageSize:r,...!!n&&typeof n=="string"&&{cursor:n}}),getNextPageParam:n=>n.nextCursor?n.nextCursor:null,transformFn:n=>{const{totalCount:c}=n[0];return{flattenData:n.flatMap(l=>l.data),totalCount:c}}});return _.useEffect(()=>{a&&i&&u()},[s]),{...s&&{...s},hasNextPage:i,fetchNextPage:u,...m}},we=({cacheKey:t,fetchDataFn:r,refetchInterval:a,enabled:e})=>{const{data:o={},error:s,isError:i,isFetching:u,isLoading:m,isSuccess:n,status:c}=k({queryKey:t,queryFn:()=>r(),refetchInterval:a,enabled:e,retry:!1});return{data:o,error:s,isError:i,isFetching:u,isLoading:m,isSuccess:n,status:c}},G=t=>t==="true",Fe=(t,r,a,e)=>{var i,u;if(!r||!a)return-1;const o=e?a:r,s=e?r:a;switch(t){case b.Numeric:return parseFloat(o)-parseFloat(s);case b.Date:return new Date(o).getTime()-new Date(s).getTime();case b.Boolean:return Number(G(o))-Number(G(s));case b.String:return(u=(i=o==null?void 0:o.trim().toLowerCase())==null?void 0:i.localeCompare)==null?void 0:u.call(i,s==null?void 0:s.trim().toLowerCase());default:return-1}},Oe=({items:t=[],filters:r,searchFilters:a,sorting:e,columns:o})=>{const s=_.useMemo(()=>!r.length&&!a.length?t:ce(t,[...r,...a]),[t,r,a]);return{filteredAndSortedData:_.useMemo(()=>{var u;if(e){const m=((u=o.find(n=>{var c;return n.id===((c=e[0])==null?void 0:c.id)}))==null?void 0:u.type)||b.String;return[...s].sort((n,c)=>{var l,p,f;return Fe(m,`${n==null?void 0:n[(l=e[0])==null?void 0:l.id]}`,`${c==null?void 0:c[(p=e[0])==null?void 0:p.id]}`,(f=e[0])==null?void 0:f.desc)})}return s},[s,e])}},qe=({route:t="",cacheKey:r,fetchDataFn:a,refetchInterval:e,pageSize:o=10,columns:s=[],defaultSorting:i,enabled:u=!0})=>{const{searchInput:m,setSearchInput:n,searchFilters:c,sorting:l,setSorting:p,filters:f,addFilter:y,removeFilter:R,onSearch:E}=Y({defaultSorting:i,columns:s}),[T,v]=_.useState(0),[x,V]=_.useState(0),[L,I]=_.useState([]),{data:h,error:A,isError:C,isFetching:N,isLoading:z,isSuccess:ee,status:te}=we({cacheKey:[r],fetchDataFn:()=>a?a(t):de.get(t),refetchInterval:e||!1,enabled:u}),{filteredAndSortedData:S}=Oe({items:h==null?void 0:h.data,columns:s,filters:f,searchFilters:c,sorting:l});_.useEffect(()=>{z||(V(S.length),v(0),I(S))},[S]);const re=_.useCallback(()=>v(ae=>ae+1),[T]);return{error:A,isError:C,isFetching:N,isSuccess:ee,status:te,isLoading:z,pageIndex:T,totalCount:x,flattenData:L==null?void 0:L.slice(0,(T+1)*o),hasNextPage:T*o+o<(L==null?void 0:L.length),fetchNextPage:re,sorting:{sorting:l,setSorting:p,manualSorting:!0},filters:{filters:f,add:y,remove:R},search:{onSearch:E,searchInput:m,setSearchInput:n}}},je=({route:t="",version:r="v6",iceberg:a,pageSize:e,cacheKey:o,fetchDataFn:s,refetchInterval:i,defaultSorting:u,fetchAll:m,columns:n=[],disableCache:c,enabled:l})=>a?Ne({version:r,route:t,pageSize:e,cacheKey:o,enabled:l,defaultSorting:u??[],fetchAll:m,columns:n,disableCache:c}):r==="v2"?Se({route:t,pageSize:e,enabled:l,cacheKey:o,fetchAll:m}):qe({route:t,cacheKey:o,fetchDataFn:s,refetchInterval:i,enabled:l,pageSize:e,columns:n,defaultSorting:u}),ke=t=>{const r=new Map;return t.forEach(a=>{a.tags&&Object.entries(a.tags).forEach(([e,o])=>{var s;e.startsWith("ovh:")||(r.has(e)?(s=r.get(e))==null||s.add(o):r.set(e,new Set([o])))})}),Array.from(r.entries()).map(([a,e])=>({key:a,values:Array.from(e)}))},O=async({actions:t,urns:r})=>{var e;const a=await((e=W.v2)==null?void 0:e.post("/iam/authorization/check",{actions:t,resourceURNs:r}));return a==null?void 0:a.data};function U({actions:t,urns:r}){const{data:a}=k({queryKey:["iam-authorization",r,t],queryFn:()=>O({actions:t||[],urns:r||[]}),enabled:((r==null?void 0:r.length)||0)>0&&((t==null?void 0:t.length)||0)>0,placeholderData:Z});return a||[]}function q(t){return`/iam/resource/${encodeURIComponent(t)}/authorization/check`}const $e=async(t,r)=>{var e;const a=await((e=W.v2)==null?void 0:e.post(q(r),{actions:t}));return a==null?void 0:a.data};function ze(t,r,a=!0){const{data:e,...o}=k({queryKey:[r,t],queryFn:()=>$e(t,r),enabled:!!(r&&r.length>0&&t&&t.length>0&&a),placeholderData:Z});return{isAuthorized:!!(e!=null&&e.authorizedActions)&&t.every(s=>{var i;return(i=e==null?void 0:e.authorizedActions)==null?void 0:i.includes(s)}),data:e,...o}}function K({resourceType:t,enabled:r=!0}){let a="/iam/resource";t&&(a=`${a}?resourceType=${t}`);const{flattenData:e,isError:o,isLoading:s}=je({version:"v2",iceberg:!0,route:a,cacheKey:["iam/resource",t||""],enabled:r,fetchAll:!0});return{tags:_.useMemo(()=>e?ke(e):[],[e]),isError:o,isLoading:s}}try{U.displayName="useAuthorizationsIam",U.__docgenInfo={description:"",displayName:"useAuthorizationsIam",props:{urns:{defaultValue:null,description:"",name:"urns",required:!1,type:{name:"string[]"}},actions:{defaultValue:null,description:"",name:"actions",required:!1,type:{name:"string[]"}}}}}catch{}try{q.displayName="getAuthorizationCheckUrl",q.__docgenInfo={description:"",displayName:"getAuthorizationCheckUrl",props:{}}}catch{}try{K.displayName="useGetResourceTags",K.__docgenInfo={description:"",displayName:"useGetResourceTags",props:{resourceType:{defaultValue:null,description:"",name:"resourceType",required:!1,type:{name:"string"}},enabled:{defaultValue:{value:"true"},description:"",name:"enabled",required:!1,type:{name:"boolean"}}}}}catch{}try{O.displayName="fetchAuthorizationsCheck",O.__docgenInfo={description:"",displayName:"fetchAuthorizationsCheck",props:{actions:{defaultValue:null,description:"",name:"actions",required:!0,type:{name:"string[]"}},urns:{defaultValue:null,description:"",name:"urns",required:!0,type:{name:"string[]"}}}}}catch{}const Be={de_DE:()=>d(()=>import("./Messages_de_DE-D6eaGZhM.js"),[],import.meta.url),en_GB:()=>d(()=>import("./Messages_en_GB-v5ik8MVv.js"),[],import.meta.url),es_ES:()=>d(()=>import("./Messages_es_ES-Cw1e7UdN.js"),[],import.meta.url),fr_CA:()=>d(()=>import("./Messages_fr_CA-BygpM1se.js"),[],import.meta.url),fr_FR:()=>d(()=>import("./Messages_fr_FR-BygpM1se.js"),[],import.meta.url),it_IT:()=>d(()=>import("./Messages_it_IT-CC7b0OgL.js"),[],import.meta.url),pl_PL:()=>d(()=>import("./Messages_pl_PL-D5VHLQw3.js"),[],import.meta.url),pt_PT:()=>d(()=>import("./Messages_pt_PT-D6SX8-Eo.js"),[],import.meta.url)};$(Be,"iam");const j=({children:t,iamActions:r,urn:a,displayTooltip:e=!0,tooltipPosition:o=fe.bottom,isIamTrigger:s=!0,...i})=>{const{t:u}=X("iam"),{isAuthorized:m}=ze(r||[],a||"");return m||!(r&&a)?g.jsx(w,{"data-testid":"manager-button",...i,children:t}):e?g.jsxs(me,{position:o,children:[g.jsx(_e,{"data-testid":"manager-button-tooltip",asChild:!0,children:g.jsx(w,{"data-testid":"manager-button-tooltip",...i,disabled:!0,children:t})}),g.jsx(pe,{children:u("common_iam_actions_message")})]}):g.jsx(w,{"data-testid":"manager-button-without-tooltip",...i,disabled:!0,children:t})};try{j.displayName="Button",j.__docgenInfo={description:"",displayName:"Button",props:{}}}catch{}const Me={de_DE:()=>d(()=>import("./Messages_de_DE-wV6iqazs.js"),[],import.meta.url),en_GB:()=>d(()=>import("./Messages_en_GB-BZXjAwVZ.js"),[],import.meta.url),es_ES:()=>d(()=>import("./Messages_es_ES-CG-rqwH1.js"),[],import.meta.url),fr_CA:()=>d(()=>import("./Messages_fr_CA-BC5dFmG2.js"),[],import.meta.url),fr_FR:()=>d(()=>import("./Messages_fr_FR-BC5dFmG2.js"),[],import.meta.url),it_IT:()=>d(()=>import("./Messages_it_IT-BvpB8PHM.js"),[],import.meta.url),pl_PL:()=>d(()=>import("./Messages_pl_PL-5NJ1ki9l.js"),[],import.meta.url),pt_PT:()=>d(()=>import("./Messages_pt_PT-Hfz_XHs8.js"),[],import.meta.url)};$(Me,"drawer");const Q=({children:t,createPortal:r,isOpen:a,isLoading:e,onDismiss:o,className:s,trigger:i})=>{const{t:u}=X("drawer");return g.jsxs(ge,{open:a,onOpenChange:o,children:[i&&g.jsx(he,{children:i}),g.jsx(ye,{"data-testid":"drawer",createPortal:r,position:Ee.right,className:oe("w-full sm:w-[var(--mrc-drawer-width)] max-w-full p-0 overflow-hidden",s),children:g.jsx(Ie,{children:g.jsxs("div",{className:"h-screen overflow-hidden flex flex-col justify-between",children:[g.jsx(j,{"data-testid":"drawer-dismiss-button","aria-label":u("close"),onClick:o,color:Pe.primary,variant:ve.ghost,className:"absolute top-7 right-4",children:g.jsx(Le,{name:Te.xmark})}),e&&g.jsx("div",{"data-testid":"drawer-spinner",className:"h-full flex justify-center items-center",children:g.jsx(De,{size:Ae.md})}),!e&&t]})})})]})};try{Q.displayName="DrawerBase",Q.__docgenInfo={description:"",displayName:"DrawerBase",props:{isOpen:{defaultValue:null,description:"Open/close the drawer (default to true)",name:"isOpen",required:!1,type:{name:"boolean"}},onDismiss:{defaultValue:null,description:"Callback function to be called on close of the Drawer",name:"onDismiss",required:!0,type:{name:"() => void"}},isLoading:{defaultValue:null,description:"Show a loader instead of the drawer content",name:"isLoading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"Class name for the drawer",name:"className",required:!1,type:{name:"string"}},createPortal:{defaultValue:null,description:"Create a portal for the drawer",name:"createPortal",required:!1,type:{name:"boolean"}},trigger:{defaultValue:null,description:"Trigger for the drawer",name:"trigger",required:!1,type:{name:"ReactNode"}}}}}catch{}export{j as B,Q as D,B as a,$ as b,K as c,J as n,ze as u};
