{"version":3,"file":"filters.stories-f81775a5.js","sources":["../../../manager/core/api/dist/filters.js","../../src/components/filters/translations/index.ts","../../src/components/filters/filter-add.component.tsx","../../src/components/filters/filter-list.component.tsx","../../src/components/filters/useColumnFilters.tsx"],"sourcesContent":["export var FilterComparator;\n(function (FilterComparator) {\n    FilterComparator[\"Includes\"] = \"includes\";\n    FilterComparator[\"StartsWith\"] = \"starts_with\";\n    FilterComparator[\"EndsWith\"] = \"ends_with\";\n    FilterComparator[\"IsEqual\"] = \"is_equal\";\n    FilterComparator[\"IsDifferent\"] = \"is_different\";\n    FilterComparator[\"IsLower\"] = \"is_lower\";\n    FilterComparator[\"IsHigher\"] = \"is_higher\";\n    FilterComparator[\"IsBefore\"] = \"is_before\";\n    FilterComparator[\"IsAfter\"] = \"is_after\";\n    FilterComparator[\"IsIn\"] = \"is_in\";\n})(FilterComparator || (FilterComparator = {}));\nexport const FilterCategories = {\n    Numeric: [\n        FilterComparator.IsEqual,\n        FilterComparator.IsDifferent,\n        FilterComparator.IsLower,\n        FilterComparator.IsHigher,\n    ],\n    String: [\n        FilterComparator.Includes,\n        FilterComparator.StartsWith,\n        FilterComparator.EndsWith,\n        FilterComparator.IsEqual,\n        FilterComparator.IsDifferent,\n    ],\n    Date: [\n        FilterComparator.IsEqual,\n        FilterComparator.IsDifferent,\n        FilterComparator.IsBefore,\n        FilterComparator.IsAfter,\n    ],\n};\nexport function applyFilters(items = [], filters = []) {\n    return items.filter((item) => {\n        let keep = true;\n        filters.forEach((filter) => {\n            const value = item[filter.key];\n            const comp = filter.value;\n            switch (filter.comparator) {\n                case FilterComparator.Includes:\n                    keep = keep && `${value}`.toLowerCase().includes(comp.toLowerCase());\n                    break;\n                case FilterComparator.StartsWith:\n                    keep =\n                        keep && `${value}`.toLowerCase().startsWith(comp.toLowerCase());\n                    break;\n                case FilterComparator.EndsWith:\n                    keep = keep && `${value}`.toLowerCase().endsWith(comp.toLowerCase());\n                    break;\n                case FilterComparator.IsEqual:\n                    keep = keep && `${value}`.toLowerCase() === comp.toLowerCase();\n                    break;\n                case FilterComparator.IsDifferent:\n                    keep = keep && `${value}`.toLowerCase() !== comp.toLowerCase();\n                    break;\n                case FilterComparator.IsLower:\n                    keep = keep && Number(value) < Number(comp);\n                    break;\n                case FilterComparator.IsHigher:\n                    keep = keep && Number(value) > Number(comp);\n                    break;\n                case FilterComparator.IsBefore:\n                    keep = keep && new Date(`${value}`) < new Date(comp);\n                    break;\n                case FilterComparator.IsAfter:\n                    keep = keep && new Date(`${value}`) > new Date(comp);\n                    break;\n                case FilterComparator.IsIn:\n                    keep =\n                        keep && !!filter.value.find((i) => i === `${value}`);\n                    break;\n                default:\n                    break;\n            }\n        });\n        return keep;\n    });\n}\n","import i18next from 'i18next';\n\nimport de_DE from './Messages_de_DE.json';\nimport en_GB from './Messages_en_GB.json';\nimport es_ES from './Messages_es_ES.json';\nimport fr_CA from './Messages_fr_CA.json';\nimport fr_FR from './Messages_fr_FR.json';\nimport it_IT from './Messages_it_IT.json';\nimport pl_PL from './Messages_pl_PL.json';\nimport pt_PT from './Messages_pt_PT.json';\n\nfunction addTranslations() {\n  i18next.addResources('de_DE', 'filters', de_DE);\n  i18next.addResources('en_GB', 'filters', en_GB);\n  i18next.addResources('es_ES', 'filters', es_ES);\n  i18next.addResources('fr_CA', 'filters', fr_CA);\n  i18next.addResources('fr_FR', 'filters', fr_FR);\n  i18next.addResources('it_IT', 'filters', it_IT);\n  i18next.addResources('pl_PL', 'filters', pl_PL);\n  i18next.addResources('pt_PT', 'filters', pt_PT);\n}\n\nif (i18next.isInitialized) {\n  addTranslations();\n} else {\n  i18next.on('initialized', addTranslations);\n}\n","import React, { useMemo, useState } from 'react';\nimport { Filter, FilterComparator } from '@ovh-ux/manager-core-api';\nimport { ODS_THEME_COLOR_INTENT } from '@ovhcloud/ods-common-theming';\nimport {\n  ODS_BUTTON_SIZE,\n  ODS_INPUT_TYPE,\n  ODS_TEXT_LEVEL,\n} from '@ovhcloud/ods-components';\nimport {\n  OsdsButton,\n  OsdsFormField,\n  OsdsInput,\n  OsdsSelect,\n  OsdsSelectOption,\n  OsdsText,\n} from '@ovhcloud/ods-components/react';\nimport { useTranslation } from 'react-i18next';\nimport './translations';\n\ntype ColumnFilter = {\n  id: string;\n  label: string;\n  comparators: FilterComparator[];\n};\n\nexport type FilterAddProps = {\n  columns: ColumnFilter[];\n  onAddFilter: (filter: Filter, column: ColumnFilter) => void;\n};\n\nexport function FilterAdd({ columns, onAddFilter }: Readonly<FilterAddProps>) {\n  const { t } = useTranslation('filters');\n\n  const [selectedId, setSelectedId] = useState(columns?.[0]?.id || '');\n  const [selectedComparator, setSelectedComparator] = useState(\n    columns?.[0]?.comparators?.[0] || FilterComparator.IsEqual,\n  );\n  const [value, setValue] = useState('');\n\n  const selectedColumn = useMemo(\n    () => columns.find(({ id }) => selectedId === id),\n    [columns, selectedId],\n  );\n\n  const submitAddFilter = () => {\n    onAddFilter(\n      {\n        key: selectedId,\n        comparator: selectedComparator,\n        value,\n      },\n      selectedColumn,\n    );\n    setValue('');\n  };\n\n  return (\n    <>\n      <OsdsFormField>\n        <div slot=\"label\">\n          <OsdsText\n            level={ODS_TEXT_LEVEL.heading}\n            color={ODS_THEME_COLOR_INTENT.text}\n          >\n            {t('common_criteria_adder_column_label')}\n          </OsdsText>\n        </div>\n        <OsdsSelect\n          value={selectedId}\n          data-testid=\"add-filter_select_idColumn\"\n          onOdsValueChange={(event) =>\n            setSelectedId(event.detail.value as string)\n          }\n        >\n          {columns.map(({ id, label }) => (\n            <OsdsSelectOption key={id} value={id}>\n              {label}\n            </OsdsSelectOption>\n          ))}\n        </OsdsSelect>\n      </OsdsFormField>\n      <OsdsFormField className=\"mt-2\">\n        <div slot=\"label\">\n          <OsdsText\n            level={ODS_TEXT_LEVEL.heading}\n            color={ODS_THEME_COLOR_INTENT.text}\n          >\n            {t('common_criteria_adder_operator_label')}\n          </OsdsText>\n        </div>\n        <OsdsSelect\n          value={selectedComparator}\n          onOdsValueChange={(event) => {\n            setSelectedComparator(event.detail.value as FilterComparator);\n          }}\n        >\n          {selectedColumn?.comparators?.map((comp) => (\n            <OsdsSelectOption key={comp} value={comp}>\n              {t(`${'common_criteria_adder_operator_'}${comp}`)}\n            </OsdsSelectOption>\n          ))}\n        </OsdsSelect>\n      </OsdsFormField>\n      <OsdsFormField className=\"mt-2\">\n        <div slot=\"label\">\n          <OsdsText\n            level={ODS_TEXT_LEVEL.heading}\n            color={ODS_THEME_COLOR_INTENT.text}\n          >\n            {t('common_criteria_adder_value_label')}\n          </OsdsText>\n        </div>\n\n        <OsdsInput\n          className=\"border\"\n          type={ODS_INPUT_TYPE.text}\n          color={ODS_THEME_COLOR_INTENT.primary}\n          value={value}\n          data-testid=\"filter-add_value-input\"\n          onOdsValueChange={(e) => setValue(`${e.detail.value}`)}\n          onKeyDown={(e) => {\n            if (e.key === 'Enter') {\n              submitAddFilter();\n            }\n          }}\n        />\n      </OsdsFormField>\n      <OsdsButton\n        className=\"mt-4\"\n        color={ODS_THEME_COLOR_INTENT.primary}\n        size={ODS_BUTTON_SIZE.sm}\n        disabled={value ? undefined : true}\n        onClick={submitAddFilter}\n        data-testid=\"filter-add_submit\"\n      >\n        {t('common_criteria_adder_submit_label')}\n      </OsdsButton>\n    </>\n  );\n}\n","import React from 'react';\nimport { OsdsChip } from '@ovhcloud/ods-components/react';\nimport { ODS_THEME_COLOR_INTENT } from '@ovhcloud/ods-common-theming';\nimport { useTranslation } from 'react-i18next';\nimport { FilterWithLabel } from './interface';\nimport './translations';\n\nexport type FilterListProps = {\n  filters: FilterWithLabel[];\n  onRemoveFilter: (filter: FilterWithLabel) => void;\n};\n\nexport function FilterList({\n  filters,\n  onRemoveFilter,\n}: Readonly<FilterListProps>) {\n  const { t } = useTranslation('filters');\n  const tComp = (comparator: string) =>\n    t(`common_criteria_adder_operator_${comparator}`);\n\n  return (\n    <>\n      {filters?.map((filter, key) => (\n        <OsdsChip\n          className=\"m-3\"\n          color={ODS_THEME_COLOR_INTENT.primary}\n          key={key}\n          inline={true}\n          removable={true}\n          onOdsChipRemoval={() => onRemoveFilter(filter)}\n          data-testid=\"filter-list_chip_item\"\n        >\n          {filter.label ? `${filter.label} ${tComp(filter.comparator)} ` : ''}\n          {filter.value}\n        </OsdsChip>\n      ))}\n    </>\n  );\n}\n","import { Filter } from '@ovh-ux/manager-core-api';\nimport { useState } from 'react';\nimport { FilterWithLabel } from './interface';\nimport './translations';\n\nconst filterEquals = (a: Filter, b: Filter) =>\n  a.key === b.key && a.value === b.value && a.comparator === b.comparator;\n\nexport function useColumnFilters() {\n  const [filters, setFilters] = useState<FilterWithLabel[]>([]);\n\n  return {\n    filters,\n    addFilter: (filter: FilterWithLabel) => {\n      if (filter.value) {\n        setFilters((previousFilters) => {\n          /**\n           * ? To remove the duplication from the filters\n           */\n          if (previousFilters.some((f) => filterEquals(f, filter))) {\n            return previousFilters;\n          }\n          return [...previousFilters, filter];\n        });\n      }\n    },\n    removeFilter: (filter: Filter) => {\n      setFilters((previousFilters) =>\n        previousFilters.filter((f) => !filterEquals(f, filter)),\n      );\n    },\n  };\n}\n"],"names":["FilterComparator","FilterCategories","addTranslations","i18next","de_DE","en_GB","es_ES","fr_CA","fr_FR","it_IT","pl_PL","pt_PT","FilterAdd","columns","onAddFilter","t","useTranslation","selectedId","setSelectedId","useState","_a","selectedComparator","setSelectedComparator","_c","_b","value","setValue","selectedColumn","useMemo","id","submitAddFilter","jsxs","Fragment","OsdsFormField","jsx","OsdsText","ODS_TEXT_LEVEL","ODS_THEME_COLOR_INTENT","OsdsSelect","event","label","OsdsSelectOption","_d","comp","OsdsInput","ODS_INPUT_TYPE","e","OsdsButton","ODS_BUTTON_SIZE","FilterList","filters","onRemoveFilter","tComp","comparator","filter","key","OsdsChip","filterEquals","a","b","useColumnFilters","setFilters","previousFilters","f"],"mappings":"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"}