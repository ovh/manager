import{j as l}from"./jsx-runtime-BRNY0I4F.js";import{o as K}from"./ods-react235-BTQ8kVBe.js";import{k as M,j as H}from"./portal-BnVBD_Bd-CMtQ-rJ7.js";import{D as T,L as W,k as X}from"./use-presence-CVI6Oc63-Cg7Clpcl.js";import{X as U,t as P,v as h,E as Y,x as z,T as J,O as Q,w as Z,V as ee,Y as te,$ as oe,G as re,g as ne,a0 as se,a1 as F,D as x,A as ie}from"./use-locale-context-cwTY9VYn-REDUMe7F.js";import{y as ae,x as N}from"./index-C7dNzIpW-BlUnPWgK.js";import{a as pe,r as le,o as de}from"./index-BAi52a_A-BVjZSJoF.js";import{y as ce}from"./index-DB9CF8IY-DC0Y2KvY.js";import{r as a}from"./index-Bnop-kX6.js";import{m as D}from"./index-2w0W-O47-BJ19ihbZ.js";const[ue,C]=U({name:"PopoverContext",hookName:"usePopoverContext",providerName:"<PopoverProvider />"}),j=a.forwardRef((e,t)=>{const o=C(),r=P(o.getArrowProps(),e);return l.jsx(h.div,{...r,ref:t})});j.displayName="PopoverArrow";const L=a.forwardRef((e,t)=>{const o=C(),r=P(o.getArrowTipProps(),e);return l.jsx(h.div,{...r,ref:t})});L.displayName="PopoverArrowTip";const S=a.forwardRef((e,t)=>{const o=C(),r=T(),n=P(o.getContentProps(),r.getPresenceProps(),e);return r.unmounted?null:l.jsx(h.div,{...n,ref:Y(r.ref,t)})});S.displayName="PopoverContent";const $=a.forwardRef((e,t)=>{const o=C(),r=T(),n=P(o.getPositionerProps(),e);return r.unmounted?null:l.jsx(h.div,{...n,ref:t})});$.displayName="PopoverPositioner";var ge=z("popover").parts("arrow","arrowTip","anchor","trigger","indicator","positioner","content","title","description","closeTrigger"),g=ge.build(),B=e=>{var t;return((t=e.ids)==null?void 0:t.anchor)??`popover:${e.id}:anchor`},G=e=>{var t;return((t=e.ids)==null?void 0:t.trigger)??`popover:${e.id}:trigger`},y=e=>{var t;return((t=e.ids)==null?void 0:t.content)??`popover:${e.id}:content`},A=e=>{var t;return((t=e.ids)==null?void 0:t.positioner)??`popover:${e.id}:popper`},me=e=>{var t;return((t=e.ids)==null?void 0:t.arrow)??`popover:${e.id}:arrow`},I=e=>{var t;return((t=e.ids)==null?void 0:t.title)??`popover:${e.id}:title`},w=e=>{var t;return((t=e.ids)==null?void 0:t.description)??`popover:${e.id}:desc`},ve=e=>{var t;return((t=e.ids)==null?void 0:t.closeTrigger)??`popover:${e.id}:close`},k=e=>e.getById(B(e)),O=e=>e.getById(G(e)),f=e=>e.getById(y(e)),R=e=>e.getById(A(e)),Oe=e=>e.getById(I(e)),fe=e=>e.getById(w(e));function Pe(e,t){const{state:o,context:r,send:n,computed:s,prop:i,scope:d}=e,c=o.matches("open"),m=r.get("currentPlacement"),u=s("currentPortalled"),E=r.get("renderedElements"),v=ae({...i("positioning"),placement:m});return{portalled:u,open:c,setOpen(p){o.matches("open")!==p&&n({type:p?"OPEN":"CLOSE"})},reposition(p={}){n({type:"POSITIONING.SET",options:p})},getArrowProps(){return t.element({id:me(d),...g.arrow.attrs,dir:i("dir"),style:v.arrow})},getArrowTipProps(){return t.element({...g.arrowTip.attrs,dir:i("dir"),style:v.arrowTip})},getAnchorProps(){return t.element({...g.anchor.attrs,dir:i("dir"),id:B(d)})},getTriggerProps(){return t.button({...g.trigger.attrs,dir:i("dir"),type:"button","data-placement":m,id:G(d),"aria-haspopup":"dialog","aria-expanded":c,"data-state":c?"open":"closed","aria-controls":y(d),onPointerDown(p){te(p)&&oe()&&p.currentTarget.focus()},onClick(p){p.defaultPrevented||n({type:"TOGGLE"})},onBlur(p){n({type:"TRIGGER_BLUR",target:p.relatedTarget})}})},getIndicatorProps(){return t.element({...g.indicator.attrs,dir:i("dir"),"data-state":c?"open":"closed"})},getPositionerProps(){return t.element({id:A(d),...g.positioner.attrs,dir:i("dir"),style:v.floating})},getContentProps(){return t.element({...g.content.attrs,dir:i("dir"),id:y(d),tabIndex:-1,role:"dialog",hidden:!c,"data-state":c?"open":"closed","data-expanded":re(c),"aria-labelledby":E.title?I(d):void 0,"aria-describedby":E.description?w(d):void 0,"data-placement":m})},getTitleProps(){return t.element({...g.title.attrs,id:I(d),dir:i("dir")})},getDescriptionProps(){return t.element({...g.description.attrs,id:w(d),dir:i("dir")})},getCloseTriggerProps(){return t.button({...g.closeTrigger.attrs,dir:i("dir"),id:ve(d),type:"button","aria-label":"close",onClick(p){p.defaultPrevented||(p.stopPropagation(),n({type:"CLOSE"}))}})}}}var Ee=ne({props({props:e}){return{closeOnInteractOutside:!0,closeOnEscape:!0,autoFocus:!0,modal:!1,portalled:!0,...e,positioning:{placement:"bottom",...e.positioning}}},initialState({prop:e}){return e("open")||e("defaultOpen")?"open":"closed"},context({bindable:e}){return{currentPlacement:e(()=>({defaultValue:void 0})),renderedElements:e(()=>({defaultValue:{title:!0,description:!0}}))}},computed:{currentPortalled:({prop:e})=>!!e("modal")||!!e("portalled")},watch({track:e,prop:t,action:o}){e([()=>t("open")],()=>{o(["toggleVisibility"])})},entry:["checkRenderedElements"],states:{closed:{on:{"CONTROLLED.OPEN":{target:"open",actions:["setInitialFocus"]},TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}],OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}]}},open:{effects:["trapFocus","preventScroll","hideContentBelow","trackPositioning","trackDismissableElement","proxyTabFocus"],on:{"CONTROLLED.CLOSE":{target:"closed",actions:["setFinalFocus"]},CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose","setFinalFocus"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}],"POSITIONING.SET":{actions:["reposition"]}}}},implementations:{guards:{isOpenControlled:({prop:e})=>e("open")!=null},effects:{trackPositioning({context:e,prop:t,scope:o}){e.set("currentPlacement",t("positioning").placement);const r=k(o)??O(o);return N(r,()=>R(o),{...t("positioning"),defer:!0,onComplete(n){e.set("currentPlacement",n.placement)}})},trackDismissableElement({send:e,prop:t,scope:o}){const r=()=>f(o);let n=!0;return ce(r,{type:"popover",pointerBlocking:t("modal"),exclude:O(o),defer:!0,onEscapeKeyDown(s){var i;(i=t("onEscapeKeyDown"))==null||i(s),!t("closeOnEscape")&&s.preventDefault()},onInteractOutside(s){var i;(i=t("onInteractOutside"))==null||i(s),!s.defaultPrevented&&(n=!(s.detail.focusable||s.detail.contextmenu),t("closeOnInteractOutside")||s.preventDefault())},onPointerDownOutside:t("onPointerDownOutside"),onFocusOutside:t("onFocusOutside"),persistentElements:t("persistentElements"),onRequestDismiss:t("onRequestDismiss"),onDismiss(){e({type:"CLOSE",src:"interact-outside",restoreFocus:n})}})},proxyTabFocus({prop:e,scope:t}){return e("modal")||!e("portalled")?void 0:se(()=>f(t),{triggerElement:O(t),defer:!0,onFocus(o){o.focus({preventScroll:!0})}})},hideContentBelow({prop:e,scope:t}){return e("modal")?pe(()=>[f(t),O(t)],{defer:!0}):void 0},preventScroll({prop:e,scope:t}){if(e("modal"))return le(t.getDoc())},trapFocus({prop:e,scope:t}){return e("modal")?de(()=>f(t),{initialFocus:()=>F({root:f(t),getInitialEl:e("initialFocusEl"),enabled:e("autoFocus")})}):void 0}},actions:{reposition({event:e,prop:t,scope:o,context:r}){const n=k(o)??O(o);N(n,()=>R(o),{...t("positioning"),...e.options,defer:!0,listeners:!1,onComplete(s){r.set("currentPlacement",s.placement)}})},checkRenderedElements({context:e,scope:t}){x(()=>{Object.assign(e.get("renderedElements"),{title:!!Oe(t),description:!!fe(t)})})},setInitialFocus({prop:e,scope:t}){e("modal")||x(()=>{const o=F({root:f(t),getInitialEl:e("initialFocusEl"),enabled:e("autoFocus")});o==null||o.focus({preventScroll:!0})})},setFinalFocus({event:e,scope:t}){var o;const r=e.restoreFocus??((o=e.previousEvent)==null?void 0:o.restoreFocus);r!=null&&!r||x(()=>{const n=O(t);n==null||n.focus({preventScroll:!0})})},invokeOnOpen({prop:e,flush:t}){t(()=>{var o;(o=e("onOpenChange"))==null||o({open:!0})})},invokeOnClose({prop:e,flush:t}){t(()=>{var o;(o=e("onOpenChange"))==null||o({open:!1})})},toggleVisibility({event:e,send:t,prop:o}){t({type:o("open")?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:e})}}}});J()(["autoFocus","closeOnEscape","closeOnInteractOutside","dir","getRootNode","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","onRequestDismiss","defaultOpen","open","persistentElements","portalled","positioning"]);const he=e=>{const t=a.useId(),{getRootNode:o}=Q(),{dir:r}=Z(),n={id:t,dir:r,getRootNode:o,...e},s=ee(Ee,n);return Pe(s,ie)},Ce=e=>{const[t,{children:o,...r}]=H(e),n=he(r),s=W(P({present:n.open},t));return l.jsx(ue,{value:n,children:l.jsx(X,{value:s,children:o})})},_=a.forwardRef((e,t)=>{const o=C(),r=T(),n=P({...o.getTriggerProps(),"aria-controls":r.unmounted?void 0:o.getTriggerProps()["aria-controls"]},e);return l.jsx(h.button,{...n,ref:t})});_.displayName="PopoverTrigger";const V=a.createContext(void 0);function xe({children:e,onPositionChange:t}){const[o,r]=a.useState(),[n,s]=a.useState();return l.jsx(V.Provider,{value:{contentId:o,onPositionChange:t,setContentId:r,setTriggerId:s,triggerId:n},children:e})}function b(){const e=a.useContext(V);if(!e)throw new Error("usePopover must be used within a PopoverProvider");return e}const ye=({autoFocus:e=!0,children:t,gutter:o,onOpenChange:r,open:n,position:s=K.top,sameWidth:i,triggerId:d,...c})=>{const{contentId:m,triggerId:u}=b();return l.jsx(Ce,{autoFocus:e,ids:{content:m,trigger:d??u},onOpenChange:r,open:n,positioning:{gutter:o,placement:s,sameWidth:i},...c,children:t})},Ie=({onPositionChange:e,...t})=>l.jsx(xe,{onPositionChange:e,children:l.jsx(ye,{...t})});Ie.displayName="Popover";const we={"popover-content":"_popover-content_6kx3n_2"},Te=a.forwardRef(({children:e,className:t,createPortal:o=!0,id:r,withArrow:n=!1,...s},i)=>{const d=a.useId(),{onPositionChange:c,setContentId:m}=b(),u=a.useRef(null),E=a.useMemo(()=>r??d,[d,r]);return a.useImperativeHandle(i,()=>u.current,[u]),a.useEffect(()=>{m(E)},[E,m]),a.useEffect(()=>{if(u.current){const v=new MutationObserver(p=>{if(p.length){const q=p[0].target.dataset;c==null||c({position:q.placement})}});return v.observe(u.current,{attributeFilter:["data-placement"],attributes:!0}),()=>{v.disconnect()}}},[u,c]),l.jsx(M,{disabled:!o,children:l.jsx($,{children:l.jsxs(S,{className:D(we["popover-content"],t),"data-ods":"popover-content",ref:u,...s,children:[n&&l.jsx(j,{children:l.jsx(L,{})}),e]})})})});Te.displayName="PopoverContent";const be={"popover-trigger":"_popover-trigger_a014q_2"},Fe=a.forwardRef(({asChild:e,children:t,className:o,...r},n)=>{const{setTriggerId:s}=b();return a.useEffect(()=>{var i;if(!e&&r.id){s==null||s(r.id);return}t&&(i=t.props)!=null&&i.id&&(s==null||s(t.props.id))},[e,t,r,s]),l.jsx(_,{asChild:e,className:D(be["popover-trigger"],o),"data-ods":"popover-trigger",ref:n,role:"button",tabIndex:0,...r,children:t})});Fe.displayName="PopoverTrigger";export{Te as A,Fe as B,Ie as L};
