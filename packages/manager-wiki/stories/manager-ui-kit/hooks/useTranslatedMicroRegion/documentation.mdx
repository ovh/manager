import {
  StoryBookBanner,
  StorybookHeading,
  StorybookBestPractices,
  StorybookIdentityCard,
  StorybookTable,
} from '../../../../components/';
import meta from './useTranslatedMicroRegions.stories';
import { Meta, Source } from '@storybook/blocks';

<Meta title="Manager UI Kit/Hooks/useTranslatedMicroRegions/Documentation" />
<StoryBookBanner of={meta} />

# useTranslatedMicroRegions

The `useTranslatedMicroRegions` hook provides utilities for translating OVHcloud region identifiers into human-readable localized strings. It handles micro-regions, macro-regions, and continent names.

## Overview

OVHcloud regions follow specific naming conventions:
- **Micro-region**: Full region identifier (e.g., `GRA-1`, `EU-WEST-LZ-MAD-A`)
- **Macro-region**: Geographic area (e.g., `GRA`, `MAD`)
- **Continent**: Continental location (e.g., `Europe`, `North America`)

This hook automatically extracts the macro-region from a full region string and returns appropriate translations.

<StorybookHeading label="Basic Usage" level={2} />

<Source
  code={`import { useTranslatedMicroRegions } from '@ovh-ux/muk';

function MyComponent() {
  const { 
    translateMicroRegion, 
    translateMacroRegion, 
    translateContinentRegion 
  } = useTranslatedMicroRegions();

  const region = 'GRA-1';
  
  return (
    <div>
      <p>Micro: {translateMicroRegion(region)}</p>
      {/* → "Gravelines 1" */}
      
      <p>Macro: {translateMacroRegion(region)}</p>
      {/* → "Gravelines" */}
      
      <p>Continent: {translateContinentRegion(region)}</p>
      {/* → "Europe" */}
    </div>
  );
}`}
  language="tsx"
/>

<StorybookHeading label="Return Values" level={2} />

The hook returns an object with three translation functions:

<StorybookTable
  items={[
    {
      property: 'translateMicroRegion',
      type: '(region: string) => string',
      description: 'Translates the full region identifier including zone number',
    },
    {
      property: 'translateMacroRegion',
      type: '(region: string) => string',
      description: 'Translates the macro-region (geographic area name)',
    },
    {
      property: 'translateContinentRegion',
      type: '(region: string) => string',
      description: 'Translates the continent where the region is located',
    },
  ]}
/>

<StorybookHeading label="Region Format Examples" level={2} />

<Source
  code={`const { translateMicroRegion, translateMacroRegion } = useTranslatedMicroRegions();

// Standard region format
translateMicroRegion('GRA-1');      // → "Gravelines 1"
translateMacroRegion('GRA-1');      // → "Gravelines"

// Single segment region
translateMicroRegion('WES1');       // → "WES 1"
translateMacroRegion('WES1');       // → "WES"

// Local zone format
translateMicroRegion('EU-WEST-LZ-MAD-A');  // → "Madrid A"
translateMacroRegion('EU-WEST-LZ-MAD-A');  // → "Madrid"

// Multi-segment region
translateMicroRegion('US-EAST-VA-1'); // → "Virginia 1"
translateMacroRegion('US-EAST-VA-1'); // → "Virginia"`}
  language="tsx"
/>

<StorybookHeading label="How It Works" level={2} />

### Macro-Region Extraction

The hook uses `getMacroRegion()` utility to extract the geographic identifier from a full region string:

<Source
  code={`// Region parsing logic
'GRA-1'              → macro: 'GRA'
'WES1'               → macro: 'WES'
'EU-WEST-LZ-MAD-A'   → macro: 'MAD'  (local zone)
'US-EAST-VA-1'       → macro: 'VA'
'Unknown'            → macro: 'Unknown_Macro_Region'`}
  language="text"
/>

### Translation Keys

The hook checks for translation keys in the `region` namespace:

- **Micro-region**: `region_${macro}_micro` (e.g., `region_GRA_micro`)
- **Macro-region**: `region_${macro}` (e.g., `region_GRA`)
- **Continent**: `region_continent_${macro}` (e.g., `region_continent_GRA`)

If a translation key doesn't exist, it returns an empty string.

<StorybookHeading label="Use Cases" level={2} />

### 1. Display Region in Dropdown

<Source
  code={`function RegionSelector({ regions }) {
  const { translateMicroRegion } = useTranslatedMicroRegions();
  
  return (
    <select>
      {regions.map((region) => (
        <option key={region} value={region}>
          {translateMicroRegion(region)}
        </option>
      ))}
    </select>
  );
}`}
  language="tsx"
/>

### 2. Show Region Hierarchy

<Source
  code={`function RegionDetails({ regionCode }) {
  const { 
    translateMicroRegion, 
    translateMacroRegion, 
    translateContinentRegion 
  } = useTranslatedMicroRegions();
  
  return (
    <div>
      <p>Continent: {translateContinentRegion(regionCode)}</p>
      <p>Region: {translateMacroRegion(regionCode)}</p>
      <p>Zone: {translateMicroRegion(regionCode)}</p>
    </div>
  );
}`}
  language="tsx"
/>

### 3. Filter by Continent

<Source
  code={`function RegionFilter({ regions }) {
  const { translateContinentRegion } = useTranslatedMicroRegions();
  
  const continents = [...new Set(
    regions.map(r => translateContinentRegion(r))
  )].filter(Boolean);
  
  return (
    <select>
      {continents.map(continent => (
        <option key={continent}>{continent}</option>
      ))}
    </select>
  );
}`}
  language="tsx"
/>

<StorybookHeading label="Local Zone Detection" level={2} />

The hook includes utilities for detecting local zones:

<Source
  code={`import { isLocalZone } from '@ovh-ux/muk';

isLocalZone('EU-WEST-LZ-MAD-A'); // → true
isLocalZone('GRA-1');            // → false

// Use in conditional rendering
const isLZ = isLocalZone(region);
return (
  <Badge color={isLZ ? 'info' : 'default'}>
    {isLZ ? 'Local Zone' : 'Region'}
  </Badge>
);`}
  language="tsx"
/>

<StorybookHeading label="Best Practices" level={2} />

<StorybookBestPractices
  items={[
    {
      do: 'Use translateMicroRegion for displaying full region details',
      dont: 'Display raw region codes to end users',
    },
    {
      do: 'Check if translation exists before displaying (returns empty string if not found)',
      dont: 'Assume all region codes have translations',
    },
    {
      do: 'Use translateMacroRegion for grouping regions',
      dont: 'Parse region strings manually',
    },
    {
      do: 'Cache the hook result if using multiple times in the same component',
      dont: 'Call the hook repeatedly in loops',
    },
  ]}
/>

<StorybookHeading label="API Reference" level={2} />

### Hook Signature

```typescript
const {
  translateMicroRegion,
  translateMacroRegion,
  translateContinentRegion,
} = useTranslatedMicroRegions();
```

### Parameters

This hook takes no parameters.

### Return Value

| Method | Type | Description |
|--------|------|-------------|
| `translateMicroRegion` | `(region: string) => string` | Returns localized micro-region name with zone identifier |
| `translateMacroRegion` | `(region: string) => string` | Returns localized macro-region name (geographic area) |
| `translateContinentRegion` | `(region: string) => string` | Returns localized continent name |

### Utility Functions

| Function | Type | Description |
|----------|------|-------------|
| `getMacroRegion` | `(region: string) => string` | Extracts macro-region identifier from full region string |
| `isLocalZone` | `(region: string) => boolean` | Checks if region is a local zone (contains 'LZ' pattern) |

<StorybookHeading label="Notes" level={2} />

- Translations are loaded from the `region` i18n namespace
- Returns empty string if translation key doesn't exist
- Automatically adapts to current application language
- Supports all OVHcloud region naming conventions
- Safe to use with invalid or malformed region strings

