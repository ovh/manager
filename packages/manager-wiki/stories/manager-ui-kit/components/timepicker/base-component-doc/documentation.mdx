import { ICON_NAME, Icon } from '@ovhcloud/ods-react';
import { Canvas, Meta } from '@storybook/blocks';
import * as TimepickerStories from './timepicker.stories';
import { Banner } from '../../../base-documents/components/banner/Banner';
import { BestPractices } from '../../../base-documents/components/bestPractices/BestPractices';
import { Canvas as OdsCanvas } from '../../../base-documents/components/canvas/Canvas';
import { Heading } from '../../../base-documents/components/heading/Heading';
import { IdentityCard } from '../../../base-documents/components/identityCard/IdentityCard';
import { StorybookLink } from '../../../base-documents/components/storybookLink/StorybookLink';
import { REACT_COMPONENTS_TITLE, STORY } from '../../../base-documents/constants/meta';

<Meta of={ TimepickerStories } name="Documentation" />

<Banner of={ TimepickerStories } />

_A **Timepicker** is a component that allows users to select a time from a list or set a specific time._

<Canvas of={ TimepickerStories.Overview } sourceState="none" />

<Heading label="Overview" level={ 2 } />

<IdentityCard aliases={ ['Time'] }
              figmaLink="https://www.figma.com/design/9jDDTcR4a9jPRFcdjawAlf/ODS---UI-Kit?node-id=53-11662"
              githubUrl="@ovhcloud/ods-react"
              name="Timepicker">
  The **Timepicker** component is used for selecting times in forms and applications. It provides an interface for users to choose a time, ensuring the format is consistent and valid. The component can include features like 12-hour or 24-hour formats, increments, and disabled times.
</IdentityCard>

<Heading label="Usage" level={ 2 } />

**Timepicker** is used to allow a selection of a specific time.

It is useful for scheduling such as planning a meeting.

A **Timepicker** field includes the hour, minutes and optionally seconds. It can be followed by an AM/PM indicator.

For some use case, an optional timezone Select can be added to allow users to select their desired timezone from a list of options.

<Heading label="Dos & Don'ts" level={ 3 } />

<BestPractices
  donts={[
    '- Don\'t use a placeholder as a label since it disappears on input and fails accessibility standards',
    '- Don\'t rely on a placeholder to convey critical information like format or timezone. This should be communicated through helper text or labels',
    '- Don\'t use a Timepicker for ambiguous or unclear time selection use cases. Ensure it is the right fit for your form flow and user intent',
    '- Don\'t expose all global timezones unless necessary',
  ]}
  dos={[
    '- Use a Timepicker when users need to select a specific time, especially for scheduling or planning scenarios',
    '- Always pair the Timepicker with a clear label and/or helper text',
    '- Combine the Timepicker with a datepicker when both date and time selection are needed in the same context',
    '- When offering timezone selection, provide a restricted and relevant list to avoid overwhelming users. Limit options based on business relevance or geography',
  ]}
/>

<Heading label="Best Practices in Context" level={ 3 } />

![Component anatomy](./base-assets/components/timepicker/anatomy.png "Component anatomy")

1. **Timepicker**
2. **Input field**
3. **Timezones select** - optional

<Heading label="Placement" level={ 2 } />

A **Timepicker** can be used in a page as long as there is a need to allow users to pick a time.

The time field has a fixed width by default but, when used in a form, its width should match the other inputs.

**Timepicker** should be vertically aligned with other form components on a same page.

<Heading label="Behavior" level={ 2 } />

A **Timepicker** can widen to match its container (width of the elements is 50% each).

It has the same states and behaviors for each inner component (i.e. <StorybookLink kind={ REACT_COMPONENTS_TITLE.input } story={ STORY.documentation }>Input</StorybookLink> and <StorybookLink kind={ REACT_COMPONENTS_TITLE.select } story={ STORY.documentation }>Select</StorybookLink>).

<Heading label="Navigation" level={ 2 } />

<Heading label="Focus Management" level={ 3 } />

When the **Timepicker** is focused, the first focusable segment (typically the hour Input) receives focus automatically.

Focus then moves sequentially through the minute and second inputs (if present), followed by the AM/PM toggle (depending on the browser) and the optional timezone select.

Each individual segment can receive focus and be navigated independently using the keyboard. If a segment (e.g., seconds or timezone) is not visible or disabled, it is skipped in the tab order.

<Heading label="General Keyboard Shortcuts" level={ 3 } />

Pressing `Tab` moves focus forward through all focusable segments of the Timepicker:
* Hour field
* Minute field
* Second field (if enabled)
* AM/PM toggle (if 12-hour format)
* Time zone Select (if present)

Pressing `Shift` + `Tab` moves focus backward through the segments.

When focused on an input segment (hour, minute, second):
* Typing numeric values replaces the current value
* Pressing `Arrow Up` increments the value
* Pressing `Arrow Down` decrements the value
* Pressing `Backspace` clears the content
* Pressing `Home` or `fn` + `Arrow Up` increases the value by:
  * 3 units for the hour segment
  * 10 units for minutes and seconds
* Pressing `End` or `fn` + `Arrow Down` decreases the value by:
  * 3 units for the hour segment
  * 10 units for minutes and seconds

When focused on the AM/PM toggle:
* Pressing `Arrow Up` or `Arrow Down` switches between AM and PM

When focused on the timezone Select, keyboard shortcuts are similar to the Select component:
* Pressing `Space` or `Arrow Down` opens the dropdown
* `Arrow` keys navigate options
* `Enter` or `Tab` selects the option and closes the dropdown
* Pressing `Escape`closes the dropdown

<Heading label="Accessibility" level={ 2 } />

To ensure proper accessibility, the **Timepicker** component must be correctly labeled.

<Heading label="Always provide an explicit label" level={ 3 } />

Every **Timepicker** must have a clear and explicit label to ensure that users (especially screen reader users) understand its purpose,
using either **FormField** or a native label tag.

<OdsCanvas of={ TimepickerStories.AccessibilityLabel } sourceState="shown" />

<Icon name={ ICON_NAME.circleCheck }
      style={{ color: 'var(--ods-color-success-500)' }} /> Screen readers will announce the label, the input time and the select field.
