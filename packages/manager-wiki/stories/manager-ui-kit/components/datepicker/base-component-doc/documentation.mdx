import { Icon, ICON_NAME } from '@ovhcloud/ods-react';
import { Canvas, Meta } from '@storybook/blocks';
import * as DatepickerStories from './datepicker.stories';
import { Banner } from '../../../base-documents/components/banner/Banner';
import { BestPractices } from '../../../base-documents/components/bestPractices/BestPractices';
import { Canvas as OdsCanvas } from '../../../base-documents/components/canvas/Canvas';
import { Heading } from '../../../base-documents/components/heading/Heading';
import { IdentityCard } from '../../../base-documents/components/identityCard/IdentityCard';
import { StorybookLink } from '../../../base-documents/components/storybookLink/StorybookLink';
import { REACT_COMPONENTS_TITLE, STORY } from '../../../base-documents/constants/meta';

<Meta of={ DatepickerStories } name="Documentation" />

<Banner of={ DatepickerStories } />

_A **Datepicker** component is used to allow users to select a date. They can navigate through days, months and years._

<Canvas of={ DatepickerStories.Overview } sourceState="none" />

<Heading label="Overview" level={ 2 } />

<IdentityCard aliases={ ['Calendar'] }
              figmaLink="https://www.figma.com/design/9jDDTcR4a9jPRFcdjawAlf/ODS---UI-Kit?node-id=26-7958"
              githubUrl="@ovhcloud/ods-react"
              name="Datepicker">
  The Datepicker component is used for selecting dates in forms and applications. It provides a user-friendly
  interface for choosing dates, ensuring that the date format is consistent and valid. This component can include
  features such as disabled dates and custom formats.
</IdentityCard>

<Heading label="Usage" level={ 2 } />

**Datepicker** is used to **allow a selection of a specific date** in the near future or even past. It is **useful for scheduling, or defining user dates**.

<Heading label="Dos & Don'ts" level={ 3 } />

<BestPractices
  donts={[
    '- Don\'t rely only on placeholders to communicate the date format. Users need persistent guidance (via a label or hint)',
    '- Don\'t use a Datepicker when the user must select a date very far in the past or future (e.g., birthdate). Use a more accessible method like dropdowns or manual input',
    '- Don\'t overload the interface with too many calendar options at once',
    '- Don\'t default the calendar to an irrelevant month/year',
  ]}
  dos={[
    '- Use a Datepicker when users need to select a specific date',
    '- Choose a relevant default date when opening the calendar (e.g., default to the current year/month when not contextually set)',
    '- Add a label alongside the input to clearly indicate the expected format, especially when the placeholder disappears on input',
    '- Use a Datepicker when users need to select a single date or range of dates',
    '- Use a Datepicker for recent or near future dates',
    '- When the user has to pick dates in the distant past or future, do choose a more suitable day as Datepicker default date when it will open',
  ]}
/>

<Heading label="Best Practices in Context" level={ 3 } />

![Component anatomy](/assets/base-assets/components/datepicker/anatomy.png "Component anatomy")

1. **Datepicker**
2. **Date field**
3. **Icon button**
4. **Dropdown calendar**
5. **Month/Year button**
6. **Previous/Next month buttons**
7. **Week days**
8. **Day**
9. **Selected day**

<Heading label="Placement" level={ 2 } />

A **Datepicker** can be used in a page as long as there is a need to allow users to pick a date.

The date field has a fixed width by default but when used in a form its width should match the other inputs.

The **Datepicker** dropdown has a fixed width and is not adjustable.

<Heading label="Behavior" level={ 2 } />

**Opening the Datepicker**

By clicking on the **Datepicker** icon button.

**Closing the Datepicker**

- By clicking outside the **Datepicker** dropdown
- By selecting a date

**Date picking mode**

Navigating to previous/next month : By clicking on arrow icon <StorybookLink kind={ REACT_COMPONENTS_TITLE.button } story={ STORY.documentation }>Buttons</StorybookLink> to navigate through months

Selecting a month : By clicking on the month selection <StorybookLink kind={ REACT_COMPONENTS_TITLE.button } story={ STORY.documentation }>Button</StorybookLink> to switch to month picking mode

Picking a date : By clicking on a date

**Month picking mode**

Navigating to previous/next year : By clicking on arrow icon <StorybookLink kind={ REACT_COMPONENTS_TITLE.button } story={ STORY.documentation }>Buttons</StorybookLink> to navigate through years

Selecting a year : By clicking on the month selection <StorybookLink kind={ REACT_COMPONENTS_TITLE.button } story={ STORY.documentation }>Button</StorybookLink> to switch to year picking mode

Picking a month: By clicking on a month, the dropdown goes back to date picking mode

**Year picking mode**

Navigating to previous/next range of years : By clicking on arrow icon <StorybookLink kind={ REACT_COMPONENTS_TITLE.button } story={ STORY.documentation }>Buttons</StorybookLink> to navigate through years

Selecting a decade : By clicking on the month selection <StorybookLink kind={ REACT_COMPONENTS_TITLE.button } story={ STORY.documentation }>Button</StorybookLink> to switch to year picking mode

Picking a month: By clicking on a month, the dropdown goes back to date picking mode

**Locale**

Locale determines how the week days will be displayed according to the localization. The **Datepicker** supports the following locales: English (default), German, Spanish, French, Italian, Dutch, Polish and Portuguese.

<Heading label="Navigation" level={ 2 } />

<Heading label="Focus Management" level={ 3 } />

The **Datepicker** icon button can receive the focus.

When the dropdown calendar opens, the focus is moved to the currently selected date, or to today's date if none is selected.

When the dropdown is closed (via Escape or blur), focus returns to the Datepicker trigger (the input field).

<Heading label="General Keyboard Shortcuts" level={ 3 } />

Pressing `Escape` closes the Datepicker dropdown without selecting a date.

Pressing `Tab` or `Shift` + `Tab` moves focus through dropdown controls when open.

<Heading label="Navigating days" level={ 3 } />

- `Arrow Left`: Move to the previous day
- `Arrow Right`: Move to the next day
- `Arrow Up`: Move to the same weekday of the previous week
- `Arrow Down`: Move to the same weekday of the next week

<Heading label="Jumping within the calendar" level={ 3 } />

- `Home`: Move to the first day of the current month
- `End`: Move to the last day of the current month
- `Page Up`: Move to the same date of the previous month
- `Page Down`: Move to the same date of the next month

<Heading label="Selecting a date or changing view" level={ 3 } />

- `Enter`: Select the currently focused date and close the dropdown
- Typing a valid date format (e.g., yyyy-mm-dd) in the input and pressing Enter will also select the date

<Heading label="Navigating to month/year view" level={ 3 } />

- `Ctrl` / `Cmd` + `Arrow Up` (first press): Switches to month selection view
- `Ctrl` / `Cmd` + `Arrow U`p (second press): Switches to year selection view
- Use `Arrow` keys to move within month/year grids
- Press `Enter` to confirm selection and return to the previous view
- `Ctrl` / `Cmd` + `Arrow Left` / `Arrow Right`: Quickly navigate to the previous or next month from date view

<Heading label="Accessibility" level={ 2 } />

To ensure proper accessibility, the **Datepicker** must be correctly labeled, provide clear guidance on date format and meaningful context when a clearable button is used.

<Heading label="Always provide an explicit label" level={ 3 } />

Every **Datepicker** must have a clear and explicit label to ensure that users (especially screen reader users) understand its purpose
using either **FormField** or a native label tag.

<OdsCanvas of={ DatepickerStories.AccessibilityFormField } sourceState="shown" />

<Icon name={ ICON_NAME.circleCheck }
      style={{ color: 'var(--ods-color-success-500)' }} />  Screen readers will announce the label, the field and its content.

<Heading label="Provide guidance on date format" level={ 3 } />

Since screen readers can only interact with the **Datepicker** input field, itâ€™s important to provide guidance on the expected date format to ensure correct input.

<OdsCanvas of={ DatepickerStories.AccessibilityDateFormat } sourceState="shown" />

<Icon name={ ICON_NAME.circleCheck }
       style={{ color: 'var(--ods-color-success-500)' }} /> Screen readers will announce the label, the field, its content and the helper.

<OdsCanvas of={ DatepickerStories.AccessibilityI18n } sourceState="shown" />

<Icon name={ ICON_NAME.circleCheck }
      style={{ color: 'var(--ods-color-success-500)' }} /> Screen readers will announce the label, the field, its content and custom label of focused action.

