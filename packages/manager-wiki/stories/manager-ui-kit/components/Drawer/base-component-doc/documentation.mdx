import { Icon, ICON_NAME } from '@ovhcloud/ods-react';
import { Canvas, Meta } from '@storybook/blocks';
import * as DrawerStories from './drawer.stories';
import { Banner } from '../../../base-documents/components/banner/Banner';
import { BestPractices } from '../../../base-documents/components/bestPractices/BestPractices';
import { Canvas as OdsCanvas } from '../../../base-documents/components/canvas/Canvas';
import { Heading } from '../../../base-documents/components/heading/Heading';
import { IdentityCard } from '../../../base-documents/components/identityCard/IdentityCard';
import { ExternalLink } from '../../../base-documents/components/externalLink/ExternalLink';

<Meta of={ DrawerStories } name='Documentation' />

<Banner of={ DrawerStories } />

The Drawer component provides a sliding panel that reveals additional content without navigating away from the current page.

<Canvas of={ DrawerStories.Overview } sourceState='none' />

<Heading label="Overview" level={ 2 } />

<IdentityCard aliases={ ['Sidenav', 'Panel'] }
              figmaLink="https://www.figma.com/design/9jDDTcR4a9jPRFcdjawAlf/branch/5BA2ZwZaX2bzfiWwTyMpQH/ODS---UI-Kit?node-id=5488-15121&p=f&t=gPfKLQM0iEuF2FXm-0"
              githubUrl="@ovhcloud/ods-react"
              name="Drawer">
</IdentityCard>

<Heading label="Usage" level={ 2 } />

The **Drawer** component is ideal for use cases where content should be revealed in context without navigating to a new page. Common examples include:

- Side navigation menus
- Filters and settings panels
- Detail views or contextual information

<BestPractices
  donts={[
    '- Don\'t add more than one open Drawer at a time',
    '- Don\'t use excessively large Drawers that cover most or all of the page',
    '- Don\'t rely on Drawers for critical actions that require user confirmation, Modals are better suited for that',
    '- Don\'t leave Drawers open without a visible way to close them, always provide a clear exit path',
  ]}
  dos={[
    '- Use a Drawer to display contextual content or actions that stay relevant to the current page (e.g., filters, side forms, settings)',
    '- Allow the Drawer to be dismissed via clear and accessible interactions (e.g., close button, escape key, clicking outside)',
    '- Customize the Drawer\'s width, height, and placement to match your layout and content needs',
    '- Keep transitions smooth and responsive, respecting the expected animation duration (e.g., 300ms) in the OVHcloud Design System',
    '- Maintain proper layering and z-index behavior',
    '- Use Drawers to maintain continuity of the user\'s workflow without breaking the page context',
  ]}
/>

<Heading label="Best Practices in Context" level={ 3 } />

![Component anatomy](/assets/base-assets/components/drawer/anatomy.png "Component anatomy")

1. **Drawer**

<Heading label="Placement" level={ 2 } />

The **Drawer** can be positioned on any edge of the screen:

- **Left/Right**: Covers 100% of the page height, with a default width of 320px and a maximum width of 100% - 3rem (48px)
- **Top/Bottom**: Covers 100% of the page width, with a default height of 320px and a maximum height of 100vh - 3rem (48px)

The **Drawer** is displayed above all page content but is positioned below the Modal in terms of layering, following the z-index hierarchy defined by OVHcloud Design System. This ensures consistent stacking behavior across components.

By default, the OVHcloud Design System does not enforce whether the **Drawer** is fixed or scrollable. Integrators can configure this behavior based on their specific use case and requirements.

Be careful the placement of the drawer can be broken if you create a new <ExternalLink href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_positioned_layout/Understanding_z-index/Stacking_context" target="_blank">stacking context</ExternalLink>.
For example with a transform style or scale.

<Heading label="Behavior" level={ 2 } />

The **Drawer** supports the following interactions:

- Expansion: Triggered by interacting with a designated element, such as a button.
- Collapsing:
- By interacting with the same trigger used for expansion
- By pressing the escape key

Animation: The **Drawer** slides into view with a smooth animation (default duration: 300ms).

<Heading label="Variation" level={ 2 } />

The **Drawer** can slide in from the left, right, top, or bottom, depending on its configuration and the layout of the page.

<Heading label="Navigation" level={ 2 } />

<Heading label="Focus Management" level={ 3 } />

When the **Drawer** is opened, focus automatically moves to the first focusable element inside.

When the **Drawer** is closed, focus returns to the trigger element unless overridden by the integrator.

<Heading label="General Keyboard Shortcuts" level={ 3 } />

Pressing `Escape` closes the **Drawer**.

Pressing `Tab` moves focus forward through the focusable elements inside the **Drawer**.

Pressing `Shift` + `Tab` moves focus backward within the **Drawer**.

Once the last focusable element is reached, focus does not leave the **Drawer** unless it is closed.

<Heading label="Accessibility" level={ 2 } />

To ensure the **Drawer** is fully accessible, correct ARIA attributes must be implemented. This ensures screen readers announce the **Drawer** properly and that keyboard users can interact with it effectively.

<Heading label="Linking the Drawer title and content" level={ 3 } />

Ensure that assistive technologies announce the **Drawer** correctly using <ExternalLink href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Reference/Attributes/aria-labelledby">aria-labelledby</ExternalLink> or <ExternalLink href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Reference/Attributes/aria-label">aria-label</ExternalLink>, and <ExternalLink href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Reference/Attributes/aria-describedby">aria-describedby</ExternalLink>.

<OdsCanvas of={ DrawerStories.AccessibilityAriaLabel } sourceState="shown" />

<OdsCanvas of={ DrawerStories.AccessibilityAriaLabelledBy } sourceState="shown" />

<Icon name={ ICON_NAME.circleCheck }
      style={{ color: 'var(--ods-color-success-500)' }} /> Screen readers will announce the sections referenced by the aria attributes.
