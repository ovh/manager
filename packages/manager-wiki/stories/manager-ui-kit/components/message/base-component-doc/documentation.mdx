import { ICON_NAME, Icon } from '@ovhcloud/ods-react';
import { Canvas, Meta } from '@storybook/blocks';
import * as MessageStories from './message.stories';
import { Banner } from '../../../base-documents/components/banner/Banner';
import { BestPractices } from '../../../base-documents/components/bestPractices/BestPractices';
import { Canvas as OdsCanvas } from '../../../base-documents/components/canvas/Canvas';
import { ExternalLink } from '../../../base-documents/components/externalLink/ExternalLink';
import { Heading } from '../../../base-documents/components/heading/Heading';
import { IdentityCard } from '../../../base-documents/components/identityCard/IdentityCard';

<Meta of={ MessageStories } name="Documentation" />

<Banner of={ MessageStories } />

_**Message** component helps to communicate with users providing feedback or information._

<Canvas of={ MessageStories.Overview } sourceState="none" />

<Heading label="Overview" level={ 2 } />

<IdentityCard aliases={ ['Notifier', 'Notification', 'Banner', 'Alert', 'Feedback'] }
              figmaLink="https://www.figma.com/design/9jDDTcR4a9jPRFcdjawAlf/ODS---UI-Kit?node-id=44-8300"
              githubUrl="@ovhcloud/ods-react"
              name="Message">
  **Message** component communicates information to the user.

  It grabs the user's attention in a prominent way.
</IdentityCard>

<Heading label="Usage" level={ 2 } />

**Messages** are used as notification status.

There are four different subtypes of standard **Messages**, in order of priority:

- **Information**: Provides info to users in context. Shouldn't be overused to replace regular content.
- **Success**: Reserved to provide to a success message. They are displayed as a snackbar.
- **Warning**: Reserved for **Messages** that need the user attention and acknowledgment but might not cause errors.
- **Critical**: Reserved for errors, malfunctions, as well as critical issues. Inform the user that a problem requires immediate intervention or correction before the process continues.
- **Danger**: Reserved for alerts to an urgent and potentially hazardous situation that necessitates immediate action to prevent harm or serious consequences.

<Heading label="Dos & Don'ts" level={ 3 } />

<BestPractices
  donts={[
    '- Don\'t use Message to highlight static or decorative content, prefer components like Card for that',
    '- Don\'t write overly long or complex Message that could overwhelm or confuse users',
    '- Don\'t rely solely on color to convey meaning, always keep the Icon for clarity',
    '- Don\'t use vague or generic text, always provide helpful context or guidance',
    '- Don\'t overload the interface with multiple simultaneous Messages unless absolutely necessary',
  ]}
  dos={[
    '- Write Message in a clear, concise, and affirmative tone that aligns with the user\'s task',
    '- Place Message in a visible and relevant area of the page, ideally close to the triggering element if any or top of the section',
    '- Use the correct variant (e.g., information, success, warning, error) to match the context and urgency',
    '- Use non-dismissible Message for critical warnings or errors that require immediate resolution',
    '- Allow content selection (e.g., to copy error messages)',
  ]}
/>

<Heading label="Best Practices in Context" level={ 3 } />

![Component anatomy](./base-assets/components/message/anatomy.png "Component anatomy")

1. **Message**
2. **Icon**
3. **Close button** - optional
4. **Content**

<Heading label="Placement" level={ 2 } />

**Messages** show up during a task to notify users of the status of an action. In every page, it is possible to display one or more **Messages** to inform the user.

They are positioned near their related items or right after the header and before the page title and page content.

<Heading label="Behavior" level={ 2 } />

Based on its informational manner, the component default behavior is being read-only. You can only select its content if needed.

When a **Message** is dismissible, a click on the `xmark` icon button will dismiss the **Message**.

<Heading label="Variation" level={ 2 } />

<Heading label="Color" level={ 3 } />

- **Information** _(default)_: informing users of specific content, providing global feedback to the user.
- **Success**: confirming that an action has been completed successfully, providing positive feedback to the user.
- **Warning**: alerting users to potential issues or cautionary information, prompting them to take preventive actions.
- **Danger**: indicating serious issues or errors that require immediate attention, signaling a high level of urgency.
- **Critical**: highlighting severe and potentially catastrophic issues that demand urgent and decisive action to prevent significant negative consequences.

<Heading label="Variant" level={ 3 } />

- **Default**: conveying mild to important information, ensuring the message is seen by the user.
- **Light**: conveying non-urgent, informational content in a subtle and less prominent manner, ensuring the message is seen without drawing too much attention.

<Heading label="Navigation" level={ 2 } />

<Heading label="Focus Management" level={ 3 } />

The **Message** component itself is non-interactive and does not receive keyboard focus.

If the **Message** is dismissible, the close icon button is focusable.

<Heading label="General Keyboard Shortcuts" level={ 3 } />

Pressing `Tab` moves focus to the close icon button (if available).

Pressing `Enter`or `Space` while the close icon button is focused should trigger the action to dismiss the **Message**.

Pressing `Shift` + `Tab` moves focus to the previous interactive element.

<Heading label="Accessibility" level={ 2 } />

<Heading label="Structuring multiple Messages" level={ 3 } />

When displaying multiple **Messages** together, they should be wrapped within an unordered list of items (`<ul>` and `<li>`) to ensure a proper announcement by screen readers.

<OdsCanvas of={ MessageStories.AccessibilityGrouping } sourceState="shown" />

<Icon name={ ICON_NAME.circleCheck }
      style={{ color: 'var(--ods-color-success-500)' }} /> This structure ensures that assistive technologies announce **Messages** as a list, rather than reading them as separate, unrelated announcements.

Screen readers will announce the list, the number of items and the **Messages** content.

<Heading label="Alternative approach with ARIA roles" level={ 3 } />

When modifying the HTML structure is not possible, use <ExternalLink href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Reference/Roles/list_role">role="list"</ExternalLink> and <ExternalLink href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Reference/Roles/listitem_role">role="listitem"</ExternalLink> to mimic list semantics.

<OdsCanvas of={ MessageStories.AccessibilityAlternativeGrouping } sourceState="shown" />

<Heading label="Setting the container ARIA role" level={ 3 } />

When adding a new **Message** element, its container should have a `role` attribute set, so that assistive
technologies can announce the content correctly.

If you're adding a critical **Message**, use `role="alert"`.
For non-critical **Messages** (e.g., info, success, warning), use `role="status"`.

<OdsCanvas of={ MessageStories.AccessibilityRoles } sourceState="shown" />

<Icon name={ ICON_NAME.circleCheck }
      style={{ color: 'var(--ods-color-success-500)' }} /> This ensures that screen readers announce the **Message** at the appropriate time without interrupting.
