<div class="nasha-dashboard-partitions">
    <div class="d-flex flex-column">
        <h4 data-translate="nasha_dashboard_partitions_metrics"></h4>
        <nasha-components-metrics
            class="mb-5"
            data-nasha="$ctrl.nasha"
            data-service-info="$ctrl.serviceInfo"
            data-url-renew="{{ $ctrl.urlRenew }}"
            data-monitored-disabled="$ctrl.isMonitoredUpdating"
            data-on-monitored-changed="$ctrl.updateMonitored()"
        ></nasha-components-metrics>
        <h4 data-translate="nasha_dashboard_partitions_title"></h4>
        <p class="d-flex flex-column">
            <strong
                data-translate="nasha_dashboard_partitions_count_title"
            ></strong>
            <span
                data-translate="nasha_dashboard_partitions_count"
                data-translate-values="{
                    count: $ctrl.partitionsCount === null ? '-' : $ctrl.partitionsCount,
                    max: $ctrl.maxPartitions,
                }"
            ></span>
        </p>
        <oui-datagrid
            data-rows-loader="$ctrl.loadPartitions()"
            data-page-size="{{ $ctrl.maxPartitions }}"
        >
            <oui-datagrid-topbar>
                <oui-button
                    data-icon-left="oui-icon-plus"
                    data-disabled="!$ctrl.canCreatePartition"
                    data-on-click="$ctrl.goToTabPartitionsCreate()"
                >
                    <span
                        data-translate="nasha_dashboard_partitions_create"
                    ></span>
                </oui-button>
            </oui-datagrid-topbar>
            <oui-datagrid-column
                data-property="partitionName"
                data-title=":: ('nasha_dashboard_partitions_list_partition_name' | translate)"
            >
                <button
                    data-ng-click="$ctrl.goToPagePartitionDashboard($row.partitionName)"
                    data-ng-bind="$row.partitionName"
                    data-ng-disabled="$row.inCreation"
                    class="oui-button oui-button_m oui-button_link"
                ></button>
            </oui-datagrid-column>
            <oui-datagrid-column
                data-property="protocol"
                data-title=":: ('nasha_dashboard_partitions_list_protocol' | translate)"
            ></oui-datagrid-column>
            <oui-datagrid-column
                data-property="use"
                data-title=":: ('nasha_dashboard_partitions_list_use' | translate)"
            >
                <nasha-components-space-meter
                    data-ng-if="$row.use"
                    data-usage="$row.use"
                    data-help="false"
                ></nasha-components-space-meter>
            </oui-datagrid-column>
            <oui-datagrid-column
                data-property="description"
                data-title=":: ('nasha_dashboard_partitions_list_description' | translate)"
            ></oui-datagrid-column>
            <oui-datagrid-column
                data-title=":: ('nasha_dashboard_partitions_list_tasks' | translate)"
            >
                <div
                    data-ng-repeat="task in $row.tasks"
                    class="d-flex align-items-center"
                >
                    <oui-spinner data-size="s"></oui-spinner>
                    <span
                        class="pl-2"
                        data-ng-bind="$ctrl.localizeOperation(task.operation)"
                    ></span>
                </div>
            </oui-datagrid-column>
            <oui-action-menu
                data-ng-if="!$row.tasks.length"
                data-compact
                data-placement="end"
            >
                <oui-action-menu-item
                    data-on-click="$ctrl.goToPagePartitionDashboard($row.partitionName)"
                >
                    <span
                        data-translate="nasha_dashboard_partitions_action_show"
                    ></span>
                </oui-action-menu-item>
                <oui-action-menu-item
                    data-on-click="$ctrl.goToPagePartitionAccess($row.partitionName)"
                >
                    <span
                        data-translate="nasha_dashboard_partitions_action_access"
                    ></span>
                </oui-action-menu-item>
                <oui-action-menu-item
                    data-on-click="$ctrl.goToPagePartitionSnapshots($row.partitionName)"
                >
                    <span
                        data-translate="nasha_dashboard_partitions_action_snapshots"
                    ></span>
                </oui-action-menu-item>
                <oui-action-menu-item
                    data-on-click="$ctrl.goToTabPartitionsEditSize($row)"
                >
                    <span
                        data-translate="nasha_dashboard_partitions_action_edit_size"
                    ></span>
                </oui-action-menu-item>
                <oui-action-menu-item
                    data-on-click="$ctrl.goToTabPartitionsZfsOptions($row)"
                >
                    <span
                        data-translate="nasha_dashboard_partitions_action_zfs_options"
                    ></span>
                </oui-action-menu-item>
                <oui-action-menu-item
                    data-on-click="$ctrl.goToTabPartitionsDelete($row)"
                >
                    <span
                        class="text-danger"
                        data-translate="nasha_dashboard_partitions_action_delete"
                    ></span>
                </oui-action-menu-item>
            </oui-action-menu>
        </oui-datagrid>
    </div>
    <div data-ui-view></div>
</div>
