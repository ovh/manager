<div>
    <div class="text-center" data-ng-if="informationsCtrl.loaders.init">
        <oui-spinner data-size="l"></oui-spinner>
    </div>

    <div class="row" data-ng-show="!informationsCtrl.loaders.init">
        <div class="col-md-9">
            <div data-ovh-alert="{{alerts.main}}"></div>
            <div class="row d-md-flex">
                <div class="col-sm-6">
                    <oui-tile
                        class="h-100"
                        data-heading="{{:: 'sharepoint_dashboard_access' | translate}}"
                    >
                        <oui-tile-definition
                            data-term="{{:: 'sharepoint_dashboard_url_label' | translate}}"
                        >
                            <oui-tile-description>
                                <a
                                    data-ng-href="https://{{informationsCtrl.sharepoint.url}}"
                                    target="_blank"
                                    rel="noopener"
                                    data-ng-if="informationsCtrl.sharepoint.state !== 'creating'"
                                >
                                    <span
                                        data-translate="sharepoint_common_open_new_tab"
                                        class="sr-only"
                                    ></span>
                                    <span
                                        data-ng-bind="'https://' + informationsCtrl.sharepoint.url"
                                    ></span>
                                    <span
                                        class="fa fa-external-link"
                                        aria-hidden="true"
                                    ></span>
                                </a>
                                <span
                                    data-translate="sharepoint_dashboard_creating_url_label"
                                    data-ng-if="informationsCtrl.sharepoint.state === 'creating'"
                                ></span>
                            </oui-tile-description>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{:: 'sharepoint_dashboard_linked_exchange_label' | translate}}"
                            data-ng-if="informationsCtrl.associatedExchange"
                        >
                            <oui-tile-description>
                                <span
                                    data-ng-bind="SharepointCtrl.exchangeId"
                                    data-ng-if="!informationsCtrl.associatedExchangeLink"
                                ></span>
                                <a
                                    data-ng-href="{{informationsCtrl.associatedExchangeLink}}"
                                    data-ng-bind="SharepointCtrl.exchangeId"
                                    data-ng-if="informationsCtrl.associatedExchangeLink"
                                    target="_top"
                                >
                                </a>
                            </oui-tile-description>
                        </oui-tile-definition>
                    </oui-tile>
                </div>
                <div class="col-sm-6">
                    <oui-tile
                        class="h-100"
                        data-heading="{{:: 'sharepoint_dashboard_quota' | translate}}"
                    >
                        <oui-tile-definition>
                            <oui-tile-description>
                                <oui-progress
                                    data-min-value="0"
                                    data-max-value="1024"
                                >
                                    <oui-progress-bar
                                        data-ng-if="informationsCtrl.currentusageInGb() <= 70"
                                        data-type="success"
                                        data-value="informationsCtrl.currentusageInGb()"
                                    >
                                        <span
                                            data-ng-bind="(informationsCtrl.sharepoint.currentUsage | humanReadableSize) + ' / ' + (informationsCtrl.sharepoint.quota | humanReadableSize)"
                                        ></span>
                                    </oui-progress-bar>
                                    <oui-progress-bar
                                        data-ng-if="informationsCtrl.currentusageInGb() > 70 && informationsCtrl.currentusageInGb() <= 85"
                                        data-type="warning"
                                        data-value="informationsCtrl.currentusageInGb()"
                                    >
                                        <span
                                            data-ng-bind="(informationsCtrl.sharepoint.currentUsage | humanReadableSize) + ' / ' + (informationsCtrl.sharepoint.quota | humanReadableSize)"
                                        ></span>
                                    </oui-progress-bar>
                                    <oui-progress-bar
                                        data-ng-if="informationsCtrl.currentusageInGb() > 85"
                                        data-type="error"
                                        data-value="informationsCtrl.currentusageInGb()"
                                    >
                                        <span
                                            data-ng-bind="(informationsCtrl.sharepoint.currentUsage | humanReadableSize) + ' / ' + (informationsCtrl.sharepoint.quota | humanReadableSize)"
                                        ></span>
                                    </oui-progress-bar>
                                </oui-progress>
                            </oui-tile-description>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{:: 'sharepoint_dashboard_quota_total_label' | translate}}"
                        >
                            <oui-tile-description
                                data-ng-bind="informationsCtrl.sharepoint.quota | humanReadableSize"
                            ></oui-tile-description>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{:: 'sharepoint_dashboard_quota_used_label' | translate}}"
                        >
                            <oui-tile-description
                                data-ng-bind="informationsCtrl.sharepoint.currentUsage | humanReadableSize"
                            ></oui-tile-description>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{:: 'sharepoint_dashboard_quota_free_label' | translate}}"
                        >
                            <oui-tile-description
                                data-ng-bind="informationsCtrl.sharepoint.quota - informationsCtrl.sharepoint.currentUsage | humanReadableSize"
                            ></oui-tile-description>
                        </oui-tile-definition>
                    </oui-tile>
                </div>
            </div>
        </div>
        <div class="col-md-3 mt-md-5 mt-lg-0">
            <p>
                <span class="fa fa-life-ring mr-2" aria-hidden="true"></span>
                <span
                    data-translate="sharepoint_dashboard_guides_help_label"
                ></span
                ><br />
                <a
                    data-ng-href="{{SharepointCtrl.sharepointGuideUrl}}"
                    target="_blank"
                    title="{{ 'sharepoint_dashboard_guides_url' | translate }}"
                >
                    <span
                        data-translate="sharepoint_exchange_dashboard_guides_url"
                    ></span>
                    <span class="fa fa-external-link" aria-hidden="true"></span>
                </a>
            </p>
        </div>
    </div>
</div>
