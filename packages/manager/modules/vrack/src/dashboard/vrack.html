<section class="vrack" data-ng-if="$ctrl.serviceName">
    <div class="row">
        <header
            class="vrack__header col-md-9 col-xs-9 cloud-legacy"
            data-ng-if="$ctrl.nameEditing"
        >
            <form
                name="nameForm"
                class="vrack__edit-form"
                data-ng-class="{'has-error': nameForm.name.$invalid}"
                data-ng-submit="$ctrl.saveName()"
            >
                <input
                    id="name"
                    name="name"
                    type="text"
                    class="vrack__edit-input form-control"
                    data-ng-model="$ctrl.name"
                    data-ng-maxlength="$ctrl.nameOptions.maxLength"
                    data-ng-pattern="$ctrl.nameOptions.pattern"
                />
                <button
                    class="vrack__edit-button vrack__edit-button_save btn btn-icon"
                    type="submit"
                    title="{{'vrack_cloud_save_name' | translate }}"
                    data-ng-disabled="nameForm.name.$invalid"
                >
                    <i class="ovh-font ovh-font-check" aria-hidden="true"></i>
                </button>
                <button
                    class="vrack__edit-button vrack__edit-button_cancel btn btn-icon"
                    type="reset"
                    title="{{'vrack_cloud_reset_name' | translate }}"
                    data-ng-click="$ctrl.cancelEditName()"
                >
                    <i class="ovh-font ovh-font-wrong" aria-hidden="true"></i>
                </button>

                <ul
                    class="vrack__error-list vrack__error-list_in-header list-unstyled has-error"
                    data-ng-show="nameForm.name.$invalid"
                    data-ng-messages="nameForm.name.$error"
                >
                    <li
                        class="vrack__error-item help-block"
                        data-ng-if="nameForm.name.$error.maxlength"
                        data-translate="vrack_cloud_name_max_length"
                        data-translate-values="{ max: $ctrl.nameOptions.maxLength}"
                    ></li>
                    <li
                        class="vrack__error-item help-block"
                        data-ng-if="nameForm.name.$error.pattern"
                        data-translate="vrack_cloud_name_pattern"
                    ></li>
                </ul>
            </form>
        </header>

        <header
            class="oui-header mx-0 col-md-9 col-xs-9 cloud-legacy"
            data-ng-if="!$ctrl.nameEditing"
        >
            <div class="oui-header__container">
                <div class="oui-header__content">
                    <h1
                        class="oui-header__title"
                        data-ng-bind="$ctrl.name || $ctrl.serviceName"
                    ></h1>
                    <h2
                        class="oui-header__description"
                        data-ng-if="$ctrl.name !== ''"
                        data-ng-bind="$ctrl.serviceName"
                    ></h2>
                </div>
            </div>
            <button
                class="vrack__edit-button btn btn-icon"
                type="button"
                aria-label="{{:: 'vrack_cloud_modiy_name' | translate }}"
                data-ng-click="$ctrl.editName()"
            >
                <span
                    class="oui-icon oui-icon-pen_concept"
                    aria-hidden="true"
                ></span>
            </button>
        </header>
        <div data-ng-if="$ctrl.surveyUrl" class="col-md-3 col-xs-3">
            <a
                class="btn btn-link"
                target="_blank"
                data-ng-href="{{ $ctrl.surveyUrl }}"
                data-oui-tooltip="{{:: 'list_layout_like_this_tooltip' | translate }}"
                data-oui-tooltip-placement="top"
            >
                <i class="oui-icon oui-icon-smiley-happy_concept mr-1"></i>
                <span data-translate="list_layout_like_this"></span>
            </a>
        </div>
    </div>

    <div>
        <cui-message-container
            data-messages="$ctrl.messages"
        ></cui-message-container>
    </div>

    <div>
        <section>
            <div ng-if="$ctrl.description || $ctrl.descriptionEditing">
                <h3 data-translate="vrack_description_title"></h3>
                <form
                    name="descriptionForm"
                    data-ng-class="{'has-error': descriptionForm.description.$invalid}"
                    data-ng-submit="$ctrl.saveDescription()"
                >
                    <div
                        class="form-group"
                        data-ng-if="$ctrl.descriptionEditing"
                    >
                        <textarea
                            id="description"
                            name="description"
                            class="oui-textarea vertical-resize ng-touched"
                            rows="4"
                            data-ng-model="$ctrl.description"
                            data-ng-maxlength="$ctrl.descriptionOptions.maxLength"
                        >
                        </textarea>
                        <button
                            class="vrack__edit-button vrack__edit-button_save btn btn-icon"
                            type="submit"
                            title="{{'vrack_cloud_save_description' | translate }}"
                            data-ng-disabled="descriptionForm.description.$invalid"
                        >
                            <i
                                class="ovh-font ovh-font-check"
                                aria-hidden="true"
                            ></i>
                        </button>
                        <button
                            class="vrack__edit-button vrack__edit-button_cancel btn btn-icon"
                            type="reset"
                            title="{{'vrack_cloud_reset_description' | translate }}"
                            data-ng-click="$ctrl.cancelEditDescription()"
                        >
                            <i
                                class="ovh-font ovh-font-wrong"
                                aria-hidden="true"
                            ></i>
                        </button>
                        <span
                            class="pull-right"
                            data-ng-class="{'text-danger': descriptionForm.description.$invalid}"
                            data-translate="vrack_cloud_description_character_count"
                            data-translate-values="{ count: descriptionForm.description.$viewValue.length,
                                                       max: $ctrl.descriptionOptions.maxLength }"
                        ></span>
                        <ul
                            class="vrack__error-list vrack__error-list_in-header list-unstyled has-error"
                            data-ng-show="descriptionForm.description.$invalid"
                        >
                            <li
                                class="vrack__error-item help-block"
                                data-ng-if="descriptionForm.description.$error.maxlength"
                                data-translate="vrack_cloud_description_max_length"
                                data-translate-values="{ max: $ctrl.descriptionOptions.maxLength }"
                            ></li>
                        </ul>
                    </div>
                </form>
                <div class="form-group" data-ng-if="!$ctrl.descriptionEditing">
                    <span
                        class="ng-scope"
                        data-ng-bind="$ctrl.description"
                    ></span>
                    <button
                        class="btn btn-icon"
                        type="button"
                        title="{{'vrack_cloud_modiy_description' | translate }}"
                        data-ng-click="$ctrl.editDescription()"
                    >
                        <i
                            class="oui-icon oui-icon-pen_concept"
                            aria-hidden="true"
                        ></i>
                    </button>
                </div>
            </div>
            <div data-ng-if="!$ctrl.description && !$ctrl.descriptionEditing">
                <p class="vrack__text vrack__empty-description-text">
                    <button
                        class="btn-link no-padding"
                        type="button"
                        data-ng-click="$ctrl.editDescription()"
                        data-translate="vrack_cloud_no_description"
                        title="{{ 'vrack_cloud_no_description_title' | translate }}"
                    ></button>
                </p>
            </div>
        </section>

        <section>
            <h3 data-translate="vrack_introduction_title"></h3>
            <p data-translate="vrack_introduction_description"></p>
            <p
                data-ng-if="$ctrl.changeOwnerUrl"
                data-translate="vrack_introduction_change_owner"
                data-translate-compile
                data-translate-values="{ uri: $ctrl.changeOwnerUrl, trackLabel: $ctrl.changeOwnerTrackLabel }"
            ></p>
        </section>

        <section class="vrack__mapper">
            <div class="text-center" data-ng-if="$ctrl.loaders.init">
                <oui-spinner></oui-spinner>
            </div>
            <div class="row space-m0">
                <div class="col-sm-12 col-md-5 col-lg-5 space-p0">
                    <ng-include
                        data-src="'vrack/partials/available.html'"
                        data-ng-show="!$ctrl.loaders.init"
                    >
                    </ng-include>
                </div>
                <vrack-add-ipv6-modal
                    data-is-open-modal="$ctrl.addIpv6Modal"
                    data-on-confirm="$ctrl.addServiceAction()"
                    data-on-cancel="$ctrl.resetAction()"
                    data-state="$ctrl.addIpv6ModalState"
                ></vrack-add-ipv6-modal>
                <vrack-delete-ipv6-modal
                    data-is-open-modal="$ctrl.deleteIpv6Modal"
                    data-on-confirm="$ctrl.deleteServiceAction()"
                    data-on-cancel="$ctrl.resetAction()"
                    data-services-to-delete-list="$ctrl.servicesToDeleteList()"
                ></vrack-delete-ipv6-modal>
                <div
                    class="vrack__mapper-actions col-sm-12 col-md-2 col-lg-2 top-space-p16 no-space"
                    data-ng-include="'vrack/partials/actions.html'"
                ></div>
                <div class="col-sm-12 col-md-5 col-lg-5 space-p0">
                    <ng-include
                        data-src="'vrack/partials/mapped.html'"
                        data-ng-show="!$ctrl.loaders.init"
                    >
                    </ng-include>
                </div>
            </div>
        </section>
    </div>
</section>
