<oui-message
    class="my-3"
    data-type="warning"
    data-dismissable
    data-ng-if="$ctrl.isRenewalServicesIssueBannerAvailable && $ctrl.step === 'issues'"
>
    <p class="m-1" data-translate="ovhManagerSupport_bm_vps_customers_renew_services_issue_part_1"></p>
    <div class="m-1">
        <p class="my-1" data-translate="ovhManagerSupport_bm_vps_customers_renew_services_issue_part_2"></p>
        <a
            data-ng-href="{{::$ctrl.VPS_CUSTOMERS_RENEW_ISSUES_LINK}}"
            target="_blank"
            rel="noopener"
        >
            <span data-translate="ovhManagerSupport_bm_vps_customers_renew_services_issue_part_2_link"></span>
            <span
                class="oui-icon oui-icon-external-link"
                aria-hidden="true"
            ></span>
        </a>
    </div>
    <p class="m-1 mt-3" data-translate="ovhManagerSupport_bm_vps_customers_renew_services_issue_part_3"></p>
</oui-message>

<oui-back-button data-on-click="$ctrl.handleBackButton()">
    <span data-translate="ovhManagerSupport_new_back"></span>
</oui-back-button>


<support-new-issues-form
    data-ng-show="$ctrl.step === 'issues'"
    data-on-submit="$ctrl.onIssuesFormSubmit(result)"
    data-category-name="$ctrl.categoryName"
    data-service-name="$ctrl.serviceName"
    data-service-type-name="$ctrl.serviceTypeName"
>
</support-new-issues-form>

<support-new-creation-form
    id="creationForm"
    data-issue="$ctrl.issue"
    data-ng-show="$ctrl.step === 'creation'"
    data-on-submit="$ctrl.onCreationFormSubmit(result)"
    data-go-back="$ctrl.goBack()"
>
</support-new-creation-form>

<div class="text-center" data-ng-if="$ctrl.step === 'creating'">
    <oui-spinner data-size="l"></oui-spinner>
</div>

<div data-ng-if="$ctrl.step === 'created'">
    <oui-message data-type="success">
        <span
            data-translate="ovhManagerSupport_new_creation_success"
            data-translate-values="{ state: 'support.tickets.ticket({ id: $ctrl.ticketId })', id: $ctrl.ticketNumber }"
            data-translate-compile
        >
        </span>
        <span
            data-translate="ovhManagerSupport_new_creation_success_back"
            data-translate-values="{ state: 'support.tickets' }"
            data-translate-compile
        >
        </span>
    </oui-message>

    <p data-translate="ovhManagerSupport_new_creation_tip_1"></p>
    <p data-ng-if="$ctrl.guideURL">
        <span data-translate="ovhManagerSupport_new_creation_tip_guides"></span>
        <a
            class="oui-link oui-link_icon"
            data-ng-href="{{ $ctrl.guideURL }}"
            target="_blank"
            rel="noopener"
        >
            <span data-ng-bind="$ctrl.guideURL"></span>
            <span
                class="oui-icon oui-icon-external-link"
                aria-hidden="true"
            ></span>
            <span
                class="sr-only"
                data-translate="ovhManagerSupport_new_open_new_tab"
            ></span>
        </a>
    </p>
    <p data-ng-if="$ctrl.forumURL">
        <span data-translate="ovhManagerSupport_new_creation_tip_forum"></span>
        <a
            class="oui-link oui-link_icon"
            data-ng-href="{{ $ctrl.forumURL }}"
            target="_blank"
            rel="noopener"
        >
            <span data-ng-bind="$ctrl.forumURL"></span>
            <span
                class="oui-icon oui-icon-external-link"
                aria-hidden="true"
            ></span>
            <span
                class="sr-only"
                data-translate="ovhManagerSupport_new_open_new_tab"
            ></span>
        </a>
    </p>
    <p data-translate="ovhManagerSupport_new_creation_tip_2"></p>
    <p
        data-translate="ovhManagerSupport_new_creation_tip_3"
        data-translate-values="{ state: 'support.tickets.ticket({ id: $ctrl.ticketId })' }"
        data-translate-compile
    ></p>

    <support-tickets-new-feedback></support-tickets-new-feedback>
</div>

<oui-message data-type="error" data-ng-if="$ctrl.step === 'error'">
    <p>
        <strong data-translate="ovhManagerSupport_new_creation_error"></strong>
    </p>
    <p>
        <span data-ng-bind="$ctrl.getErrorMessage()"></span>
    </p>
    <oui-button data-variant="secondary" data-on-click="$ctrl.goToTickets()"
        ><span data-translate="ovhManagerSupport_new_creation_cancel"></span>
    </oui-button>
    <support-tickets-new-feedback></support-tickets-new-feedback>
</oui-message>
