<oui-tile
    class="h-100"
    data-heading="{{:: 'dedicated_server_interfaces' | translate }}"
>
    <div class="oui-tile__item">
        <span
            data-translate="dedicated_server_interfaces_vrack_information"
        ></span
        >&nbsp;
        <a
            class="oui-link_icon"
            data-ng-if="$ctrl.urls.guides.vrack"
            data-ng-href="{{::$ctrl.urls.guides.vrack}}"
            target="_blank"
            rel="noopener"
        >
            <span
                data-translate="dedicated_server_interfaces_vrack_information_link_label"
            ></span>
            <span
                class="oui-icon oui-icon-external-link"
                aria-hidden="true"
            ></span>
            <span
                class="sr-only"
                data-translate="dedicated_server_interfaces_new_tab"
            ></span>
        </a>
    </div>

    <oui-button
        data-ng-if="$ctrl.isFullyAggregated"
        data-variant="primary"
        data-ui-sref=".ola-reset({ola: $ctrl.ola})"
    >
        <span
            data-translate="dedicated_server_interfaces_disaggregate_button"
        ></span>
    </oui-button>
    <oui-button
        data-ng-if="!$ctrl.isFullyAggregated && $ctrl.ola.isAvailable()"
        data-variant="primary"
        data-ui-sref=".ola-configuration"
    >
        <span
            data-translate="dedicated_server_interfaces_aggregate_button"
        ></span>
    </oui-button>

    <div class="mw-100 overflow-auto">
        <table class="oui-table oui-tile__body table-striped">
            <thead class="oui-table__headers">
                <tr>
                    <th
                        class="oui-table__header"
                        data-translate="dedicated_server_interfaces_type_label"
                    ></th>
                    <th
                        class="oui-table__header"
                        data-translate="dedicated_server_interfaces_name_label"
                    ></th>
                    <th
                        class="oui-table__header"
                        data-translate="dedicated_server_interfaces_mac_label"
                    ></th>
                    <th
                        class="oui-table__header"
                        data-translate="dedicated_server_interfaces_bandwidth_outgoing_label"
                    ></th>
                    <th
                        class="oui-table__header"
                        data-translate="dedicated_server_interfaces_bandwidth_incoming_label"
                    ></th>
                    <th
                        class="oui-table__header"
                        data-translate="dedicated_server_interfaces_ip_label"
                    ></th>
                    <th
                        class="oui-table__header"
                        data-ng-bind="::$ctrl.LABELS.ADDITIONAL_IP"
                    ></th>
                    <th
                        class="oui-table__header"
                        data-translate="dedicated_server_interfaces_vrack_label"
                    ></th>
                    <th class="oui-table__header" data-translate=""></th>
                </tr>
            </thead>
            <tbody>
                <tr
                    class="oui-table__row"
                    data-ng-repeat="$row in $ctrl.interfaces track by $row.id"
                >
                    <td class="oui-table__cell">
                        <div
                            data-translate="{{ 'dedicated_server_interfaces_type_' + $row.type + '_label' }}"
                        ></div>
                        <div
                            data-ng-if="$row.displayedMacAdresses.length > 1"
                            class="oui-badge oui-badge_success"
                            data-translate="{{ 'dedicated_server_interfaces_type_badge_aggregated' }}"
                        ></div>
                    </td>
                    <td class="oui-table__cell" data-ng-bind="$row.name"></td>
                    <td class="oui-table__cell">
                        <div data-ng-if="$row.displayedMacAdresses.length > 1">
                            <ul class="mb-0">
                                <li
                                    data-ng-repeat="mac in $row.displayedMacAdresses"
                                >
                                    <p class="mb-0" data-ng-bind="mac"></p>
                                </li>
                            </ul>
                        </div>
                        <div data-ng-if="$row.displayedMacAdresses.length <= 1">
                            <span data-ng-bind="$row.mac"></span>
                        </div>
                    </td>
                    <td class="oui-table__cell">
                        <div data-ng-if="$row.isPublic()">
                            <span
                                class="oui-icon oui-icon-arrow-up font-inherit"
                            ></span>
                            <span
                                data-ng-bind="$ctrl.specifications.bandwidth.OvhToInternet | serverBandwidth"
                            ></span>
                        </div>
                        <div data-ng-if="!$row.isPublic()">
                            <span
                                class="oui-icon oui-icon-arrow-up font-inherit"
                            ></span>
                            <span
                                data-ng-bind="$ctrl.specifications.vrack.bandwidth | serverBandwidth"
                            ></span>
                            <span
                                class="font-weight-bold"
                                ng-if="$row.type === $ctrl.VIRTUAL_TYPE.vrackAggregation"
                                data-translate="dedicated_server_interfaces_vrack_aggregation_guarantee"
                            ></span>
                        </div>
                    </td>
                    <td class="oui-table__cell">
                        <div data-ng-if="$row.isPublic()">
                            <span
                                class="oui-icon oui-icon-arrow-down font-inherit"
                            ></span>
                            <span
                                data-ng-bind="$ctrl.specifications.bandwidth.InternetToOvh | serverBandwidth"
                            ></span>
                        </div>
                        <div data-ng-if="!$row.isPublic()">
                            <span
                                class="oui-icon oui-icon-arrow-down font-inherit"
                            ></span>
                            <span
                                data-ng-bind="$ctrl.specifications.vrack.bandwidth | serverBandwidth"
                            ></span>
                            <span
                                class="font-weight-bold"
                                ng-if="$row.type === $ctrl.VIRTUAL_TYPE.vrackAggregation"
                                data-translate="dedicated_server_interfaces_vrack_aggregation_guarantee"
                            ></span>
                        </div>
                    </td>
                    <td class="oui-table__cell">
                        <oui-clipboard
                            class="ip-clipboard"
                            data-ng-if="$row.isPublic()"
                            data-model="$ctrl.specifications.routing.ipv4.ip"
                        >
                        </oui-clipboard>
                        <span data-ng-if="!$row.isPublic()">-</span>
                    </td>
                    <td class="oui-table__cell">
                        <span
                            data-ng-if="$row.isPublic()"
                            data-ng-bind="$ctrl.failoverIps.length"
                        ></span>
                        <span data-ng-if="!$row.isPublic()">-</span>
                    </td>
                    <td class="oui-table__cell">
                        <div data-ng-if="$row.hasTaskInProgress()">
                            <span
                                class="d-inline-block mr-1"
                                data-ng-bind="'dedicated_server_interfaces_vrack_operation_' + $row.operation | translate"
                            ></span>
                            <oui-spinner data-size="s"></oui-spinner>
                        </div>
                        <div data-ng-if="!$row.hasTaskInProgress()">
                            <span
                                data-ng-if="$row.hasVrack()"
                                data-ng-bind="$row.vrack"
                            ></span>
                            <span data-ng-if="!$row.hasVrack()">-</span>
                        </div>
                    </td>
                    <td class="oui-table__cell">
                        <oui-action-menu data-compact data-placement="top-end">
                            <oui-action-menu-item
                                data-ui-sref=".rename({ interface: $row })"
                                data-ng-if="$row.isVirtual()"
                            >
                                <span
                                    data-translate="dedicated_server_interfaces_rename_label"
                                ></span>
                            </oui-action-menu-item>
                            <oui-action-menu-item
                                data-ui-sref=".bandwidth-public-order"
                                data-ng-if="$row.isPublic() && $ctrl.server.canOrderBandwith"
                            >
                                <span
                                    data-translate="dedicated_server_interfaces_order_public_bandwidth_label"
                                ></span>
                            </oui-action-menu-item>
                            <oui-action-menu-item
                                data-ui-sref=".bandwidth-private-order"
                                data-ng-if="$row.isPrivate() && $ctrl.server.canOrderVrackBandwith"
                            >
                                <span
                                    data-translate="dedicated_server_interfaces_order_private_bandwidth_label"
                                ></span>
                            </oui-action-menu-item>
                            <oui-action-menu-item
                                data-ui-sref="app.ip({ serviceName: $ctrl.serverName })"
                                data-ng-if="$row.isPublic()"
                                data-external
                            >
                                <span
                                    data-translate="dedicated_server_interfaces_manage_ips_label"
                                ></span>
                            </oui-action-menu-item>
                            <oui-action-menu-item
                                data-ui-sref=".attach({interface: $row})"
                                data-ng-if="!$row.hasTaskInProgress() && $row.isPrivate() && !$row.hasVrack()"
                            >
                                <span
                                    data-translate="dedicated_server_interfaces_attach_private_network_label"
                                ></span>
                            </oui-action-menu-item>
                            <oui-action-menu-item
                                data-ui-sref=".detach({interface: $row})"
                                data-ng-if="!$row.hasTaskInProgress() && $row.hasVrack()"
                            >
                                <span
                                    data-translate="dedicated_server_interfaces_detach_private_network_label"
                                ></span>
                            </oui-action-menu-item>
                        </oui-action-menu>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</oui-tile>
