<div class="cloud-compute-quota cui-page__content">

    <!-- INIT LOADER -->
    <div class="text-center" data-ng-if="CloudProjectComputeQuotaCtrl.loader.quota">
        <oui-spinner></oui-spinner>
    </div>

    <!-- UNLEASH LOADER -->
    <div class="text-center" data-ng-if="CloudProjectComputeQuotaCtrl.loader.unleash">
        <oui-spinner></oui-spinner>
    </div>

    <div data-ng-if="!CloudProjectComputeQuotaCtrl.loader.quota && !CloudProjectComputeQuotaCtrl.loader.unleash">

        <!-- THERE IS NO PAYMENT MEAN - SHOW A MESSAGE TO ADD IT -->
        <div data-ng-if="CloudProjectComputeQuotaCtrl.state.isRestrictedQuota && !CloudProjectComputeQuotaCtrl.datas.defaultPaymentMean">

            <div class="well">

                <p class="bold">{{ :: 'cpb_quota_restricted_account' | translate }}</p>
                <p data-translate="cpb_quota_restricted_account_unlock"
                   data-translate-values="{'url': CloudProjectComputeQuotaCtrl.paymentmeanUrl}">
                </p>

            </div>

        </div>

        <!-- THERE IS A PAYMENT MEAN BUT QUOTA IS RESTRICTED -  -->
         <div data-ng-if="CloudProjectComputeQuotaCtrl.state.isRestrictedQuota && CloudProjectComputeQuotaCtrl.datas.defaultPaymentMean">

            <div class="well">

                <p class="bold">{{ :: 'cpb_quota_restricted_paymentmean_active' | translate }}</p>
                <button class="oui-button oui-button_primary"
                        data-ng-click="CloudProjectComputeQuotaCtrl.unleashAccount()">
                    {{ :: 'cpb_quota_restricted_unlock_button' | translate }}
                </button>

            </div>

        </div>

        <!-- ITS NOT RESTRICTED AND THERE IS A PAYMENT MEAN -->
        <div class="well" data-ng-if="!CloudProjectComputeQuotaCtrl.state.isRestrictedQuota">

            <p class="bold">{{ :: 'cpb_quota_protect_explain' | translate }}</p>

            <p write-right-required>{{ :: 'cpb_quota_protect_more' | translate }}</p>

            <button type="button"
                    class="oui-button oui-button_primary"
                    data-ng-if="CloudProjectComputeQuotaCtrl.TARGET !== 'US'"
                    data-ng-disabled="!CloudProjectComputeQuotaCtrl.datas.quota || (CloudProjectComputeQuotaCtrl.datas.quota && CloudProjectComputeQuotaCtrl.datas.quota.length === 0)"
                    data-ng-click="CloudProjectComputeQuotaCtrl.openSupport()"
                    write-right-required
                    data-translate="cpb_quota_protect_more_btn">
            </button>

            <div data-ng-if="CloudProjectComputeQuotaCtrl.TARGET === 'US'"
                 data-write-right-required>
                <button type="button"
                        class="oui-button oui-button_primary no-transition"
                        data-ng-if="!CloudProjectComputeQuotaCtrl.datas.quota || (CloudProjectComputeQuotaCtrl.datas.quota && CloudProjectComputeQuotaCtrl.datas.quota.length === 0)"
                        data-ng-disabled="true"
                        data-translate="cpb_quota_protect_more_btn">
                </button>

                <a class="oui-button oui-button_primary no-transition"
                   data-ng-if="CloudProjectComputeQuotaCtrl.TARGET === 'US' && CloudProjectComputeQuotaCtrl.datas.quota.length"
                   data-ng-href="{{ CloudProjectComputeQuotaCtrl.supportUrl }}"
                   data-translate="cpb_quota_protect_more_btn">
                </a>
            </div>

        </div>

        <!-- QUOTA TABLE -->
        <strong>{{ :: 'cpb_quota_current_limit' | translate }}</strong>

        <oui-datagrid data-rows="CloudProjectComputeQuotaCtrl.datas.quota">
            <oui-column data-title="'cloud_common_region' | translate" data-property="region" data-sortable="asc">
                <div class="flag-box">
                    <div class="flag-wrapper inline-block vertical-middle">
                        <span class="flag-icon {{ :: CloudProjectComputeQuotaCtrl.regionService.getRegionIconFlag($row.region) }} flag"></span>
                    </div>
                    <div class="flag-text inline-block left-space-m8 top-space-m8 vertical-middle">
                        {{ :: CloudProjectComputeQuotaCtrl.regionService.getTranslatedMicroRegion($row.region) }}
                    </div>
                </div>
            </oui-column>
            <oui-column data-title="'cloud_common_instance' | translate" data-property="instance.maxInstances">
                <span data-ng-if="$row.instance.maxInstances === -1">
                    {{ :: $row.instance.usedInstances }} / {{ :: 'cpb_quota_instance_unlimited' | translate }}
                </span>
                <span data-ng-if="$row.instance.maxInstances !== -1">
                    {{ :: $row.instance.usedInstances }} / {{ :: $row.instance.maxInstances }}
                </span>
            </oui-column>
            <oui-column data-title="'cloud_common_core' | translate" data-property="instance.maxCores">
                <span data-ng-if="$row.instance.maxCores === -1">
                    {{ :: $row.instance.usedCores }} / {{ :: 'cpb_quota_instance_unlimited' | translate }}
                </span>
                <span data-ng-if="quota.instance.maxCores !== -1">
                    {{ :: $row.instance.usedCores }} / {{ :: $row.instance.maxCores }}
                </span>
            </oui-column>
            <oui-column data-title="'cloud_common_ram' | translate" data-property="instance.maxRam">
                <span data-ng-if="$row.instance.maxRam === -1">
                    {{ :: $row.instance.usedRAM > 0 ? (($row.instance.usedRAM * 1000000) | cucBytes:2) : $row.instance.usedRAM }} / {{ :: 'cpb_quota_instance_unlimited' | translate }}
                </span>
                <span data-ng-if="$row.instance.maxRam !== -1">
                    {{ :: $row.instance.usedRAM > 0 ? (($row.instance.usedRAM * 1000000) | cucBytes:2) : $row.instance.usedRAM }} / {{ :: ($row.instance.maxRam * 1000000) | cucBytes:2 }}
                </span>
            </oui-column>
            <oui-column data-title="'cpb_quota_add_disk' | translate" data-property="volume.maxGigabytes">
                <span data-ng-if="$row.volume.maxGigabytes === -1">
                    {{ :: $row.volume.usedGigabytes > 0 ? (($row.volume.usedGigabytes * 1000000000) | cucBytes:2) : $row.volume.usedGigabytes }} / {{ :: 'cpb_quota_instance_unlimited' | translate }}
                </span>
                <span data-ng-if="$row.volume.maxGigabytes !== -1">
                    {{ :: $row.volume.usedGigabytes > 0 ? (($row.volume.usedGigabytes * 1000000000) | cucBytes:2) : $row.volume.usedGigabytes }} / {{ :: ($row.volume.maxGigabytes * 1000000000) | cucBytes:2 }}
                </span>
            </oui-column>
        </oui-datagrid>

    </div>

</div>
