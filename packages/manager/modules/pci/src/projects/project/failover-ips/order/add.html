<div data-ui-view class="container-fluid py-4">
    <oui-back-button data-on-click="$ctrl.goBack()">
        <span data-translate="pci_additional_ip_create"></span>
    </oui-back-button>

    <p data-translate="pci_additional_ip_create_description"></p>

    <cui-message-container
        data-messages="$ctrl.messages"
    ></cui-message-container>

    <oui-stepper>
        <oui-step-form
            data-header="{{:: 'pci_additional_ip_create_step_select_ip' | translate}}"
            data-editable="!$ctrl.loaders.isSubmitting"
            name="additional_ip_create_step_select_ip"
        >
            <div class="row mb-3">
                <oui-select-picker
                    class="col-md-4 mb-3"
                    data-ng-repeat="type in $ctrl.ipTypes track by type.name"
                    data-name="{{:: type.name }}"
                    data-model="$ctrl.selectedIpType"
                    data-label="{{:: type.label }}"
                    data-values="[type]"
                    data-variant="light"
                    data-on-change="$ctrl.onProductChange(modelValue)"
                    data-required
                >
                    <oui-select-picker-section>
                        <span data-ng-bind="type.description"></span>
                    </oui-select-picker-section>
                </oui-select-picker>
            </div>
        </oui-step-form>
        <oui-step-form
            data-header="{{:: 'pci_additional_ip_create_step_select_region' | translate }}"
            data-editable="!$ctrl.loaders.isSubmitting"
            data-loading="$ctrl.loadingRegions"
            data-navigation="$ctrl.ip.region"
            name="additional_ip_create_step_select_region"
        >
            <p
                data-translate="pci_additional_ip_create_step_select_region_description"
                data-translate_values="{
                    guideLink: $ctrl.getFailoverIpGuideLink()
                }"
            ></p>
            <div class="row mb-3">
                <oui-select-picker
                    class="col-md-4 mb-3"
                    data-ng-repeat="country in $ctrl.failOverIpCountries track by country"
                    data-name="{{:: country }}"
                    data-model="$ctrl.ip.region"
                    data-label="{{:: 'pci_projects_project_failoverip_country_' + country | translate }}"
                    data-values="[country]"
                    data-variant="light"
                    data-required
                >
                </oui-select-picker>
            </div>
        </oui-step-form>
        <oui-step-form
            data-header="{{:: 'pci_additional_ip_create_step_attach_instance' | translate }}"
            data-editable="!$ctrl.loaders.isSubmitting"
            data-on-submit="$ctrl.createAdditionalIp()"
            data-navigation="$ctrl.instances.length > 0"
            data-submit-text="{{:: 'pci_additional_ip_create_action_label' | translate }}"
            data-required
            name="additional_ip_create_step_attach_instance"
        >
            <oui-message data-type="info">
                <p
                    data-translate="pci_additional_ip_create_step_attach_instance_info"
                    data-translate_values="{
                        guideLink: $ctrl.getFailoverIpConfGuideLink()
                    }"
                ></p>
            </oui-message>

            <div data-ng-if="$ctrl.instances.length === 0">
                <oui-message data-type="error">
                    <p>
                        <span
                            data-translate="pci_additional_ip_create_no_instance_message"
                        ></span>
                        <span
                            data-translate="pci_additional_ip_create_create_instance"
                            data-translate_values="{
                                url: $ctrl.createInstanceUrl
                            }"
                        >
                        </span>
                    </p>
                </oui-message>
            </div>

            <div data-ng-if="$ctrl.instances.length > 0" class="mb-3">
                <oui-field
                    data-label="{{:: 'pci_projects_project_failoverip_order_instance' | translate }}"
                    data-size="xl"
                >
                    <oui-select
                        name="instance"
                        data-placeholder="{{:: 'pci_additional_ip_create_step_attach_instance_label' | translate }}"
                        data-model="$ctrl.ip.instance"
                        data-items="$ctrl.instances"
                        data-disable-items="!$item.canAttachIPFO()"
                        data-match="name"
                        data-required
                    >
                    </oui-select>
                </oui-field>
            </div>
        </oui-step-form>
    </oui-stepper>
</div>
