<oui-button
    variant="secondary"
    icon-left="oui-icon-add"
    disabled="$ctrl.listeners.length >= 5"
    class="mb-2"
    data-on-click="$ctrl.addListener()"
>
    <span data-translate="octavia_load_balancer_add_listener"></span>
</oui-button>
<div class="container-fluid">
    <table class="oui-table">
        <thead>
            <tr>
                <th class="oui-table__header">
                    <span
                        data-translate="octavia_load_balancer_instances_table_listener"
                    ></span>
                </th>
                <th class="oui-table__header"></th>
                <th class="oui-table__header">
                    <span
                        data-translate="octavia_load_balancer_instances_table_pools"
                    ></span>
                    <span
                        class="oui-icon oui-icon-help"
                        aria-hidden="true"
                        oui-tooltip="{{:: 'octavia_load_balancer_instances_table_pools_tooltip' | translate }}"
                    ></span>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr
                data-ng-repeat="listener in $ctrl.listeners track by $index"
                class="oui-table__row"
            >
                <td class="oui-table__cell pt-2 pb-2">
                    <div class="container-fluid">
                        <div class="row align-items-center">
                            <div class="col-6">
                                <label
                                    for="select-listener-protocol"
                                    class="oui-label d-flex align-items-center mb-1"
                                >
                                    <small
                                        data-translate="octavia_load_balancer_instances_table_protocol_label"
                                        class="mr-1"
                                    ></small>
                                    <span
                                        class="oui-icon oui-icon-help"
                                        aria-hidden="true"
                                        oui-tooltip="{{:: 'octavia_load_balancer_instances_table_protocol_tooltip' | translate }}"
                                    ></span>
                                </label>
                                <oui-select
                                    data-name="select-listener-protocol"
                                    data-model="listener.protocol"
                                    data-match="name"
                                    data-items="$ctrl.listenerProtocols"
                                    data-on-change="$ctrl.selectListenerProtocol(modelValue, listener)"
                                >
                                </oui-select>
                            </div>
                            <div class="col-2">
                                <label
                                    for="select-listener-protocol"
                                    class="oui-label d-flex align-items-center mb-1"
                                >
                                    <small
                                        data-translate="octavia_load_balancer_instances_table_port_label"
                                        class="mr-1"
                                    ></small>
                                    <span
                                        class="oui-icon oui-icon-help"
                                        aria-hidden="true"
                                        oui-tooltip="{{:: 'octavia_load_balancer_instances_table_port_tooltip' | translate }}"
                                    ></span>
                                </label>
                                <input
                                    class="oui-input"
                                    type="text"
                                    name="select-listener-port"
                                    data-ng-model="listener.port"
                                    data-min="1"
                                    data-max="65535"
                                />
                                <!-- <oui-numeric
                                    name="select-listener-port"
                                    data-model="listener.port"
                                    data-min="1"
                                    data-max="65535"
                                ></oui-numeric> -->
                            </div>
                            <div class="col-2 align-self-end">
                                <oui-button
                                    variant="link"
                                    data-aria-label="{{:: 'octavia_load_balancer_instances_table_listener_delete' | translate}}"
                                    data-on-click="$ctrl.deleteListener($index)"
                                    oui-tooltip="{{:: 'octavia_load_balancer_instances_table_listener_delete' | translate }}"
                                >
                                    <span
                                        class="oui-icon oui-icon-bin"
                                        aria-hidden
                                    ></span>
                                </oui-button>
                            </div>
                        </div>
                    </div>
                </td>
                <td class="oui-table__cell">
                    <span class="oui-icon oui-icon-arrow-right"></span>
                </td>
                <td class="oui-table__cell pt-2 pb-2">
                    <div class="container-fluid">
                        <div class="row align-items-center mb-2">
                            <div class="col-6">
                                <label
                                    for="select-health-monitor"
                                    class="oui-label d-flex align-items-center mb-1"
                                >
                                    <small
                                        data-translate="octavia_load_balancer_instances_table_health_monitor_label"
                                        class="mr-1"
                                    ></small>
                                    <span
                                        class="oui-icon oui-icon-help"
                                        aria-hidden="true"
                                        oui-tooltip="{{:: 'octavia_load_balancer_instances_table_health_monitor_tooltip' | translate }}"
                                    ></span>
                                </label>
                                <oui-select
                                    data-name="select-health-monitor"
                                    data-model="listener.healthMonitor"
                                    data-items="listener.protocol.healthMonitors"
                                    data-on-change="$ctrl.selectHealthMonitor(modelValue, listener)"
                                    data-disabled="$ctrl.isPoolSectionDisabled(listener)"
                                >
                                </oui-select>
                            </div>
                            <div class="col-3 align-self-end">
                                <oui-button
                                    variant="link"
                                    data-aria-label="{{:: 'octavia_load_balancer_instances_table_health_monitor_delete' | translate}}"
                                    oui-tooltip="{{:: 'octavia_load_balancer_instances_table_health_monitor_delete' | translate }}"
                                    data-disabled="$ctrl.isPoolSectionDisabled(listener)"
                                >
                                    <span
                                        class="oui-icon oui-icon-bin"
                                        aria-hidden
                                    ></span>
                                </oui-button>
                            </div>
                        </div>
                        <div
                            data-ng-repeat="instance in listener.instances track by $index"
                            class="row align-items-center mb-2"
                        >
                            <div class="col-6">
                                <oui-select
                                    data-name="select-instance"
                                    data-model="instance.instance"
                                    data-items="$ctrl.instances"
                                    data-match="displayName"
                                    data-searchable
                                    data-placeholder="{{:: 'octavia_load_balancer_instances_table_pools_search_instance' | translate }}"
                                    data-disabled="$ctrl.isPoolSectionDisabled(listener)"
                                >
                                </oui-select>
                            </div>

                            <div class="col-2">
                                <input
                                    class="oui-input"
                                    type="text"
                                    name="select-instance-port"
                                    data-ng-model="instance.port"
                                    data-minlength="1"
                                    data-maxlength="65535"
                                    data-ng-attr-placeholder="Port"
                                    data-ng-disabled="$ctrl.isPoolSectionDisabled(listener)"
                                />
                            </div>

                            <div class="col-2 align-self-end">
                                <oui-button
                                    class="pull-right"
                                    variant="link"
                                    data-aria-label="{{:: 'octavia_load_balancer_instances_table_instance_add' | translate}}"
                                    oui-tooltip="{{:: 'octavia_load_balancer_instances_table_instance_add' | translate }}"
                                    data-disabled="$ctrl.isPoolSectionDisabled(listener)"
                                    data-on-click="$ctrl.addInstance(listener)"
                                >
                                    <span
                                        class="oui-icon oui-icon-add"
                                        aria-hidden
                                    ></span>
                                </oui-button>
                            </div>

                            <div class="col-2 align-self-end">
                                <oui-button
                                    variant="link"
                                    data-aria-label="{{:: 'octavia_load_balancer_instances_table_instance_add' | translate}}"
                                    oui-tooltip="{{:: 'octavia_load_balancer_instances_table_instance_delete' | translate }}"
                                    data-disabled="$ctrl.isPoolSectionDisabled(listener)"
                                >
                                    <span
                                        class="oui-icon oui-icon-bin"
                                        aria-hidden
                                    ></span>
                                </oui-button>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
