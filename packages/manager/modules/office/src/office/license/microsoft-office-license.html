<div data-ovh-alert="{{alerts.page}}"></div>

<div class="text-center" data-ng-if="MicrosoftOfficeLicenseCtrl.loaders.tenant">
    <oui-spinner data-size="l"></oui-spinner>
</div>

<div data-ng-if="!MicrosoftOfficeLicenseCtrl.loaders.tenant">
    <div class="page-header">
        <strong data-translate="microsoft_office_license_group_name"></strong>
        <div class="mb-3" data-ng-show="!MicrosoftOfficeLicenseCtrl.editMode">
            <div class="d-flex">
                <h1
                    class="d-inline-block mb-0 word-break"
                    data-ng-bind="MicrosoftOfficeLicenseCtrl.license.tenant.displayName"
                ></h1>
                <button
                    class="btn btn-icon my-auto ml-2"
                    type="button"
                    aria-label="{{ 'microsoft_office_license_edit' | translate }}"
                    data-ng-click="MicrosoftOfficeLicenseCtrl.editDisplayName(MicrosoftOfficeLicenseCtrl.license.tenant)"
                    data-ng-if="MicrosoftOfficeLicenseCtrl.license.tenant"
                >
                    <span
                        class="oui-icon oui-icon-pen_concept"
                        aria-hidden="true"
                    ></span>
                </button>
            </div>
            <span
                class="font-italic"
                data-ng-bind="currentLicense"
                data-ng-if="MicrosoftOfficeLicenseCtrl.license.tenant.displayName && currentLicense !== MicrosoftOfficeLicenseCtrl.license.tenant.displayName"
            ></span>
        </div>

        <form
            class="my-4"
            name="form-license-group-name"
            novalidate
            data-ng-show="MicrosoftOfficeLicenseCtrl.editMode"
            data-ng-submit="MicrosoftOfficeLicenseCtrl.saveDisplayName(currentLicense, MicrosoftOfficeLicenseCtrl.license.tenant)"
        >
            <div class="oui-input-group">
                <input
                    type="text"
                    class="oui-input"
                    id="license-group-name"
                    data-ng-model="MicrosoftOfficeLicenseCtrl.newDisplayName.value"
                />
                <button
                    class="oui-button oui-button_s"
                    type="submit"
                    aria-label="{{ 'microsoft_office_license_edit_save' | translate }}"
                    data-ng-disabled="form-license-group-name.$invalid"
                >
                    <span class="fa fa-check" aria-hidden="true"></span>
                </button>
                <button
                    class="oui-button oui-button_s"
                    type="button"
                    aria-label="{{ 'common_cancel' | translate }}"
                    data-ng-click="MicrosoftOfficeLicenseCtrl.resetDisplayName($event)"
                >
                    <span class="fa fa-remove" aria-hidden="true"></span>
                </button>
            </div>
        </form>
    </div>

    <div data-ng-controller="MicrosoftOfficeLicenseTabsCtrl">
        <wuc-ovh-tabs
            tabs="tabs"
            selected-tab="selectedTab"
            change-tab="setSelectedTab"
            product="microsoftOfficeLicense"
            tr="tr"
        ></wuc-ovh-tabs>
        <div class="tab-content">
            <div data-ovh-alert="{{alerts.tabs}}"></div>
            <div
                class="tab-pane active"
                data-ng-include="'microsoft/office/license/' + toKebabCase(selectedTab) + '/' + selectedTab + '.html' || ''"
            ></div>
        </div>
    </div>

    <div id="currentAction" class="modal fade currentAction" role="dialog">
        <div class="modal-dialog">
            <div
                id="modal-container"
                class="modal-content"
                data-ng-include="MicrosoftOfficeLicenseCtrl.stepPath"
            ></div>
            <div id="modal-help" class="help4wizards"></div>
        </div>
    </div>
</div>
