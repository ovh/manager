import React from 'react';
import { useTranslation } from 'react-i18next';
{{#if this.pimID}}
import { useQueries, UseQueryResult } from '@tanstack/react-query';
import { getPIMService } from '@/api';
{{/if}}
import useGuideUtils from '@/components/GuideLink/guide-utils';
import { OnboardingLayout } from '@/components/layout-helpers/Onboarding';
import { ManagerTile, ManagerTileType } from '@/components/ManagerTile';
import onboardingImgSrc from './onboarding-img.png';
import './index.scss';

export default function Onboarding() {
  const { t } = useTranslation('{{appName}}/onboarding');
  {{#if this.pimID}}
  const pimService: UseQueryResult<any> = useQueries({
    queries: [
      { queryKey: ['pimService'], queryFn: getPIMService, staleTime: Infinity },
    ],
  })[0] as UseQueryResult<any>;
  {{/if}}
  const link = useGuideUtils();

  const tileList = [
    {
      title: t('guide1Title'),
      description: t('guide1Description'),
      href: link?.['guideLink1'],
    },
    {
      title: t('guide2Title'),
      description: t('guide2Description'),
      href: link?.['guideLink2']
    },
    {
      title: t('guide3Title'),
      description: t('guide3Description'),
      href: link?.['guideLink3']
    },
  ];

  const title: string = {{#if this.pimID}}pimService.data?.name?pimService.data?.name:t('title'){{else}}t('title'){{/if}};
  const description: string = {{#if this.pimID}}pimService.data?.description?pimService.data?.description:t('title'){{else}}t('description'){{/if}};

  return (
    <OnboardingLayout
      title={title}
      imageSrc={onboardingImgSrc}
      description={description}
      orderButtonLabel={t('orderButtonLabel')}
      orderHref={t('orderButtonLink')}
      moreInfoButtonLabel={t('moreInfoButtonLabel')}
      moreInfoHref={t('moreInfoButtonLink')}
    >
      <aside className="tile-grid">
        {tileList.map((tile) => (
          <ManagerTile
            key={tile.title}
            tileType={ManagerTileType.tutorial}
            moreLabel={t('guideFindOutMoreLinkLabel')}
            {...tile}
          />
        ))}
      </aside>
    </OnboardingLayout>
  );
}
