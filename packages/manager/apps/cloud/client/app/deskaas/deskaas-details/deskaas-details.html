<div ui-view class="cui-page">
    <header class="oui-header">
        <div class="oui-header__container">
            <div class="oui-header__content">
                <oui-spinner
                    data-size="m"
                    data-ng-if="$ctrl.flags.init.details"
                ></oui-spinner>
                <h1
                    class="oui-header__title"
                    data-ng-if="!$ctrl.flags.init.details"
                    data-ng-bind="$ctrl.details.alias !== 'noAlias' ? $ctrl.details.alias : $ctrl.details.serviceName"
                ></h1>
                <h2
                    class="oui-header__description"
                    data-ng-if="!$ctrl.flags.init.details"
                    data-ng-bind="$ctrl.details.alias !== 'noAlias' ? $ctrl.details.serviceName :''"
                ></h2>
            </div>
        </div>
    </header>
    <div>
        <cui-message-container
            data-messages="$ctrl.messages"
        ></cui-message-container>
    </div>
    <section class="container-fluid cui-page__content cui-page__content-flex">
        <div class="row d-lg-flex">
            <div class="col-xm-12 col-md-4">
                <oui-tile
                    data-heading="{{::'common_tile_shortcut' | translate}}"
                    class="h-100 oui-tile-h-100"
                >
                    <div class="oui-tile__item oui-tile__item_button">
                        <button
                            type="button"
                            class="oui-tile__button oui-button oui-button_icon-right oui-button_ghost oui-button_block"
                            data-ng-disabled="!$ctrl.actions.restart.isAvailable()"
                            data-ng-click="$ctrl.actions.restart.callback()"
                        >
                            <span
                                data-ng-bind="::$ctrl.actions.restart.text"
                            ></span>
                            <i
                                class="oui-icon oui-icon-chevron-right"
                                aria-label="{{::$ctrl.actions.restart.text}}"
                            ></i>
                        </button>
                    </div>
                    <div class="oui-tile__item oui-tile__item_button">
                        <button
                            type="button"
                            class="oui-tile__button oui-button oui-button_icon-right oui-button_ghost oui-button_block"
                            data-ng-disabled="!$ctrl.actions.changePassword.isAvailable()"
                            data-ng-click="$ctrl.actions.changePassword.callback()"
                        >
                            <span
                                data-ng-bind="::$ctrl.actions.changePassword.text"
                            ></span>
                            <i
                                class="oui-icon oui-icon-chevron-right"
                                aria-label="{{::$ctrl.actions.changePassword.text}}"
                            ></i>
                        </button>
                    </div>
                    <div class="oui-tile__item oui-tile__item_button">
                        <button
                            type="button"
                            class="oui-tile__button oui-button oui-button_icon-right oui-button_ghost oui-button_block"
                            data-ng-disabled="!$ctrl.actions.accessConsole.isAvailable()"
                            data-ng-click="$ctrl.actions.accessConsole.callback()"
                        >
                            <span
                                data-ng-bind="::$ctrl.actions.accessConsole.text"
                            ></span>
                            <i
                                class="oui-icon oui-icon-chevron-right"
                                aria-label="{{::$ctrl.actions.accessConsole.text}}"
                            ></i>
                        </button>
                    </div>
                    <div class="oui-tile__item oui-tile__item_button">
                        <button
                            type="button"
                            class="oui-tile__button oui-button oui-button_icon-right oui-button_ghost oui-button_block"
                            data-ng-disabled="!$ctrl.actions.reinit.isAvailable()"
                            data-ng-click="$ctrl.actions.reinit.callback()"
                        >
                            <span
                                data-ng-bind="::$ctrl.actions.reinit.text"
                            ></span>
                            <i
                                class="oui-icon oui-icon-chevron-right"
                                aria-label="{{::$ctrl.actions.reinit.text}}"
                            ></i>
                        </button>
                    </div>
                    <div class="oui-tile__item oui-tile__item_button">
                        <button
                            type="button"
                            class="oui-tile__button oui-button oui-button_icon-right oui-button_ghost oui-button_block"
                            data-ng-disabled="!$ctrl.actions.changeOffer.isAvailable()"
                            data-ng-click="$ctrl.actions.changeOffer.callback()"
                        >
                            <span
                                data-ng-bind="::$ctrl.actions.changeOffer.text"
                            ></span>
                            <i
                                class="oui-icon oui-icon-chevron-right"
                                aria-label="{{::$ctrl.actions.changeOffer.text}}"
                            ></i>
                        </button>
                    </div>
                    <div class="oui-tile__item oui-tile__item_button">
                        <button
                            type="button"
                            class="oui-tile__button oui-button oui-button_icon-right oui-button_ghost oui-button_block"
                            data-ng-disabled="!$ctrl.actions.remove.isAvailable()"
                            data-ng-click="$ctrl.actions.remove.callback()"
                        >
                            <span
                                data-ng-bind="::$ctrl.actions.remove.text"
                            ></span>
                            <i
                                class="oui-icon oui-icon-chevron-right"
                                aria-label="{{::$ctrl.actions.remove.text}}"
                            ></i>
                        </button>
                    </div>
                </oui-tile>
            </div>
            <div class="col-xm-12 col-md-4">
                <oui-tile
                    data-heading="{{::'common_tile_subscription' | translate}}"
                    data-loading="$ctrl.flags.init.serviceInfos || $ctrl.flags.init.details"
                    class="h-100 oui-tile-h-100"
                >
                    <oui-tile-definition
                        data-ng-if="$ctrl.flags.init.serviceInfos || $ctrl.flags.init.details"
                    >
                        <oui-tile-description>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                        </oui-tile-description>
                    </oui-tile-definition>
                    <div
                        data-ng-if="!($ctrl.flags.init.serviceInfos || $ctrl.flags.init.details)"
                    >
                        <oui-tile-definition
                            data-ng-if="$ctrl.services.offer"
                            data-term="{{::'common_tile_subscription_offer' | translate}}"
                            data-description="{{$ctrl.services.offer}}"
                        >
                            <oui-action-menu
                                data-compact
                                data-ng-if="$ctrl.actions.changeOffer.isAvailable()"
                                data-placement="end"
                            >
                                <oui-action-menu-item
                                    aria-label="{{::$ctrl.actions.changeOffer.text}}"
                                    data-on-click="$ctrl.actions.changeOffer.callback()"
                                    ><span
                                        data-ng-bind="::$ctrl.actions.changeOffer.text"
                                    ></span>
                                </oui-action-menu-item>
                            </oui-action-menu>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{($ctrl.services.renew.forced || $ctrl.services.renew.automatic) ? 'common_tile_subscription_autorenew' : 'common_tile_subscription_expiration_date' | translate}}"
                            data-description="{{$ctrl.services.expiration | cucMomentFormat:'LL'}}"
                        >
                            <oui-action-menu
                                data-compact
                                data-ng-if="$ctrl.actions.manageAutorenew.isAvailable()"
                                data-placement="end"
                            >
                                <oui-action-menu-item
                                    aria-label="{{::$ctrl.actions.manageAutorenew.text}}"
                                    data-href="{{$ctrl.actions.manageAutorenew.href}}"
                                    data-external
                                    ><span
                                        data-ng-bind="::$ctrl.actions.manageAutorenew.text"
                                    ></span>
                                </oui-action-menu-item>
                            </oui-action-menu>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'common_tile_subscription_contact' | translate}}"
                        >
                            <oui-tile-description>
                                <span
                                    data-ng-bind="$ctrl.services.contactAdmin"
                                ></span>
                                <small
                                    data-translate="common_tile_subscription_contact_admin"
                                ></small>
                            </oui-tile-description>
                            <oui-tile-description>
                                <div>
                                    <span
                                        data-ng-bind="$ctrl.services.contactBilling"
                                    ></span>
                                    <small
                                        data-translate="common_tile_subscription_contact_billing"
                                    ></small>
                                </div>
                            </oui-tile-description>
                            <oui-tile-description>
                                <div>
                                    <span
                                        data-ng-bind="$ctrl.services.contactTech"
                                    ></span>
                                    <small
                                        data-translate="common_tile_subscription_contact_technical"
                                    ></small>
                                </div>
                            </oui-tile-description>
                            <oui-action-menu
                                data-compact
                                data-ng-if="$ctrl.actions.manageContact.isAvailable()"
                                data-placement="end"
                            >
                                <oui-action-menu-item
                                    aria-label="{{::$ctrl.actions.manageContact.text}}"
                                    data-href="{{::$ctrl.actions.manageContact.href}}"
                                    data-external
                                    ><span
                                        data-ng-bind="::$ctrl.actions.manageContact.text"
                                    ></span>
                                </oui-action-menu-item>
                            </oui-action-menu>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'common_tile_subscription_creation_date' | translate}}"
                            data-description="{{$ctrl.services.creation | cucMomentFormat:'LL'}}"
                        >
                        </oui-tile-definition>
                    </div>
                </oui-tile>
            </div>
            <div class="col-xm-12 col-md-4">
                <oui-tile
                    data-heading="{{::'common_tile_infos' | translate}}"
                    data-loading="$ctrl.flags.initializing()"
                    class="h-100 oui-tile-h-100"
                >
                    <oui-tile-definition
                        data-ng-if="$ctrl.flags.initializing()"
                    >
                        <oui-tile-description>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                        </oui-tile-description>
                    </oui-tile-definition>
                    <div data-ng-if="!($ctrl.flags.initializing())">
                        <oui-tile-definition
                            data-term="{{::'common_tile_information_status' | translate}}"
                            data-description="{{$ctrl.services.status}}"
                        >
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'vdi_label_username' | translate}}"
                            data-description="{{$ctrl.user.name}}"
                        >
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'vdi_label_email' | translate}}"
                            data-description="{{$ctrl.user.email}}"
                        >
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'vdi_label_ip' | translate}}"
                        >
                            <oui-tile-description>
                                <oui-clipboard
                                    data-model="$ctrl.details.ip"
                                ></oui-clipboard>
                            </oui-tile-description>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'vdi_label_connection' | translate}}"
                        >
                            <oui-tile-description>
                                <a
                                    data-ng-href="{{ $ctrl.details.url }}"
                                    data-ng-bind="$ctrl.details.url"
                                    target="_blank"
                                    rel="noopener"
                                ></a>
                            </oui-tile-description>
                        </oui-tile-definition>
                    </div>
                </oui-tile>
            </div>
        </div>
        <div class="row d-lg-flex">
            <div class="col-xm-12 col-md-4">
                <oui-tile
                    data-heading="{{::'common_tile_configuration' | translate}}"
                    data-loading="$ctrl.flags.initializing()"
                    class="h-100 oui-tile-h-100"
                >
                    <oui-tile-definition
                        data-ng-if="$ctrl.flags.initializing()"
                    >
                        <oui-tile-description>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                            <oui-skeleton data-randomized></oui-skeleton>
                        </oui-tile-description>
                    </oui-tile-definition>
                    <div data-ng-if="!($ctrl.flags.initializing())">
                        <oui-tile-definition
                            data-term="{{::'vdi_label_alias' | translate}}"
                            data-description="{{$ctrl.details.displayName}}"
                        >
                            <oui-action-menu
                                data-compact
                                data-ng-if="$ctrl.actions.changeAlias.isAvailable()"
                                data-placement="end"
                            >
                                <oui-action-menu-item
                                    aria-label="{{::$ctrl.actions.changeAlias.text}}"
                                    data-on-click="$ctrl.actions.changeAlias.callback()"
                                    ><span
                                        data-ng-bind="$ctrl.actions.changeAlias.text"
                                    ></span>
                                </oui-action-menu-item>
                            </oui-action-menu>
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'vdi_label_os' | translate}}"
                            data-description="{{$ctrl.details.os}}"
                        >
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'vdi_label_vcpu' | translate}}"
                            data-description="{{$ctrl.details.vcpu}}"
                        >
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'vdi_label_ram' | translate}}"
                            data-description="{{$ctrl.details.ram.value + ' ' + $ctrl.details.ram.unit}}"
                        >
                        </oui-tile-definition>
                        <oui-tile-definition
                            data-term="{{::'vdi_label_data' | translate}}"
                            data-description="{{$ctrl.details.dataDisk.value + ' ' + $ctrl.details.dataDisk.unit}}"
                        >
                        </oui-tile-definition>
                    </div>
                </oui-tile>
            </div>
            <div class="col-xm-12 col-md-8">
                <oui-tile
                    data-heading="{{::'vdi_task_current' | translate}}"
                    class="h-100 oui-tile-h-100"
                >
                    <oui-datagrid data-rows="$ctrl.tasksHandler.cleanTasks">
                        <oui-datagrid-column
                            data-title="::'vdi_task_id' | translate"
                            data-property="taskId"
                            data-sortable="asc"
                        ></oui-datagrid-column>
                        <oui-datagrid-column
                            data-title="::'vdi_task_name' | translate"
                            data-property="displayName"
                            data-sortable
                        ></oui-datagrid-column>
                        <oui-datagrid-column
                            data-title="::'vdi_task_state' | translate"
                            data-property="displayState"
                            data-sortable
                        ></oui-datagrid-column>
                        <oui-datagrid-column
                            data-title="::'vdi_task_modification_date' | translate"
                            data-property="lastModificationDate"
                            data-sortable
                        >
                            {{ $row.lastModificationDate | cucMomentFormat:'LLL'
                            }}
                        </oui-datagrid-column>
                        <oui-datagrid-column
                            data-title="'common_progress' | translate"
                            data-property="progress"
                            data-sortable
                            class="oui-datagrid__cell_component"
                        >
                            <oui-progress data-compact>
                                <oui-progress-bar
                                    data-type="{{ $ctrl.ServiceHelper.constructor.getTaskProgressType($row.status) }}"
                                    data-value="$row.progress"
                                >
                                </oui-progress-bar>
                            </oui-progress>
                        </oui-datagrid-column>
                    </oui-datagrid>
                </oui-tile>
            </div>
        </div>
    </section>
</div>
