<div class="cui-page__content">
    <oui-back-button
        data-on-click="$ctrl.$state.go('dbaas.metrics.detail.token')"
        ><span data-translate="metrics_token_add_token"></span>
    </oui-back-button>

    <form name="MetricsTokenAddForm" data-ng-submit="$ctrl.confirm()">
        <div class="text-center" data-ng-if="$ctrl.loading">
            <oui-spinner data-size="l"></oui-spinner>
        </div>
        <div data-ng-if="!$ctrl.loading">
            <oui-field label="{{'metrics_token_add_name' | translate }}">
                <div class="oui-field-control oui-field-control_4">
                    <input
                        class="oui-input"
                        type="text"
                        id="description"
                        name="description"
                        data-ng-model="$ctrl.token.description"
                    />
                </div>
            </oui-field>

            <oui-field label="{{'metrics_token_add_permission' | translate }}">
                <div class="oui-field-control oui-field-control_5">
                    <oui-radio-toggle-group data-model="$ctrl.token.permission">
                        <oui-radio
                            data-ng-repeat="permission in $ctrl.permissions"
                            value="permission.value"
                            ><span data-ng-bind="permission.text"></span>
                        </oui-radio>
                    </oui-radio-toggle-group>
                </div>
            </oui-field>

            <oui-field label="{{'metrics_token_add_labels' | translate }}">
                <div
                    class="oui-field-control oui-field-control_5"
                    data-ng-repeat="label in $ctrl.token.labels"
                >
                    <div class="metrics-token-add__labels">
                        <div
                            class="metrics-token-add__labels-item oui-input-formfield"
                        >
                            <input
                                class="oui-input"
                                type="text"
                                data-ng-model="label.key"
                                name="key"
                            />
                            <label
                                class="oui-label metrics-token-add__labels-item-label"
                                for="key"
                                data-translate="metrics_token_add_labels_key"
                            ></label>
                        </div>
                        <div
                            class="metrics-token-add__labels-item oui-input-formfield"
                        >
                            <input
                                class="oui-input"
                                type="text"
                                data-ng-model="label.value"
                                name="value"
                            />
                            <label
                                class="oui-label metrics-token-add__labels-item-label"
                                for="value"
                                data-translate="metrics_token_add_labels_value"
                            ></label>
                        </div>
                        <div
                            class="metrics-token-add__labels-item metrics-token-add__labels-item-action"
                        >
                            <div data-ng-show="$last">
                                <button
                                    class="oui-button oui-button_secondary"
                                    data-ng-click="$ctrl.addLabel()"
                                    type="button"
                                >
                                    +
                                </button>
                            </div>
                            <div data-ng-show="!$last">
                                <button
                                    class="oui-button oui-button_secondary"
                                    data-ng-click="$ctrl.removeLabel(label)"
                                    type="button"
                                >
                                    -
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </oui-field>

            <oui-form-actions
                data-on-cancel="$ctrl.constructor.cancel()"
                data-submit-text="{{'metrics_token_add_confirmation' | translate}}"
                data-cancel-text="{{'metrics_token_cancel' | translate}}"
                data-disabled="MetricsTokenAddForm.$invalid || $ctrl.loading"
            ></oui-form-actions>
        </div>
    </form>
</div>
