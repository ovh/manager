<div class="widget-presentation">
    <h2
        class="widget-presentation-title"
        data-translate="xdsl_access_comfort_exchange_title"
    ></h2>

    <tuc-toast-message></tuc-toast-message>

    <div data-ng-if="$ctrl.openedRMAs.length > 0" class="mb-3">
        <span
            data-translate="xdsl_access_comfort_exchange_already_opened_rma"
        ></span>
        <div data-ng-repeat="rma in $ctrl.rmas track by $index">
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_rma_status"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="rma.status"
                ></span>
            </div>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_rma_creation_date"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="rma.creationDateTime | date: 'short'"
                ></span>
            </div>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_rma_new_merchandise"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="rma.newMerchandise"
                ></span>
            </div>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_rma_reference"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="rma.id"
                ></span>
            </div>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_rma_equipment_reference"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="rma.equipmentReference"
                ></span>
            </div>
        </div>
    </div>

    <div data-ng-if="!$ctrl.openedRMAs.length > 0" class="mb-3">
        <div data-ng-if="!$ctrl.exchange.isSuccess">
            <oui-message type="warning">
                <p
                    data-translate="xdsl_access_comfort_exchange_warning_part1"
                ></p>
                <p
                    data-translate="xdsl_access_comfort_exchange_warning_part2"
                ></p>
            </oui-message>
            <!-- CONTACT CHOICE -->
            <div class="row">
                <div class="contact-choice col-xs-12 col-md-6">
                    <h3
                        data-translate="xdsl_access_comfort_exchange_shipping_contact"
                        class="mb-3"
                    ></h3>

                    <ovh-contact
                        data-ng-model="$ctrl.shipping"
                        data-ovh-contact-choice-options="$ctrl.ovhContactOptions"
                        data-ovh-contact-init-deferred="$ctrl.contactDeferred"
                    >
                        <div class="text-center">
                            <oui-spinner></oui-spinner>
                        </div>
                    </ovh-contact>
                </div>
            </div>
            <!-- CONTACT CHOICE -->

            <div class="row">
                <div class="col-md-8 mt-2 mb-3">
                    <div
                        class="mb-2"
                        data-translate="xdsl_access_comfort_exchange_confirm_title"
                    ></div>
                    <div
                        class="mb-2"
                        data-translate="xdsl_access_comfort_exchange_confirm_subtitle"
                    ></div>

                    <oui-button
                        data-variant="primary"
                        data-ng-disabled="$ctrl.isAvailable"
                        data-ng-click="$ctrl.comfortExchange()"
                    >
                        <span data-translate="xdsl_modem_exchange"></span>
                    </oui-button>
                </div>
            </div>
        </div>

        <div data-ng-if="$ctrl.exchange.isSuccess">
            <h3 data-translate="xdsl_access_comfort_exchange_bc_title"></h3>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_bc_number"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="$ctrl.exchange.order.orderId"
                ></span>
            </div>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_bc_date"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="($ctrl.exchange.order.date | date: 'dd/MM/yyyy HH:mm:ss' )"
                ></span>
            </div>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_price_without_tax"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="$ctrl.exchange.order.priceWithoutTax.text"
                ></span>
            </div>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_tax"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="$ctrl.exchange.order.tax.text"
                ></span>
            </div>
            <div class="row">
                <span
                    class="col-sm-3 oui-tile__term"
                    data-translate="xdsl_access_comfort_exchange_price_with_tax"
                ></span>
                <span
                    class="col-sm-4 oui-tile__description"
                    data-ng-bind="$ctrl.exchange.order.priceWithTax.text"
                ></span>
            </div>

            <a
                target="_blank"
                class="oui-button oui-button_primary"
                rel="noopener"
                data-ng-href="{{:: $ctrl.exchange.order.url }}"
            >
                <span
                    data-translate="xdsl_access_comfort_exchange_bc_link"
                ></span>
                <span
                    class="oui-icon oui-icon-external-link"
                    aria-hidden="true"
                ></span>
                <span
                    class="sr-only"
                    data-translate="xdsl_access_comfort_exchange_link_in_new_tab"
                ></span>
            </a>
        </div>
    </div>
</div>
