<oui-message
    ng-if="!$ctrl.isLoading && $ctrl.constants.NS_UPDATE_RESULT.SUCCESS === $ctrl.nsUpdateStatus"
    type="success"
>
    {{ ::'domain_dns_update_success_message' | translate }}
</oui-message>

<oui-message
    ng-if="!$ctrl.isLoading && $ctrl.constants.NS_UPDATE_RESULT.SAME === $ctrl.nsUpdateStatus"
    type="success"
>
    {{ ::'domain_dns_update_same_message' | translate }}
</oui-message>

<div class="row">
    <div class="col-md-9">
        <div ng-if="$ctrl.isLoading" class="text-center">
            <oui-spinner size="l" />
        </div>

        <div ovh-alert="{{alerts.main}}"></div>

        <div ng-if="!$ctrl.isLoading && $ctrl.dns.nameServers">
            <oui-message ng-if="$ctrl.displayPropagationInfo" type="success">
                {{ ::"domain_tab_DNS_update_success" | translate }}
            </oui-message>

            <oui-message
                ng-if="!$ctrl.dns.isUpdatingNameServers && $ctrl.dns.nameServers.length === 1"
                type="warning"
            >
                {{ ::"domain_tab_DNS_warning_only_one_dns" | translate }}
            </oui-message>

            <oui-message type="info">
                <span>
                    {{ ::"domain_tab_DNS_unlock_warning_manuel_check" |
                    translate }}
                </span>
                <a
                    ng-href="{{ $ctrl.urls.zoneCheck }}"
                    title="{{ ::'domain_tab_DNS_unlock_warning_manuel_check_tool' | translate }}"
                    target="_blank"
                >
                    <span>
                        {{ ::"domain_tab_DNS_unlock_warning_manuel_check2" |
                        translate }}
                    </span>
                    <span class="fa fa-external-link" aria-hidden="true"></span>
                </a>
            </oui-message>

            <oui-datagrid
                page-size="8"
                rows="$ctrl.dns.nameServers"
                pagination-mode="arrows"
            >
                <oui-datagrid-column
                    title="::'domain_tab_DNS_name' | translate"
                >
                    <span>{{ ::$row.name }}</span>
                </oui-datagrid-column>

                <oui-datagrid-column title="::'domain_tab_DNS_ip' | translate">
                    <span>{{ ::$row.ip || "-" }}</span>
                </oui-datagrid-column>

                <oui-datagrid-column
                    title="::'domain_tab_DNS_state' | translate"
                >
                    <span
                        class="oui-badge"
                        ng-class="::{
                            'oui-badge_info': $row.status === $ctrl.constants.DNS_STATUS.ADDING,
                            'oui-badge_warning': $row.status === $ctrl.constants.DNS_STATUS.DELETING,
                            'oui-badge_success': $row.status === $ctrl.constants.DNS_STATUS.ACTIVATED
                        }"
                    >
                        {{ ::'domain_tab_DNS_state_' + $row.status | translate
                        }}
                    </span>
                </oui-datagrid-column>

                <oui-datagrid-column title="::'domain_dns_type' | translate">
                    <span class="oui-badge">
                        {{ ::'domain_dns_type_' + $row.type | translate }}
                    </span>

                    <button
                        ng-if="$row.type === $ctrl.constants.DNS_TYPE.STANDARD && $row.status !== $ctrl.constants.DNS_STATUS.DELETING"
                        type="button"
                        class="oui-popover-button"
                        oui-popover="{{ ::'domain_dns_type_standard_tooltip' | translate }}"
                        oui-popover-placement="right"
                    ></button>
                </oui-datagrid-column>
            </oui-datagrid>
        </div>
    </div>

    <div class="col-md-3 mt-5 mt-lg-0">
        <div ng-if="$ctrl.dns.nameServers" class="mb-5">
            <button
                type="button"
                class="btn btn-block btn-default"
                ng-click="$ctrl.dns.isAnycastSubscribed ? $ctrl.goToTerminateAnycast() : $ctrl.goToDnsAnycast()"
                track-on="click"
                track-name="web::domain::server-dns::activation-dns-anycast"
                track-click="action"
            >
                {{ $ctrl.dns.isAnycastSubscribed ?
                'domain_configuration_dnsanycast_terminate_button' :
                'domain_configuration_dnsanycast_activate_button' | translate }}
            </button>
            <button
                type="button"
                class="btn btn-block btn-default"
                ng-click="$ctrl.goToDnsModify()"
            >
                {{ 'domain_configuration_dns_config' | translate }}
            </button>
        </div>

        <div
            wuc-guides
            wuc-guides-title="::'guide_domain_subtitle' | translate"
            wuc-guides-list="'dns'"
            tr="tr"
        ></div>
    </div>
</div>
