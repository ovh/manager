<div data-translate-namespace="hosting_cdn_order">
    <oui-back-button
        data-on-click="$ctrl.goBack()">
        <span data-translate=".title"></span>
    </oui-back-button>

    <div class="text-center" data-ng-if="$ctrl.loading">
        <oui-spinner></oui-spinner>
    </div>

    <div data-ng-if="!$ctrl.loading">
        <p data-translate=".description"></p>

        <oui-stepper
            data-current-index="$ctrl.currentIndex"
            data-on-finish="$ctrl.checkout()">
            <oui-step-form
                data-header="{{:: translateNamespace + '.step_header_duration' | translate }}"
                data-editable="$ctrl.isEditable && !$ctrl.checkoutLoading"
                data-on-focus="$ctrl.resetCart()">

                <!-- Durations -->
                <oui-field>
                    <oui-radio
                        name="interval"
                        data-ng-repeat="pricing in ::$ctrl.catalogAddon.pricings track by $index"
                        data-model="$ctrl.interval"
                        data-value="pricing.interval"
                        data-required>
                        <span data-ng-bind=":: '' + pricing.interval | wucDuration:'longDate'"></span>&nbsp;:&nbsp;
                        <order-catalog-price
                            data-price="pricing.price"
                            data-tax="pricing.tax"
                            data-user="$ctrl.user">
                        </order-catalog-price>
                    </oui-radio>
                </oui-field>
            </oui-step-form>
            <oui-step-form
                name="checkout"
                data-header="{{:: translateNamespace + ($ctrl.isOptionFree ? '.step_header_activation' : '.step_header_payment') | translate }}"
                data-description="{{:: translateNamespace + ($ctrl.isOptionFree ? '.step_description_activation' : '.step_description_payment') | translate }}"
                data-submit-text="{{:: translateNamespace + ($ctrl.isOptionFree ? '.submit_activate' : '.submit_pay') | translate }}"
                data-cancel-text="{{:: translateNamespace + '.cancel' | translate }}"
                data-editable="::false"
                data-loading="$ctrl.checkoutLoading"
                data-valid="$ctrl.agreeContracts"
                data-on-focus="$ctrl.prepareCheckout()"
                data-on-cancel="$ctrl.goBack()"
                data-prevent-next>

                <!-- Payment Means -->
                <order-payment-means
                    name="paymentMean"
                    data-ng-if="::!$ctrl.isOptionFree"
                    data-default-payment-mean="$ctrl.defaultPaymentMean"
                    data-model="$ctrl.autoPayWithPreferredPaymentMethod">
                </order-payment-means>

                <!-- Contracts -->
                <order-contracts
                    name="agreeContracts"
                    data-ng-if="$ctrl.cart"
                    data-items="$ctrl.cart.contracts"
                    data-model="$ctrl.agreeContracts">
                </order-contracts>
            </oui-step-form>
        </oui-stepper>
    </div>
</div>
