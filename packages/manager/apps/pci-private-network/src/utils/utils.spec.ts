import {
  getAutoGeneratedName,
  getDefaultCIDR,
  getNextAvailableVlanId,
} from './utils';

describe('getAutoGeneratedName', () => {
  it('should return auto generated name with prefix', () => {
    const result = getAutoGeneratedName('prefix');
    expect(result).toMatch(/^prefix-\d+-.{5}$/);
  });

  it('should return auto generated name without prefix', () => {
    const result = getAutoGeneratedName();
    expect(result).toMatch(/^\d+-.{5}$/);
  });
});

describe('getNextAvailableVlanId', () => {
  it.each([
    { allocatedIds: [1, 2, 100], expected: 3 },
    { allocatedIds: [1, 2, 3, 4, 1100], expected: 5 },
    { allocatedIds: [], expected: 1 },
  ])(
    'should return $expected from possible VLAN ID values when $allocatedIds are allocated ',
    ({ allocatedIds, expected }) => {
      expect(getNextAvailableVlanId(allocatedIds)).toBe(expected);
    },
  );
});

describe('getDefaultCIDR', () => {
  it.each([
    [256, '10.1.0.0/16'],
    [511, '10.1.0.0/16'],
    [15, '10.15.0.0/16'],
    [255, '10.0.0.0/16'],
    [0, '10.0.0.0/16'],
  ])(
    'replaces {vlanId} in DEFAULT_CIDR correctly for vlanId %i modulo 255',
    (vlanId, expected) => {
      expect(getDefaultCIDR(vlanId)).toBe(expected);
    },
  );
});
