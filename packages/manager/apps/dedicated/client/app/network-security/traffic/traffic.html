<div>
    <div class="oui-box mt-2 mb-2 d-flex justify-content-between">
        <div class="d-flex">
            <label
                class="oui-label"
                data-translate="network_security_dashboard_display_filter"
            >
            </label>
            <span class="oui-select ml-2">
                <select
                    class="form-control oui-select__input"
                    id="services"
                    data-ng-model="$ctrl.service"
                    data-ng-change="$ctrl.selectService()"
                    data-ng-options="service as service.serviceName group by (('network_security_dashboard_service_' + service.category) | translate) for service in $ctrl.services track by service.serviceName"
                >
                    <option
                        value=""
                        data-ng-bind="'network_security_dashboard_service_all' | translate"
                    ></option>
                </select>
            </span>
            <span class="ml-2">
                <input
                    class="oui-input form-control"
                    type="text"
                    id="selectSubnet"
                    name="ip"
                    data-ui-validate="'$ctrl.checkSelectedSubnet($value)'"
                    data-uib-typeahead="ip as ip.ipBlock for ip in $ctrl.getIps($viewValue)"
                    data-uib-typeahead-loading="$ctrl.loaderIp"
                    data-ng-model="$ctrl.selectedIp"
                />
            </span>
        </div>
        <div class="d-flex">
            <label
                class="oui-label mr-2"
                data-translate="network_security_dashboard_period_filter"
            ></label>
            <oui-select
                data-items="$ctrl.periods"
                data-model="$ctrl.period"
                id="periods"
                data-inline
                data-match="label"
                data-on-change="$ctrl.getTraffic()"
            ></oui-select>
        </div>
    </div>
    <div
        data-ng-if="!$ctrl.results"
        class="text-center m-3"
        data-translate="network_security_dashboard_empty_result"
    ></div>
    <div data-ng-if="$ctrl.results">
        <div class="d-flex justify-content-start">
            <div class="oui-box oui-box_light mr-4">
                <h4
                    class="oui-box__heading"
                    data-translate="network_security_dashboard_number_of_events"
                ></h4>
                <p
                    class="oui-heading_5 text-center oui-color-p-500"
                    data-ng-bind="$ctrl.numberOfEvents"
                ></p>
            </div>
            <div class="oui-box oui-box_light mr-4">
                <h4
                    class="oui-box__heading"
                    data-translate="network_security_dashboard_packets_dropped"
                ></h4>
                <p
                    class="oui-heading_5 text-center oui-color-p-500"
                    data-ng-bind="$ctrl.packetsDropped"
                ></p>
            </div>
            <div class="oui-box oui-box_light mr-4">
                <h4
                    class="oui-box__heading"
                    data-translate="network_security_dashboard_bandwith_cleaned"
                ></h4>
                <p
                    class="oui-heading_5 text-center oui-color-p-500"
                    data-ng-bind="$ctrl.bandwithCleaned"
                ></p>
            </div>
            <div class="oui-box oui-box_light mr-4">
                <h4
                    class="oui-box__heading"
                    data-translate="network_security_dashboard_attacks_detected"
                ></h4>
                <p
                    class="oui-heading_5 text-center oui-color-p-500"
                    data-ng-bind="$ctrl.attacksDetected"
                ></p>
            </div>
        </div>
        <div class="d-flex justify-content-end">
            <oui-checkbox
                data-model="$ctrl.isStackable"
                data-on-change="$ctrl.updateStackable(modelValue)"
                class="mr-4"
            >
                <span
                    data-translate="network_security_dashboard_stack_data_series"
                ></span>
            </oui-checkbox>
            <label
                data-translate="network_security_dashboard_data_mode"
                class="mt-1 mr-2"
            >
            </label>
            <label
                data-translate="network_security_dashboard_bps"
                class="mt-1 mr-2"
            >
            </label>
            <oui-switch
                data-model="$ctrl.isPPs"
                data-on-change="$ctrl.loadGraph(modelValue)"
            ></oui-switch>
            <label
                data-translate="network_security_dashboard_pps"
                class="mt-1 ml-2"
            ></label>
        </div>
        <canvas
            id="trafficChart"
            class="chart chart-line"
            width="100%"
            height="30%"
            data-chart-labels="$ctrl.labels"
            data-chart-colors="$ctrl.colors"
            data-chart-series="$ctrl.series"
            data-chart-data="$ctrl.data"
            data-chart-options="$ctrl.options"
        ></canvas>
    </div>
</div>
