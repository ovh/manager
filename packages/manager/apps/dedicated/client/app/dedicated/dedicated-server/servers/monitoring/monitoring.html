<div data-ovh-alert="monitoringAlert"></div>

<oui-back-button
    aria-label="{{ 'server_tab_MONITORING_back' | translate }}"
    on-click="$ctrl.goBack()"
>
    <span data-translate="server_tab_MONITORING_back"></span>
</oui-back-button>

<h2 data-translate="server_tab_MONITORING_services"></h2>

<button
    class="btn btn-default mb-2"
    type="button"
    title="{{ 'server_tab_MONITORING_add' | translate }}"
    data-ng-click="$ctrl.addMode = !$ctrl.addMode"
    data-ng-disabled="$ctrl.editMode"
    data-translate="server_tab_MONITORING_add"
></button>

<!-- Table monitoring -->
<div class="table-responsive">
    <table class="table table-hover">
        <thead>
            <tr>
                <th
                    scope="col"
                    data-translate="server_tab_MONITORING_table_header_ip"
                ></th>
                <th
                    scope="col"
                    data-translate="server_tab_MONITORING_table_header_protocol"
                ></th>
                <th
                    scope="col"
                    data-translate="server_tab_MONITORING_table_header_port"
                ></th>
                <th
                    scope="col"
                    data-translate="server_tab_MONITORING_challenge_text"
                ></th>
                <th
                    scope="col"
                    data-translate="server_tab_MONITORING_table_header_interval"
                ></th>
                <th
                    scope="col"
                    data-translate="server_tab_MONITORING_table_header_url"
                ></th>
                <th
                    scope="col"
                    data-translate="server_tab_MONITORING_table_header_status"
                ></th>
                <th
                    scope="col"
                    data-translate="server_tab_MONITORING_table_header_notifications"
                ></th>
                <th scope="col" colspan="2">
                    <button
                        class="btn btn-link"
                        title="{{ 'server_tab_MONITORING_table_header_refresh' | translate }}"
                        data-ng-click="$ctrl.refreshTableMonitoring()"
                        data-ng-disabled="$ctrl.addMode || $ctrl.editMode"
                    >
                        <span class="fa fa-refresh" aria-hidden="true"></span>
                    </button>
                </th>
            </tr>
        </thead>
        <!-- V3 -->
        <tbody
            data-ng-if="$ctrl.addMode"
            data-ng-controller="MonitoringAddCtrl as ctrlMonitoringAdd"
        >
            <!-- add monitoring -->
            <tr>
                <td colspan="10">
                    <form
                        name="formAddMonitoring"
                        novalidate
                        data-ng-submit="ctrlMonitoringAdd.addMonitoring()"
                    >
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td>
                                        <select
                                            class="form-control"
                                            id="select-monitoring-ip-add"
                                            name="selectIpsAdd"
                                            required
                                            aria-label="{{ 'server_tab_MONITORING_add_ip' | translate }}"
                                            data-ng-options="ip for ip in $ctrl.ips"
                                            data-ng-model="ctrlMonitoringAdd.monitoring.ip"
                                        >
                                        </select>
                                    </td>
                                    <td>
                                        <select
                                            class="form-control"
                                            id="select-monitoring-protocol-add"
                                            name="selectProtocolsAdd"
                                            required
                                            aria-label="{{ 'server_tab_MONITORING_add_protocol' | translate }}"
                                            data-ng-options="protocol for protocol in $ctrl.monitoringProtocolEnum"
                                            data-ng-model="ctrlMonitoringAdd.monitoring.protocol"
                                        >
                                        </select>
                                    </td>
                                    <td>
                                        <input
                                            type="number"
                                            class="form-control"
                                            id="select-monitoring-port"
                                            name="monitoringPort"
                                            required
                                            min="1"
                                            max="65535"
                                            aria-label="{{ 'server_tab_MONITORING_add_port' | translate }}"
                                            data-ng-model="ctrlMonitoringAdd.monitoring.port"
                                            data-ng-pattern="/^[0-9]+$/"
                                            data-oui-tooltip="{{ ::'server_tab_MONITORING_add_port_text_help' | translate }}"
                                        />
                                    </td>
                                    <td>
                                        <input
                                            type="text"
                                            class="form-control"
                                            id="txt-monitoring-challengeText-add"
                                            name="txtChallengeTextAdd"
                                            maxlength="25"
                                            aria-label="{{ 'server_tab_MONITORING_add_challenge_text' | translate }}"
                                            data-ng-model="ctrlMonitoringAdd.monitoring.challengeText"
                                            data-ng-pattern="/^[a-zA-Z0-9\s\.\-=\(\)\\\/;]*$/i"
                                            data-oui-tooltip="{{ ::'server_tab_MONITORING_add_challenge_text_help' | translate }}"
                                            data-oui-tooltip-placement="right"
                                        />
                                        <p
                                            class="text-danger"
                                            data-ng-if="formAddMonitoring.txtChallengeTextAdd.$touched && formAddMonitoring.txtChallengeTextAdd.$error.pattern"
                                            data-ng-bind-html="'server_tab_MONITORING_add_challengeText_invalid' | translate "
                                        ></p>
                                    </td>
                                    <td>
                                        <select
                                            class="form-control"
                                            id="select-monitoring-interval"
                                            name="select-monitoring-interval"
                                            required
                                            aria-label="{{ 'server_tab_MONITORING_add_interval' | translate }}"
                                            data-ng-options="interval for interval in $ctrl.monitoringIntervalEnum"
                                            data-ng-model="ctrlMonitoringAdd.monitoring.interval"
                                        >
                                        </select>
                                    </td>
                                    <td>
                                        <div
                                            data-ng-if="ctrlMonitoringAdd.monitoring.protocol === 'DNS'"
                                        >
                                            <input
                                                type="text"
                                                class="form-control"
                                                name="monitoringUrl"
                                                pattern="^(?:(ftp|http|https):\/\/)?(?:[\w-]+\.)+[a-z]{2,15}$"
                                                aria-label="{{ 'server_tab_MONITORING_add_url' | translate }}"
                                                data-ng-model="ctrlMonitoringAdd.monitoring.url"
                                                data-ng-required="ctrlMonitoringAdd.monitoring.protocol === 'DNS'"
                                            />
                                            <p
                                                class="text-danger"
                                                data-ng-if="formAddMonitoring.monitoringUrl.$touched && !formAddMonitoring.monitoringUrl.$valid"
                                                data-translate="server_tab_MONITORING_add_url_invalid"
                                            ></p>
                                        </div>
                                    </td>
                                    <td></td>
                                    <td data-ng-if="!$ctrl.editMode">
                                        <button
                                            type="button"
                                            class="btn btn-link"
                                            data-ng-if="$ctrl.isAllowedToMonitoringWithSms()"
                                            data-ng-click="ctrlMonitoringAdd.toggle('sms')"
                                        >
                                            <span
                                                class="fa fa-mobile"
                                                aria-hidden="true"
                                            ></span>
                                            <span>+</span>
                                        </button>
                                        <button
                                            type="button"
                                            class="btn btn-link"
                                            data-ng-click="ctrlMonitoringAdd.toggle('email')"
                                        >
                                            <span
                                                class="fa fa-envelope-o"
                                            ></span>
                                            <span>+</span>
                                        </button>
                                    </td>
                                    <td>
                                        <button
                                            type="submit"
                                            class="btn btn-link"
                                            title="{{ 'wizard_confirm' | translate }}"
                                            data-ng-disabled="!formAddMonitoring.$valid"
                                        >
                                            <span
                                                class="fa fa-check"
                                                aria-hidden="true"
                                            ></span>
                                        </button>
                                    </td>
                                    <td>
                                        <button
                                            type="reset"
                                            class="btn btn-link"
                                            title="{{ 'wizard_cancel' | translate }}"
                                            data-ng-click="$ctrl.addMode = false"
                                        >
                                            <span
                                                class="fa fa-times"
                                                aria-hidden="true"
                                            ></span>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                    <div data-ng-if="ctrlMonitoringAdd.show.sms">
                        <div
                            class="form-horizontal mb-4"
                            data-ng-repeat="smsNotification in ctrlMonitoringAdd.smsNotifications"
                            data-ng-form="formSmsNotification"
                        >
                            <div class="form-group">
                                <label
                                    for="select-sms-account{{ $index }}"
                                    class="col-sm-3 control-label"
                                    data-translate="server_tab_MONITORING_notifications_sms_add_sms"
                                >
                                </label>
                                <div class="col-sm-9">
                                    <select
                                        class="form-control"
                                        id="select-sms-account{{ $index }}"
                                        name="select-sms-account{{ $index }}"
                                        data-ng-options="smsAccount.name as smsAccount.name for smsAccount in $ctrl.sms"
                                        data-ng-model="smsNotification.smsAccount"
                                    >
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label
                                    for="phoneNumber{{ $index }}"
                                    class="col-sm-3 control-label"
                                    data-translate="server_tab_MONITORING_notifications_sms_add_phone"
                                >
                                </label>
                                <div class="col-sm-9">
                                    <input
                                        type="tel"
                                        class="form-control"
                                        id="phoneNumber{{$index}}"
                                        data-ng-model="smsNotification.phoneNumberTo"
                                        data-ng-pattern="/^\+(?:[0-9] ?){6,14}[0-9]$/"
                                    />
                                    <p
                                        class="text-danger"
                                        data-ng-if="formSmsNotification.$error.pattern"
                                        data-translate="server_tab_MONITORING_notifications_sms_add_phone_invalid"
                                    ></p>
                                </div>
                            </div>
                            <div
                                class="form-group form-inline"
                                data-ng-form="formSmsNotificationPeriod"
                            >
                                <label
                                    class="col-sm-3 control-label"
                                    data-translate="server_tab_MONITORING_table_notifications_sms_header_from"
                                >
                                </label>
                                <div class="col-sm-9">
                                    <input
                                        type="number"
                                        class="form-control"
                                        min="0"
                                        max="24"
                                        data-ng-model="smsNotification.fromHour"
                                        data-ng-pattern="/[0-9]{1,3}/"
                                    />
                                    <span
                                        data-translate="server_tab_MONITORING_notifications_sms_add_hours"
                                    ></span>
                                    <span
                                        data-translate="server_tab_MONITORING_table_notifications_sms_header_to"
                                    ></span>

                                    <input
                                        type="number"
                                        class="form-control"
                                        min="0"
                                        max="24"
                                        data-ng-model="smsNotification.toHour"
                                        data-ng-pattern="/[0-9]{1,3}/"
                                    />
                                    <span
                                        data-translate="server_tab_MONITORING_notifications_sms_add_hours"
                                    ></span>

                                    <p
                                        class="text-danger"
                                        data-ng-if="formSmsNotificationPeriod.$error.pattern"
                                        data-translate="server_tab_MONITORING_notifications_sms_add_hour_invalid"
                                    ></p>
                                    <p
                                        class="text-danger"
                                        data-ng-if="formSmsNotificationPeriod.$error.min"
                                        data-translate="server_tab_MONITORING_notifications_sms_add_hour_invalid"
                                    ></p>
                                    <p
                                        class="text-danger"
                                        data-ng-if="formSmsNotificationPeriod.$error.max"
                                        data-translate="server_tab_MONITORING_notifications_sms_add_hour_invalid"
                                    ></p>
                                </div>
                            </div>
                            <div class="form-group">
                                <label
                                    for="select-lang-sms{{$index}}"
                                    class="col-sm-3 control-label"
                                    data-translate="server_tab_MONITORING_notifications_email_add_lang"
                                >
                                </label>
                                <div class="col-sm-9">
                                    <select
                                        class="form-control"
                                        id="select-lang-sms{{ $index }}"
                                        name="select-lang-sms{{ $index }}"
                                        data-ng-options="lang as (('language_' + lang) | translate) for lang in $ctrl.languageEnum"
                                        data-ng-model="smsNotification.language"
                                    >
                                    </select>
                                </div>
                            </div>
                            <div class="text-right">
                                <button
                                    class="btn btn-default"
                                    type="button"
                                    data-ng-if="ctrlMonitoringAdd.smsNotifications.length > 1"
                                    data-ng-click="ctrlMonitoringAdd.removeSmsNotification(smsNotification)"
                                    data-translate="server_tab_MONITORING_notification_remove_recipient"
                                ></button>
                            </div>
                        </div>
                        <div class="text-center">
                            <button
                                type="button"
                                class="btn btn-primary"
                                data-ng-click="ctrlMonitoringAdd.addSmsNotification()"
                                data-translate="server_tab_MONITORING_notification_add_recipient"
                            ></button>
                        </div>
                    </div>
                    <div data-ng-if="ctrlMonitoringAdd.show.email">
                        <div
                            class="form-horizontal mb-4"
                            data-ng-repeat="emailNotification in ctrlMonitoringAdd.emailNotifications"
                            data-ng-form="formEmailNotification"
                        >
                            <div class="form-group">
                                <label
                                    for="emailAdd{{ $index }}"
                                    class="col-sm-3 control-label"
                                    data-translate="server_tab_MONITORING_notifications_email_add_email"
                                >
                                </label>
                                <div class="col-sm-9">
                                    <input
                                        type="email"
                                        class="form-control"
                                        id="emailAdd{{ $index }}"
                                        data-ng-model="emailNotification.email"
                                        data-ng-required="emailNotification.language"
                                    />
                                    <p
                                        class="text-danger"
                                        data-ng-if="formEmailNotification.$error.email"
                                        data-translate="server_tab_MONITORING_notifications_email_add_email_invalid"
                                    ></p>
                                </div>
                            </div>
                            <div class="form-group">
                                <label
                                    for="select-lang-add{{ $index }}"
                                    class="col-sm-3 control-label"
                                    data-translate="server_tab_MONITORING_notifications_email_add_lang"
                                >
                                </label>
                                <div class="col-sm-9">
                                    <select
                                        class="form-control"
                                        id="select-lang-add{{ $index }}"
                                        name="select-lang-add{{ $index }}"
                                        data-ng-options="lang as (('language_' + lang) | translate) for lang in $ctrl.languageEnum"
                                        data-ng-model="emailNotification.language"
                                        data-ng-required="emailNotification.email"
                                    >
                                    </select>
                                </div>
                            </div>
                            <div class="text-right">
                                <button
                                    type="button"
                                    class="btn btn-default"
                                    title="{{ 'server_tab_MONITORING_notification_remove_recipient' | translate }}"
                                    data-ng-if="ctrlMonitoringAdd.emailNotifications.length > 1"
                                    data-ng-click="ctrlMonitoringAdd.removeEMailNotification(emailNotification)"
                                    data-translate="server_tab_MONITORING_notification_remove_recipient"
                                ></button>
                            </div>
                        </div>
                        <div class="text-center">
                            <button
                                type="button"
                                class="btn btn-primary"
                                data-ng-click="ctrlMonitoringAdd.addEMailNotification()"
                                data-translate="server_tab_MONITORING_notification_add_recipient"
                            ></button>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody>
        <!-- /V3 -->

        <tbody data-ng-if="$ctrl.loaders.monitorings">
            <!--loader-->
            <tr>
                <td colspan="10">
                    <oui-spinner data-size="s"></oui-spinner>
                </td>
            </tr>
        </tbody>
        <tbody
            data-ng-if="$ctrl.monitoringServices.length <= 0 && !$ctrl.loaders.monitorings && !$ctrl.addMode"
        >
            <!-- no monitoring -->
            <tr>
                <td
                    colspan="10"
                    class="text-center"
                    data-translate="server_tab_MONITORING_table_empty"
                ></td>
            </tr>
        </tbody>
        <tbody
            data-ng-if="$ctrl.monitoringServices.length > 0 && !$ctrl.loaders.monitorings"
        >
            <!-- monitoring services -->
            <tr
                data-ng-repeat="monitoring in $ctrl.monitoringServices track by $index"
            >
                <!-- Read Mode  -->
                <td
                    data-ng-if="$ctrl.editMode !== monitoring.monitoringId"
                    data-ng-bind="::monitoring.ip"
                ></td>
                <td
                    data-ng-if="$ctrl.editMode !== monitoring.monitoringId"
                    data-ng-bind="::monitoring.protocol"
                ></td>
                <td
                    data-ng-if="$ctrl.editMode !== monitoring.monitoringId"
                    data-ng-bind="::monitoring.port"
                ></td>
                <td
                    data-ng-if="$ctrl.editMode !== monitoring.monitoringId"
                    data-ng-bind="::monitoring.challengeText"
                ></td>
                <td
                    data-ng-if="$ctrl.editMode !== monitoring.monitoringId"
                    data-ng-bind="::monitoring.interval"
                ></td>
                <td
                    data-ng-if="$ctrl.editMode !== monitoring.monitoringId"
                    data-ng-bind="::monitoring.url"
                ></td>
                <td data-ng-if="$ctrl.editMode !== monitoring.monitoringId">
                    <button
                        type="button"
                        class="btn btn-link px-0"
                        title="{{ (monitoring.enabled ? 'server_tab_MONITORING_click_disable' : 'server_tab_MONITORING_click_enable') | translate }}"
                        data-ng-click="$ctrl.toggleStatus(monitoring)"
                    >
                        <span
                            class="fa"
                            data-ng-class="{
                                      'fa fa-check': monitoring.enabled,
                                      'fa fa-remove': !monitoring.enabled
                                  }"
                        >
                        </span>
                        <span
                            data-ng-bind="('server_tab_MONITORING_state_' + monitoring.enabled | translate) || monitoring.enabled"
                        ></span>
                    </button>
                </td>
                <td data-ng-if="$ctrl.editMode !== monitoring.monitoringId">
                    <div class="row">
                        <div
                            class="col-xs-6"
                            data-ng-if="$ctrl.isAllowedToMonitoringWithSms()"
                        >
                            <button
                                type="button"
                                class="btn btn-link"
                                data-ng-click="($ctrl.editMode = monitoring.monitoringId) && $ctrl.toggleEditModePart('sms', true)"
                            >
                                <span
                                    class="fa fa-mobile"
                                    aria-hidden="true"
                                ></span>
                                <span
                                    data-ng-bind="monitoring.smsNotifications.length || 0"
                                ></span>
                            </button>
                        </div>
                        <div class="col-xs-6">
                            <button
                                type="button"
                                class="btn btn-link"
                                data-ng-click="($ctrl.editMode = monitoring.monitoringId) && $ctrl.toggleEditModePart('email', true)"
                            >
                                <span
                                    class="fa fa-envelope-o"
                                    aria-hidden="true"
                                ></span>
                                <span
                                    data-ng-bind="monitoring.emailNotifications.length || 0"
                                ></span>
                            </button>
                        </div>
                    </div>
                </td>
                <td
                    class="text-center"
                    data-ng-if="$ctrl.editMode !== monitoring.monitoringId"
                >
                    <button
                        type="button"
                        class="btn btn-link"
                        title="{{ 'server_tab_MONITORING_table_action_edit' | translate }}"
                        data-ng-click="$ctrl.editMode = monitoring.monitoringId"
                        data-ng-disabled="$ctrl.addMode"
                    >
                        <span
                            class="oui-icon oui-icon-pen_concept"
                            aria-hidden="true"
                        ></span>
                    </button>
                </td>
                <td
                    class="text-center"
                    data-ng-if="$ctrl.editMode !== monitoring.monitoringId"
                >
                    <button
                        type="button"
                        class="btn btn-link"
                        title="{{ 'server_tab_MONITORING_table_action_delete' | translate }}"
                        data-ng-click="$ctrl.dedicatedServer.$scope.setAction('monitoring/delete/dedicated-server-monitoring-delete', monitoring)"
                    >
                        <span
                            class="oui-icon oui-icon-trash_concept"
                            aria-hidden="true"
                        ></span>
                    </button>
                </td>

                <!-- Edit mode  -->
                <td
                    colspan="10"
                    data-ng-if="$ctrl.editMode === monitoring.monitoringId"
                >
                    <form
                        class="form form-pretty"
                        id="formUpdateMonitoring"
                        name="formUpdateMonitoring"
                        novalidate
                        data-ng-controller="MonitoringUpdateCtrl as ctrlMonitoringUpdate"
                        data-ng-init="ctrlMonitoringUpdate.init(monitoring)"
                        data-ng-submit="ctrlMonitoringUpdate.updateMonitoring()"
                    >
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td
                                        class="font-weight-bold"
                                        data-ng-bind="ctrlMonitoringUpdate.monitoring.ip"
                                    ></td>
                                    <td>
                                        <select
                                            class="form-control"
                                            id="select-monitoring-protocol-update"
                                            name="selectProtocolsUpdate"
                                            required
                                            aria-label="{{ 'server_tab_MONITORING_add_protocol' | translate }}"
                                            data-ng-options="protocol for protocol in $ctrl.monitoringProtocolEnum"
                                            data-ng-model="ctrlMonitoringUpdate.monitoring.protocol"
                                        >
                                        </select>
                                    </td>
                                    <td>
                                        <input
                                            type="number"
                                            class="form-control"
                                            id="select-monitoring-port"
                                            name="monitoringPort"
                                            min="1"
                                            max="65535"
                                            required
                                            aria-label="{{ 'server_tab_MONITORING_add_port' | translate }}"
                                            data-ng-model="ctrlMonitoringUpdate.monitoring.port"
                                            data-ng-pattern="/^[0-9]+$/"
                                            data-oui-tooltip="{{ 'server_tab_MONITORING_add_port_text_help' | translate }}"
                                        />
                                    </td>
                                    <td>
                                        <input
                                            type="text"
                                            class="form-control"
                                            id="txt-monitoring-challengeText"
                                            name="txtChallengeTextUpdate"
                                            maxlength="25"
                                            aria-label="{{ 'server_tab_MONITORING_add_challenge_text' | translate }}"
                                            data-ng-pattern="/^[a-zA-Z0-9\s\.\-=\(\)\\\/;]*$/i"
                                            data-ng-model="ctrlMonitoringUpdate.monitoring.challengeText"
                                            data-oui-tooltip="{{ 'server_tab_MONITORING_add_challenge_text_help' | translate }}"
                                        />
                                        <p
                                            class="text-danger"
                                            data-ng-if="formUpdateMonitoring.txtChallengeTextUpdate.$error.pattern"
                                            data-ng-bind-html="'server_tab_MONITORING_add_challengeText_invalid' | translate "
                                        ></p>
                                    </td>
                                    <td>
                                        <select
                                            class="form-control"
                                            id="select-monitoring-interval"
                                            name="select-monitoring-interval"
                                            required
                                            aria-label="{{ 'server_tab_MONITORING_add_interval' | translate }}"
                                            data-ng-options="interval for interval in $ctrl.monitoringIntervalEnum"
                                            data-ng-model="ctrlMonitoringUpdate.monitoring.interval"
                                        >
                                        </select>
                                    </td>
                                    <td>
                                        <input
                                            type="text"
                                            class="form-control"
                                            name="monitoringUrl"
                                            pattern="^(?:(ftp|http|https):\/\/)?(?:[\w-]+\.)+[a-z]{2,15}$"
                                            aria-label="{{ server_tab_MONITORING_add_url | translate }}"
                                            data-ng-show="ctrlMonitoringUpdate.monitoring.protocol === 'DNS'"
                                            data-ng-model="ctrlMonitoringUpdate.monitoring.url"
                                            data-ng-required="ctrlMonitoringUpdate.monitoring.protocol === 'DNS'"
                                        />
                                        <p
                                            class="text-danger"
                                            data-ng-show="!formUpdateMonitoring.monitoringUrl.$valid"
                                            data-translate="server_tab_MONITORING_add_url_invalid"
                                        ></p>
                                    </td>
                                    <td></td>
                                    <td>
                                        <button
                                            type="button"
                                            class="btn btn-link"
                                            data-ng-if="$ctrl.isAllowedToMonitoringWithSms()"
                                            data-ng-click="$ctrl.toggleEditModePart('sms')"
                                        >
                                            <span class="fa fa-mobile"></span>
                                            <span
                                                data-ng-bind="monitoring.smsNotifications.length || 0"
                                            ></span>
                                        </button>
                                        <button
                                            type="button"
                                            class="btn-monitoring-add"
                                            data-ng-click="$ctrl.toggleEditModePart('email')"
                                        >
                                            <span
                                                class="fa fa-envelope-o"
                                            ></span>
                                            <span
                                                data-ng-bind="monitoring.emailNotifications.length || 0"
                                            ></span>
                                        </button>
                                    </td>
                                    <td class="text-center">
                                        <button
                                            type="submit"
                                            class="btn btn-link"
                                            title="{{ 'wizard_confirm' | translate }}"
                                            data-ng-disabled="!formUpdateMonitoring.$valid"
                                        >
                                            <span
                                                class="oui-icon oui-icon-success"
                                                aria-hidden="true"
                                            ></span>
                                        </button>
                                    </td>
                                    <td class="text-center">
                                        <button
                                            type="button"
                                            class="btn btn-link"
                                            title="{{ 'wizard_cancel' | translate }}"
                                            data-ng-click="$ctrl.editMode = null"
                                        >
                                            <span
                                                class="oui-icon oui-icon-close"
                                                aria-hidden="true"
                                            ></span>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- NOTIFICATIONS EMAIL  -->
                        <div
                            class="well"
                            data-ng-if="$ctrl.editMode === monitoring.monitoringId && $ctrl.editModeView.email"
                        >
                            <div
                                class="mb-4"
                                data-ng-repeat="emailNotification in ctrlMonitoringUpdate.monitoring.emailNotifications track by $index"
                                data-ng-form="formUpdateEmailNotfication"
                                data-ng-class="{
                                         'opacity50': ctrlMonitoringUpdate.emailNotificationsToDelete.indexOf(emailNotification) !== -1
                                     }"
                            >
                                <div
                                    class="text-center mb-4"
                                    data-ng-if="$first"
                                >
                                    <span
                                        class="fa fa-envelope-o fa-3x"
                                        aria-label="{{ 'server_tab_MONITORING_notifications_email_add_email' | translate }}"
                                    >
                                    </span>
                                </div>

                                <div class="form-group">
                                    <label
                                        for="emailUpdate{{ $index }}"
                                        class="control-label"
                                        data-translate="server_tab_MONITORING_notifications_email_add_email"
                                    >
                                    </label>
                                    <input
                                        type="email"
                                        class="form-control"
                                        id="emailUpdate{{ $index }}"
                                        data-ng-model="emailNotification.email"
                                    />
                                    <p
                                        class="text-danger"
                                        data-ng-if="formUpdateEmailNotfication.$error.email"
                                        data-ng-required="emailNotification.language"
                                        data-translate="server_tab_MONITORING_notifications_email_add_email_invalid"
                                    ></p>
                                </div>

                                <div class="form-group">
                                    <label
                                        for="select-lang-update{{ $index }}"
                                        class="control-label"
                                        data-translate="server_tab_MONITORING_notifications_email_add_lang"
                                    >
                                    </label>
                                    <select
                                        class="form-control"
                                        id="select-lang-update{{ $index }}"
                                        name="select-lang-update{{ $index }}"
                                        data-ng-options="lang as (('language_' + lang) | translate) for lang in $ctrl.languageEnum"
                                        data-ng-model="emailNotification.language"
                                        data-ng-required="emailNotification.email"
                                    >
                                    </select>
                                </div>

                                <div
                                    class="form-group"
                                    data-ng-if="emailNotification.alertId"
                                >
                                    <label
                                        for="chk-enable-update{{ $index }}"
                                        class="control-label"
                                        data-translate="server_tab_MONITORING_table_header_status"
                                    >
                                    </label>
                                    <input
                                        type="checkbox"
                                        id="chk-enable-update{{$index}}"
                                        name="chk-enable-update{{$index}}"
                                        data-ng-model="emailNotification.enabled"
                                    />
                                </div>

                                <button
                                    type="button"
                                    class="btn btn-default"
                                    data-ng-if="ctrlMonitoringUpdate.emailNotificationsToDelete.indexOf(emailNotification) === -1"
                                    data-ng-click="ctrlMonitoringUpdate.removeEMailNotification(emailNotification)"
                                >
                                    <i class="icon icon-trash pointer"></i>
                                    <span
                                        data-ng-bind=":: 'server_tab_MONITORING_notification_remove_recipient' | translate"
                                    ></span>
                                </button>
                                <button
                                    type="button"
                                    class="btn btn-link"
                                    data-ng-if="ctrlMonitoringUpdate.emailNotificationsToDelete.indexOf(emailNotification) !== -1"
                                    data-ng-click="ctrlMonitoringUpdate.cancelDeleteEMailNotification(emailNotification)"
                                    data-ng-bind=":: 'server_tab_MONITORING_notification_add_recipient' | translate"
                                ></button>
                            </div>

                            <div class="text-center">
                                <p
                                    data-translate="server_tab_MONITORING_notification_no_recipient_EMAIL"
                                    data-ng-if="!ctrlMonitoringUpdate.monitoring.emailNotifications || ctrlMonitoringUpdate.monitoring.emailNotifications.length === 0"
                                ></p>

                                <button
                                    type="button"
                                    class="btn btn-default"
                                    data-ng-click="ctrlMonitoringUpdate.addEMailNotification()"
                                    data-translate="server_tab_MONITORING_notification_add_recipient"
                                ></button>
                            </div>
                        </div>

                        <!-- NOTIFICATIONS SMS  -->
                        <div
                            data-ng-if="$ctrl.editMode === monitoring.monitoringId && $ctrl.editModeView.sms"
                        >
                            <div
                                data-ng-repeat="smsNotification in ctrlMonitoringUpdate.monitoring.smsNotifications track by $index"
                                data-ng-form="formUpdateSmsNotfication"
                                data-ng-class="{
                                         'opacity50': ctrlMonitoringUpdate.smsNotificationsToDelete.indexOf(smsNotification) !== -1
                                     }"
                            >
                                <div class="text-center" data-ng-if="$first">
                                    <span
                                        class="fa fa-mobile fa-4x"
                                        aria-hidden="true"
                                    ></span>
                                </div>

                                <div class="form-group">
                                    <label
                                        for="select-sms-account-update{{ $index }}"
                                        class="control-label"
                                        data-translate="server_tab_MONITORING_notifications_sms_add_sms"
                                    >
                                    </label>
                                    <select
                                        class="form-control"
                                        id="select-sms-account-update{{ $index }}"
                                        data-ng-options="smsAccount.name as smsAccount.name for smsAccount in $ctrl.sms"
                                        data-ng-model="smsNotification.smsAccount"
                                    >
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label
                                        for="phone-number-update{{ $index }}"
                                        class="control-label"
                                        data-translate="server_tab_MONITORING_notifications_sms_add_phone"
                                    >
                                    </label>
                                    <input
                                        type="tel"
                                        class="form-control"
                                        id="phone-number-update{{$index}}"
                                        data-ng-model="smsNotification.phoneNumberTo"
                                        data-ng-pattern="/^\+(?:[0-9] ?){6,14}[0-9]$/"
                                    />
                                    <p
                                        class="text-danger"
                                        data-ng-show="formUpdateSmsNotfication.$error.pattern"
                                        data-translate="server_tab_MONITORING_notifications_sms_add_phone_invalid"
                                    ></p>
                                </div>

                                <div class="form-group form-inline">
                                    <label
                                        class="control-label"
                                        data-translate="server_tab_MONITORING_table_notifications_sms_header_from"
                                    >
                                    </label>
                                    <div
                                        data-ng-form="formUpdateSmsNotficationPeriod"
                                    >
                                        <input
                                            type="number"
                                            class="form-control"
                                            min="0"
                                            max="24"
                                            data-ng-model="smsNotification.fromHour"
                                            data-ng-pattern="/[0-9]{1,3}/"
                                        />

                                        <span
                                            data-translate="server_tab_MONITORING_notifications_sms_add_hours"
                                        ></span>
                                        <span
                                            data-translate="server_tab_MONITORING_table_notifications_sms_header_to"
                                        ></span>

                                        <input
                                            type="number"
                                            class="form-control"
                                            min="0"
                                            max="24"
                                            data-ng-model="smsNotification.toHour"
                                            data-ng-pattern="/[0-9]{1,3}/"
                                        />
                                        <span
                                            data-translate="server_tab_MONITORING_notifications_sms_add_hours"
                                        ></span>

                                        <p
                                            class="text-danger"
                                            data-ng-if="formUpdateSmsNotficationPeriod.$error.pattern"
                                            data-translate="server_tab_MONITORING_notifications_sms_add_hour_invalid"
                                        ></p>
                                        <p
                                            class="text-danger"
                                            data-ng-if="formUpdateSmsNotficationPeriod.$error.min"
                                            data-translate="server_tab_MONITORING_notifications_sms_add_hour_invalid"
                                        ></p>
                                        <p
                                            class="text-danger"
                                            data-ng-if="formUpdateSmsNotficationPeriod.$error.max"
                                            data-translate="server_tab_MONITORING_notifications_sms_add_hour_invalid"
                                        ></p>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label
                                        for="select-lang-sms{{ $index }}"
                                        class="control-label"
                                        data-translate="server_tab_MONITORING_notifications_email_add_lang"
                                    >
                                    </label>
                                    <select
                                        class="form-control"
                                        id="select-lang-sms{{ $index }}"
                                        name="select-lang-sms{{ $index }}"
                                        data-ng-options="lang as (('language_' + lang) | translate) for lang in $ctrl.languageEnum"
                                        data-ng-model="smsNotification.language"
                                    >
                                    </select>
                                </div>

                                <div
                                    class="form-group"
                                    data-ng-if="smsNotification.alertId"
                                >
                                    <label
                                        for="chk-enable-sms-update{{ $index }}"
                                        class="control-label"
                                        data-translate="server_tab_MONITORING_table_header_status"
                                    >
                                    </label>
                                    <input
                                        type="checkbox"
                                        id="chk-enable-sms-update{{$index}}"
                                        name="chk-enable-sms-update{{$index}}"
                                        data-ng-model="smsNotification.enabled"
                                    />
                                </div>

                                <button
                                    class="btn btn-default"
                                    type="button"
                                    data-ng-if="ctrlMonitoringUpdate.smsNotificationsToDelete.indexOf(smsNotification) === -1"
                                    data-ng-click="ctrlMonitoringUpdate.removeSmsNotification(smsNotification)"
                                    data-ng-bind=":: 'server_tab_MONITORING_notification_remove_recipient' | translate"
                                ></button>
                                <button
                                    class="btn btn-default"
                                    type="button"
                                    data-ng-if="ctrlMonitoringUpdate.smsNotificationsToDelete.indexOf(smsNotification) !== -1"
                                    data-ng-click="ctrlMonitoringUpdate.cancelDeleteSmslNotification(smsNotification)"
                                    data-ng-bind=":: 'server_tab_MONITORING_notification_add_recipient' | translate"
                                ></button>
                            </div>

                            <div class="text-center">
                                <p
                                    data-translate="server_tab_MONITORING_notification_no_recipient_SMS"
                                    data-ng-if="!ctrlMonitoringUpdate.monitoring.smsNotifications || ctrlMonitoringUpdate.monitoring.smsNotifications.length === 0"
                                ></p>
                                <button
                                    type="button"
                                    class="btn btn-default"
                                    data-ng-click="ctrlMonitoringUpdate.addSmsNotification()"
                                    data-translate="server_tab_MONITORING_notification_add_recipient"
                                ></button>
                            </div>
                        </div>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div
    data-pagination-front="data-pagination-front"
    data-items="$ctrl.monitoringServicesIds"
    data-paginated-items="$ctrl.monitoringServices"
    data-transform-item="$ctrl.getMonitoringDetail(item)"
    data-on-transform-item-notify="$ctrl.onTransformItemNotify(item)"
    data-on-transform-item-done="$ctrl.tableMonitoringPageLoaded(items)"
    data-current-page="currentPage"
    data-nb-pages="nbPages"
    data-items-per-page="itemsPerPage"
    data-page-placeholder="{{ 'pagination_page' | translate:{ t0: $ctrl.currentPage.monitorings, t1: $ctrl.nbPages } }}"
    data-item-per-page-placeholder="{{ 'pagination_display' | translate }}"
></div>
